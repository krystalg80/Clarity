function F1(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function U1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var S0={exports:{}},Md={},x0={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jl=Symbol.for("react.element"),B1=Symbol.for("react.portal"),z1=Symbol.for("react.fragment"),$1=Symbol.for("react.strict_mode"),W1=Symbol.for("react.profiler"),q1=Symbol.for("react.provider"),G1=Symbol.for("react.context"),H1=Symbol.for("react.forward_ref"),K1=Symbol.for("react.suspense"),Q1=Symbol.for("react.memo"),Y1=Symbol.for("react.lazy"),Zy=Symbol.iterator;function X1(t){return t===null||typeof t!="object"?null:(t=Zy&&t[Zy]||t["@@iterator"],typeof t=="function"?t:null)}var k0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A0=Object.assign,P0={};function ea(t,e,n){this.props=t,this.context=e,this.refs=P0,this.updater=n||k0}ea.prototype.isReactComponent={};ea.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ea.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function N0(){}N0.prototype=ea.prototype;function vp(t,e,n){this.props=t,this.context=e,this.refs=P0,this.updater=n||k0}var _p=vp.prototype=new N0;_p.constructor=vp;A0(_p,ea.prototype);_p.isPureReactComponent=!0;var ev=Array.isArray,C0=Object.prototype.hasOwnProperty,wp={current:null},R0={key:!0,ref:!0,__self:!0,__source:!0};function b0(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)C0.call(e,r)&&!R0.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Jl,type:t,key:i,ref:o,props:s,_owner:wp.current}}function J1(t,e){return{$$typeof:Jl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ep(t){return typeof t=="object"&&t!==null&&t.$$typeof===Jl}function Z1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var tv=/\/+/g;function Gh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Z1(""+t.key):e.toString(36)}function cu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Jl:case B1:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Gh(o,0):r,ev(s)?(n="",t!=null&&(n=t.replace(tv,"$&/")+"/"),cu(s,e,n,"",function(d){return d})):s!=null&&(Ep(s)&&(s=J1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(tv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",ev(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+Gh(i,a);o+=cu(i,e,n,c,s)}else if(c=X1(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+Gh(i,a++),o+=cu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Vc(t,e,n){if(t==null)return t;var r=[],s=0;return cu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function ek(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $t={current:null},uu={transition:null},tk={ReactCurrentDispatcher:$t,ReactCurrentBatchConfig:uu,ReactCurrentOwner:wp};function D0(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:Vc,forEach:function(t,e,n){Vc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Vc(t,function(){e++}),e},toArray:function(t){return Vc(t,function(e){return e})||[]},only:function(t){if(!Ep(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=ea;fe.Fragment=z1;fe.Profiler=W1;fe.PureComponent=vp;fe.StrictMode=$1;fe.Suspense=K1;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tk;fe.act=D0;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=A0({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=wp.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)C0.call(e,c)&&!R0.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Jl,type:t.type,key:s,ref:i,props:r,_owner:o}};fe.createContext=function(t){return t={$$typeof:G1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:q1,_context:t},t.Consumer=t};fe.createElement=b0;fe.createFactory=function(t){var e=b0.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:H1,render:t}};fe.isValidElement=Ep;fe.lazy=function(t){return{$$typeof:Y1,_payload:{_status:-1,_result:t},_init:ek}};fe.memo=function(t,e){return{$$typeof:Q1,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=uu.transition;uu.transition={};try{t()}finally{uu.transition=e}};fe.unstable_act=D0;fe.useCallback=function(t,e){return $t.current.useCallback(t,e)};fe.useContext=function(t){return $t.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return $t.current.useDeferredValue(t)};fe.useEffect=function(t,e){return $t.current.useEffect(t,e)};fe.useId=function(){return $t.current.useId()};fe.useImperativeHandle=function(t,e,n){return $t.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return $t.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return $t.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return $t.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return $t.current.useReducer(t,e,n)};fe.useRef=function(t){return $t.current.useRef(t)};fe.useState=function(t){return $t.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return $t.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return $t.current.useTransition()};fe.version="18.3.1";x0.exports=fe;var R=x0.exports;const yr=U1(R),nk=F1({__proto__:null,default:yr},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rk=R,sk=Symbol.for("react.element"),ik=Symbol.for("react.fragment"),ok=Object.prototype.hasOwnProperty,ak=rk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lk={key:!0,ref:!0,__self:!0,__source:!0};function j0(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)ok.call(e,r)&&!lk.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:sk,type:t,key:i,ref:o,props:s,_owner:ak.current}}Md.Fragment=ik;Md.jsx=j0;Md.jsxs=j0;S0.exports=Md;var u=S0.exports,Of={},V0={exports:{}},un={},O0={exports:{}},M0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,J){var ue=q.length;q.push(J);e:for(;0<ue;){var Pe=ue-1>>>1,we=q[Pe];if(0<s(we,J))q[Pe]=J,q[ue]=we,ue=Pe;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var J=q[0],ue=q.pop();if(ue!==J){q[0]=ue;e:for(var Pe=0,we=q.length,Ne=we>>>1;Pe<Ne;){var Ot=2*(Pe+1)-1,Xt=q[Ot],Jt=Ot+1,Tt=q[Jt];if(0>s(Xt,ue))Jt<we&&0>s(Tt,Xt)?(q[Pe]=Tt,q[Jt]=ue,Pe=Jt):(q[Pe]=Xt,q[Ot]=ue,Pe=Ot);else if(Jt<we&&0>s(Tt,ue))q[Pe]=Tt,q[Jt]=ue,Pe=Jt;else break e}}return J}function s(q,J){var ue=q.sortIndex-J.sortIndex;return ue!==0?ue:q.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],d=[],f=1,m=null,g=3,x=!1,A=!1,N=!1,C=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(q){for(var J=n(d);J!==null;){if(J.callback===null)r(d);else if(J.startTime<=q)r(d),J.sortIndex=J.expirationTime,e(c,J);else break;J=n(d)}}function D(q){if(N=!1,S(q),!A)if(n(c)!==null)A=!0,ne(L);else{var J=n(d);J!==null&&Fe(D,J.startTime-q)}}function L(q,J){A=!1,N&&(N=!1,I(y),y=-1),x=!0;var ue=g;try{for(S(J),m=n(c);m!==null&&(!(m.expirationTime>J)||q&&!P());){var Pe=m.callback;if(typeof Pe=="function"){m.callback=null,g=m.priorityLevel;var we=Pe(m.expirationTime<=J);J=t.unstable_now(),typeof we=="function"?m.callback=we:m===n(c)&&r(c),S(J)}else r(c);m=n(c)}if(m!==null)var Ne=!0;else{var Ot=n(d);Ot!==null&&Fe(D,Ot.startTime-J),Ne=!1}return Ne}finally{m=null,g=ue,x=!1}}var V=!1,_=null,y=-1,E=5,T=-1;function P(){return!(t.unstable_now()-T<E)}function b(){if(_!==null){var q=t.unstable_now();T=q;var J=!0;try{J=_(!0,q)}finally{J?k():(V=!1,_=null)}}else V=!1}var k;if(typeof v=="function")k=function(){v(b)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ve=le.port2;le.port1.onmessage=b,k=function(){ve.postMessage(null)}}else k=function(){C(b,0)};function ne(q){_=q,V||(V=!0,k())}function Fe(q,J){y=C(function(){q(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){A||x||(A=!0,ne(L))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(q){switch(g){case 1:case 2:case 3:var J=3;break;default:J=g}var ue=g;g=J;try{return q()}finally{g=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,J){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ue=g;g=q;try{return J()}finally{g=ue}},t.unstable_scheduleCallback=function(q,J,ue){var Pe=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Pe+ue:Pe):ue=Pe,q){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=ue+we,q={id:f++,callback:J,priorityLevel:q,startTime:ue,expirationTime:we,sortIndex:-1},ue>Pe?(q.sortIndex=ue,e(d,q),n(c)===null&&q===n(d)&&(N?(I(y),y=-1):N=!0,Fe(D,ue-Pe))):(q.sortIndex=we,e(c,q),A||x||(A=!0,ne(L))),q},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(q){var J=g;return function(){var ue=g;g=J;try{return q.apply(this,arguments)}finally{g=ue}}}})(M0);O0.exports=M0;var ck=O0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uk=R,ln=ck;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var L0=new Set,pl={};function ji(t,e){bo(t,e),bo(t+"Capture",e)}function bo(t,e){for(pl[t]=e,t=0;t<e.length;t++)L0.add(e[t])}var wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mf=Object.prototype.hasOwnProperty,dk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nv={},rv={};function hk(t){return Mf.call(rv,t)?!0:Mf.call(nv,t)?!1:dk.test(t)?rv[t]=!0:(nv[t]=!0,!1)}function fk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function mk(t,e,n,r){if(e===null||typeof e>"u"||fk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Wt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Et[t]=new Wt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Et[e]=new Wt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Et[t]=new Wt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Et[t]=new Wt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Et[t]=new Wt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Et[t]=new Wt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Et[t]=new Wt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Et[t]=new Wt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Et[t]=new Wt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Tp=/[\-:]([a-z])/g;function Ip(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Tp,Ip);Et[e]=new Wt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Tp,Ip);Et[e]=new Wt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Tp,Ip);Et[e]=new Wt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Et[t]=new Wt(t,1,!1,t.toLowerCase(),null,!1,!1)});Et.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Et[t]=new Wt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Sp(t,e,n,r){var s=Et.hasOwnProperty(e)?Et[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mk(e,n,s,r)&&(n=null),r||s===null?hk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Pr=uk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oc=Symbol.for("react.element"),lo=Symbol.for("react.portal"),co=Symbol.for("react.fragment"),xp=Symbol.for("react.strict_mode"),Lf=Symbol.for("react.profiler"),F0=Symbol.for("react.provider"),U0=Symbol.for("react.context"),kp=Symbol.for("react.forward_ref"),Ff=Symbol.for("react.suspense"),Uf=Symbol.for("react.suspense_list"),Ap=Symbol.for("react.memo"),Jr=Symbol.for("react.lazy"),B0=Symbol.for("react.offscreen"),sv=Symbol.iterator;function xa(t){return t===null||typeof t!="object"?null:(t=sv&&t[sv]||t["@@iterator"],typeof t=="function"?t:null)}var Ge=Object.assign,Hh;function Fa(t){if(Hh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Hh=e&&e[1]||""}return`
`+Hh+t}var Kh=!1;function Qh(t,e){if(!t||Kh)return"";Kh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{Kh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fa(t):""}function pk(t){switch(t.tag){case 5:return Fa(t.type);case 16:return Fa("Lazy");case 13:return Fa("Suspense");case 19:return Fa("SuspenseList");case 0:case 2:case 15:return t=Qh(t.type,!1),t;case 11:return t=Qh(t.type.render,!1),t;case 1:return t=Qh(t.type,!0),t;default:return""}}function Bf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case co:return"Fragment";case lo:return"Portal";case Lf:return"Profiler";case xp:return"StrictMode";case Ff:return"Suspense";case Uf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case U0:return(t.displayName||"Context")+".Consumer";case F0:return(t._context.displayName||"Context")+".Provider";case kp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ap:return e=t.displayName||null,e!==null?e:Bf(t.type)||"Memo";case Jr:e=t._payload,t=t._init;try{return Bf(t(e))}catch{}}return null}function gk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bf(e);case 8:return e===xp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ks(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function z0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yk(t){var e=z0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Mc(t){t._valueTracker||(t._valueTracker=yk(t))}function $0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=z0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Mu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zf(t,e){var n=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function iv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ks(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function W0(t,e){e=e.checked,e!=null&&Sp(t,"checked",e,!1)}function $f(t,e){W0(t,e);var n=ks(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wf(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wf(t,e.type,ks(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ov(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wf(t,e,n){(e!=="number"||Mu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ua=Array.isArray;function To(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ks(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function qf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function av(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(Ua(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ks(n)}}function q0(t,e){var n=ks(e.value),r=ks(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function lv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function G0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?G0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Lc,H0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Lc=Lc||document.createElement("div"),Lc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Lc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function gl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ya={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vk=["Webkit","ms","Moz","O"];Object.keys(Ya).forEach(function(t){vk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ya[e]=Ya[t]})});function K0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ya.hasOwnProperty(t)&&Ya[t]?(""+e).trim():e+"px"}function Q0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=K0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var _k=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hf(t,e){if(e){if(_k[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Kf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qf=null;function Pp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yf=null,Io=null,So=null;function cv(t){if(t=tc(t)){if(typeof Yf!="function")throw Error(W(280));var e=t.stateNode;e&&(e=zd(e),Yf(t.stateNode,t.type,e))}}function Y0(t){Io?So?So.push(t):So=[t]:Io=t}function X0(){if(Io){var t=Io,e=So;if(So=Io=null,cv(t),e)for(t=0;t<e.length;t++)cv(e[t])}}function J0(t,e){return t(e)}function Z0(){}var Yh=!1;function eE(t,e,n){if(Yh)return t(e,n);Yh=!0;try{return J0(t,e,n)}finally{Yh=!1,(Io!==null||So!==null)&&(Z0(),X0())}}function yl(t,e){var n=t.stateNode;if(n===null)return null;var r=zd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var Xf=!1;if(wr)try{var ka={};Object.defineProperty(ka,"passive",{get:function(){Xf=!0}}),window.addEventListener("test",ka,ka),window.removeEventListener("test",ka,ka)}catch{Xf=!1}function wk(t,e,n,r,s,i,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var Xa=!1,Lu=null,Fu=!1,Jf=null,Ek={onError:function(t){Xa=!0,Lu=t}};function Tk(t,e,n,r,s,i,o,a,c){Xa=!1,Lu=null,wk.apply(Ek,arguments)}function Ik(t,e,n,r,s,i,o,a,c){if(Tk.apply(this,arguments),Xa){if(Xa){var d=Lu;Xa=!1,Lu=null}else throw Error(W(198));Fu||(Fu=!0,Jf=d)}}function Vi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function tE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function uv(t){if(Vi(t)!==t)throw Error(W(188))}function Sk(t){var e=t.alternate;if(!e){if(e=Vi(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return uv(s),t;if(i===r)return uv(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function nE(t){return t=Sk(t),t!==null?rE(t):null}function rE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=rE(t);if(e!==null)return e;t=t.sibling}return null}var sE=ln.unstable_scheduleCallback,dv=ln.unstable_cancelCallback,xk=ln.unstable_shouldYield,kk=ln.unstable_requestPaint,Je=ln.unstable_now,Ak=ln.unstable_getCurrentPriorityLevel,Np=ln.unstable_ImmediatePriority,iE=ln.unstable_UserBlockingPriority,Uu=ln.unstable_NormalPriority,Pk=ln.unstable_LowPriority,oE=ln.unstable_IdlePriority,Ld=null,Jn=null;function Nk(t){if(Jn&&typeof Jn.onCommitFiberRoot=="function")try{Jn.onCommitFiberRoot(Ld,t,void 0,(t.current.flags&128)===128)}catch{}}var jn=Math.clz32?Math.clz32:bk,Ck=Math.log,Rk=Math.LN2;function bk(t){return t>>>=0,t===0?32:31-(Ck(t)/Rk|0)|0}var Fc=64,Uc=4194304;function Ba(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Ba(a):(i&=o,i!==0&&(r=Ba(i)))}else o=n&~s,o!==0?r=Ba(o):i!==0&&(r=Ba(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-jn(e),s=1<<n,r|=t[n],e&=~s;return r}function Dk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-jn(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=Dk(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function Zf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function aE(){var t=Fc;return Fc<<=1,!(Fc&4194240)&&(Fc=64),t}function Xh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Zl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-jn(e),t[e]=n}function Vk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-jn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Cp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-jn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ke=0;function lE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var cE,Rp,uE,dE,hE,em=!1,Bc=[],ds=null,hs=null,fs=null,vl=new Map,_l=new Map,es=[],Ok="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hv(t,e){switch(t){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":hs=null;break;case"mouseover":case"mouseout":fs=null;break;case"pointerover":case"pointerout":vl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_l.delete(e.pointerId)}}function Aa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=tc(e),e!==null&&Rp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Mk(t,e,n,r,s){switch(e){case"focusin":return ds=Aa(ds,t,e,n,r,s),!0;case"dragenter":return hs=Aa(hs,t,e,n,r,s),!0;case"mouseover":return fs=Aa(fs,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return vl.set(i,Aa(vl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,_l.set(i,Aa(_l.get(i)||null,t,e,n,r,s)),!0}return!1}function fE(t){var e=ai(t.target);if(e!==null){var n=Vi(e);if(n!==null){if(e=n.tag,e===13){if(e=tE(n),e!==null){t.blockedOn=e,hE(t.priority,function(){uE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function du(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=tm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Qf=r,n.target.dispatchEvent(r),Qf=null}else return e=tc(n),e!==null&&Rp(e),t.blockedOn=n,!1;e.shift()}return!0}function fv(t,e,n){du(t)&&n.delete(e)}function Lk(){em=!1,ds!==null&&du(ds)&&(ds=null),hs!==null&&du(hs)&&(hs=null),fs!==null&&du(fs)&&(fs=null),vl.forEach(fv),_l.forEach(fv)}function Pa(t,e){t.blockedOn===e&&(t.blockedOn=null,em||(em=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,Lk)))}function wl(t){function e(s){return Pa(s,t)}if(0<Bc.length){Pa(Bc[0],t);for(var n=1;n<Bc.length;n++){var r=Bc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ds!==null&&Pa(ds,t),hs!==null&&Pa(hs,t),fs!==null&&Pa(fs,t),vl.forEach(e),_l.forEach(e),n=0;n<es.length;n++)r=es[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<es.length&&(n=es[0],n.blockedOn===null);)fE(n),n.blockedOn===null&&es.shift()}var xo=Pr.ReactCurrentBatchConfig,zu=!0;function Fk(t,e,n,r){var s=ke,i=xo.transition;xo.transition=null;try{ke=1,bp(t,e,n,r)}finally{ke=s,xo.transition=i}}function Uk(t,e,n,r){var s=ke,i=xo.transition;xo.transition=null;try{ke=4,bp(t,e,n,r)}finally{ke=s,xo.transition=i}}function bp(t,e,n,r){if(zu){var s=tm(t,e,n,r);if(s===null)lf(t,e,r,$u,n),hv(t,r);else if(Mk(s,t,e,n,r))r.stopPropagation();else if(hv(t,r),e&4&&-1<Ok.indexOf(t)){for(;s!==null;){var i=tc(s);if(i!==null&&cE(i),i=tm(t,e,n,r),i===null&&lf(t,e,r,$u,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else lf(t,e,r,null,n)}}var $u=null;function tm(t,e,n,r){if($u=null,t=Pp(r),t=ai(t),t!==null)if(e=Vi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=tE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $u=t,null}function mE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ak()){case Np:return 1;case iE:return 4;case Uu:case Pk:return 16;case oE:return 536870912;default:return 16}default:return 16}}var as=null,Dp=null,hu=null;function pE(){if(hu)return hu;var t,e=Dp,n=e.length,r,s="value"in as?as.value:as.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return hu=s.slice(t,1<r?1-r:void 0)}function fu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zc(){return!0}function mv(){return!1}function dn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?zc:mv,this.isPropagationStopped=mv,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zc)},persist:function(){},isPersistent:zc}),e}var ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jp=dn(ta),ec=Ge({},ta,{view:0,detail:0}),Bk=dn(ec),Jh,Zh,Na,Fd=Ge({},ec,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Na&&(Na&&t.type==="mousemove"?(Jh=t.screenX-Na.screenX,Zh=t.screenY-Na.screenY):Zh=Jh=0,Na=t),Jh)},movementY:function(t){return"movementY"in t?t.movementY:Zh}}),pv=dn(Fd),zk=Ge({},Fd,{dataTransfer:0}),$k=dn(zk),Wk=Ge({},ec,{relatedTarget:0}),ef=dn(Wk),qk=Ge({},ta,{animationName:0,elapsedTime:0,pseudoElement:0}),Gk=dn(qk),Hk=Ge({},ta,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Kk=dn(Hk),Qk=Ge({},ta,{data:0}),gv=dn(Qk),Yk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Jk[t])?!!e[t]:!1}function Vp(){return Zk}var eA=Ge({},ec,{key:function(t){if(t.key){var e=Yk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=fu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Xk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vp,charCode:function(t){return t.type==="keypress"?fu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?fu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),tA=dn(eA),nA=Ge({},Fd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yv=dn(nA),rA=Ge({},ec,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vp}),sA=dn(rA),iA=Ge({},ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),oA=dn(iA),aA=Ge({},Fd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),lA=dn(aA),cA=[9,13,27,32],Op=wr&&"CompositionEvent"in window,Ja=null;wr&&"documentMode"in document&&(Ja=document.documentMode);var uA=wr&&"TextEvent"in window&&!Ja,gE=wr&&(!Op||Ja&&8<Ja&&11>=Ja),vv=" ",_v=!1;function yE(t,e){switch(t){case"keyup":return cA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var uo=!1;function dA(t,e){switch(t){case"compositionend":return vE(e);case"keypress":return e.which!==32?null:(_v=!0,vv);case"textInput":return t=e.data,t===vv&&_v?null:t;default:return null}}function hA(t,e){if(uo)return t==="compositionend"||!Op&&yE(t,e)?(t=pE(),hu=Dp=as=null,uo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gE&&e.locale!=="ko"?null:e.data;default:return null}}var fA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!fA[t.type]:e==="textarea"}function _E(t,e,n,r){Y0(r),e=Wu(e,"onChange"),0<e.length&&(n=new jp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Za=null,El=null;function mA(t){CE(t,0)}function Ud(t){var e=mo(t);if($0(e))return t}function pA(t,e){if(t==="change")return e}var wE=!1;if(wr){var tf;if(wr){var nf="oninput"in document;if(!nf){var Ev=document.createElement("div");Ev.setAttribute("oninput","return;"),nf=typeof Ev.oninput=="function"}tf=nf}else tf=!1;wE=tf&&(!document.documentMode||9<document.documentMode)}function Tv(){Za&&(Za.detachEvent("onpropertychange",EE),El=Za=null)}function EE(t){if(t.propertyName==="value"&&Ud(El)){var e=[];_E(e,El,t,Pp(t)),eE(mA,e)}}function gA(t,e,n){t==="focusin"?(Tv(),Za=e,El=n,Za.attachEvent("onpropertychange",EE)):t==="focusout"&&Tv()}function yA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ud(El)}function vA(t,e){if(t==="click")return Ud(e)}function _A(t,e){if(t==="input"||t==="change")return Ud(e)}function wA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var On=typeof Object.is=="function"?Object.is:wA;function Tl(t,e){if(On(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Mf.call(e,s)||!On(t[s],e[s]))return!1}return!0}function Iv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Sv(t,e){var n=Iv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Iv(n)}}function TE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?TE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function IE(){for(var t=window,e=Mu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Mu(t.document)}return e}function Mp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function EA(t){var e=IE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&TE(n.ownerDocument.documentElement,n)){if(r!==null&&Mp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Sv(n,i);var o=Sv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var TA=wr&&"documentMode"in document&&11>=document.documentMode,ho=null,nm=null,el=null,rm=!1;function xv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;rm||ho==null||ho!==Mu(r)||(r=ho,"selectionStart"in r&&Mp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),el&&Tl(el,r)||(el=r,r=Wu(nm,"onSelect"),0<r.length&&(e=new jp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ho)))}function $c(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var fo={animationend:$c("Animation","AnimationEnd"),animationiteration:$c("Animation","AnimationIteration"),animationstart:$c("Animation","AnimationStart"),transitionend:$c("Transition","TransitionEnd")},rf={},SE={};wr&&(SE=document.createElement("div").style,"AnimationEvent"in window||(delete fo.animationend.animation,delete fo.animationiteration.animation,delete fo.animationstart.animation),"TransitionEvent"in window||delete fo.transitionend.transition);function Bd(t){if(rf[t])return rf[t];if(!fo[t])return t;var e=fo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in SE)return rf[t]=e[n];return t}var xE=Bd("animationend"),kE=Bd("animationiteration"),AE=Bd("animationstart"),PE=Bd("transitionend"),NE=new Map,kv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ds(t,e){NE.set(t,e),ji(e,[t])}for(var sf=0;sf<kv.length;sf++){var of=kv[sf],IA=of.toLowerCase(),SA=of[0].toUpperCase()+of.slice(1);Ds(IA,"on"+SA)}Ds(xE,"onAnimationEnd");Ds(kE,"onAnimationIteration");Ds(AE,"onAnimationStart");Ds("dblclick","onDoubleClick");Ds("focusin","onFocus");Ds("focusout","onBlur");Ds(PE,"onTransitionEnd");bo("onMouseEnter",["mouseout","mouseover"]);bo("onMouseLeave",["mouseout","mouseover"]);bo("onPointerEnter",["pointerout","pointerover"]);bo("onPointerLeave",["pointerout","pointerover"]);ji("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ji("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ji("onBeforeInput",["compositionend","keypress","textInput","paste"]);ji("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ji("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ji("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xA=new Set("cancel close invalid load scroll toggle".split(" ").concat(za));function Av(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Ik(r,e,void 0,t),t.currentTarget=null}function CE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;Av(s,a,d),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;Av(s,a,d),i=c}}}if(Fu)throw t=Jf,Fu=!1,Jf=null,t}function je(t,e){var n=e[lm];n===void 0&&(n=e[lm]=new Set);var r=t+"__bubble";n.has(r)||(RE(e,t,2,!1),n.add(r))}function af(t,e,n){var r=0;e&&(r|=4),RE(n,t,r,e)}var Wc="_reactListening"+Math.random().toString(36).slice(2);function Il(t){if(!t[Wc]){t[Wc]=!0,L0.forEach(function(n){n!=="selectionchange"&&(xA.has(n)||af(n,!1,t),af(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Wc]||(e[Wc]=!0,af("selectionchange",!1,e))}}function RE(t,e,n,r){switch(mE(e)){case 1:var s=Fk;break;case 4:s=Uk;break;default:s=bp}n=s.bind(null,e,n,t),s=void 0,!Xf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function lf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ai(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}eE(function(){var d=i,f=Pp(n),m=[];e:{var g=NE.get(t);if(g!==void 0){var x=jp,A=t;switch(t){case"keypress":if(fu(n)===0)break e;case"keydown":case"keyup":x=tA;break;case"focusin":A="focus",x=ef;break;case"focusout":A="blur",x=ef;break;case"beforeblur":case"afterblur":x=ef;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=pv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=$k;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=sA;break;case xE:case kE:case AE:x=Gk;break;case PE:x=oA;break;case"scroll":x=Bk;break;case"wheel":x=lA;break;case"copy":case"cut":case"paste":x=Kk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=yv}var N=(e&4)!==0,C=!N&&t==="scroll",I=N?g!==null?g+"Capture":null:g;N=[];for(var v=d,S;v!==null;){S=v;var D=S.stateNode;if(S.tag===5&&D!==null&&(S=D,I!==null&&(D=yl(v,I),D!=null&&N.push(Sl(v,D,S)))),C)break;v=v.return}0<N.length&&(g=new x(g,A,null,n,f),m.push({event:g,listeners:N}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",g&&n!==Qf&&(A=n.relatedTarget||n.fromElement)&&(ai(A)||A[Er]))break e;if((x||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,x?(A=n.relatedTarget||n.toElement,x=d,A=A?ai(A):null,A!==null&&(C=Vi(A),A!==C||A.tag!==5&&A.tag!==6)&&(A=null)):(x=null,A=d),x!==A)){if(N=pv,D="onMouseLeave",I="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(N=yv,D="onPointerLeave",I="onPointerEnter",v="pointer"),C=x==null?g:mo(x),S=A==null?g:mo(A),g=new N(D,v+"leave",x,n,f),g.target=C,g.relatedTarget=S,D=null,ai(f)===d&&(N=new N(I,v+"enter",A,n,f),N.target=S,N.relatedTarget=C,D=N),C=D,x&&A)t:{for(N=x,I=A,v=0,S=N;S;S=Qi(S))v++;for(S=0,D=I;D;D=Qi(D))S++;for(;0<v-S;)N=Qi(N),v--;for(;0<S-v;)I=Qi(I),S--;for(;v--;){if(N===I||I!==null&&N===I.alternate)break t;N=Qi(N),I=Qi(I)}N=null}else N=null;x!==null&&Pv(m,g,x,N,!1),A!==null&&C!==null&&Pv(m,C,A,N,!0)}}e:{if(g=d?mo(d):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var L=pA;else if(wv(g))if(wE)L=_A;else{L=yA;var V=gA}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(L=vA);if(L&&(L=L(t,d))){_E(m,L,n,f);break e}V&&V(t,g,d),t==="focusout"&&(V=g._wrapperState)&&V.controlled&&g.type==="number"&&Wf(g,"number",g.value)}switch(V=d?mo(d):window,t){case"focusin":(wv(V)||V.contentEditable==="true")&&(ho=V,nm=d,el=null);break;case"focusout":el=nm=ho=null;break;case"mousedown":rm=!0;break;case"contextmenu":case"mouseup":case"dragend":rm=!1,xv(m,n,f);break;case"selectionchange":if(TA)break;case"keydown":case"keyup":xv(m,n,f)}var _;if(Op)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else uo?yE(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(gE&&n.locale!=="ko"&&(uo||y!=="onCompositionStart"?y==="onCompositionEnd"&&uo&&(_=pE()):(as=f,Dp="value"in as?as.value:as.textContent,uo=!0)),V=Wu(d,y),0<V.length&&(y=new gv(y,t,null,n,f),m.push({event:y,listeners:V}),_?y.data=_:(_=vE(n),_!==null&&(y.data=_)))),(_=uA?dA(t,n):hA(t,n))&&(d=Wu(d,"onBeforeInput"),0<d.length&&(f=new gv("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:d}),f.data=_))}CE(m,e)})}function Sl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Wu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=yl(t,n),i!=null&&r.unshift(Sl(t,i,s)),i=yl(t,e),i!=null&&r.push(Sl(t,i,s))),t=t.return}return r}function Qi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Pv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=yl(n,i),c!=null&&o.unshift(Sl(n,c,a))):s||(c=yl(n,i),c!=null&&o.push(Sl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var kA=/\r\n?/g,AA=/\u0000|\uFFFD/g;function Nv(t){return(typeof t=="string"?t:""+t).replace(kA,`
`).replace(AA,"")}function qc(t,e,n){if(e=Nv(e),Nv(t)!==e&&n)throw Error(W(425))}function qu(){}var sm=null,im=null;function om(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var am=typeof setTimeout=="function"?setTimeout:void 0,PA=typeof clearTimeout=="function"?clearTimeout:void 0,Cv=typeof Promise=="function"?Promise:void 0,NA=typeof queueMicrotask=="function"?queueMicrotask:typeof Cv<"u"?function(t){return Cv.resolve(null).then(t).catch(CA)}:am;function CA(t){setTimeout(function(){throw t})}function cf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),wl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);wl(e)}function ms(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Rv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var na=Math.random().toString(36).slice(2),Gn="__reactFiber$"+na,xl="__reactProps$"+na,Er="__reactContainer$"+na,lm="__reactEvents$"+na,RA="__reactListeners$"+na,bA="__reactHandles$"+na;function ai(t){var e=t[Gn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Er]||n[Gn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Rv(t);t!==null;){if(n=t[Gn])return n;t=Rv(t)}return e}t=n,n=t.parentNode}return null}function tc(t){return t=t[Gn]||t[Er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function mo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function zd(t){return t[xl]||null}var cm=[],po=-1;function js(t){return{current:t}}function Ve(t){0>po||(t.current=cm[po],cm[po]=null,po--)}function be(t,e){po++,cm[po]=t.current,t.current=e}var As={},Vt=js(As),Kt=js(!1),yi=As;function Do(t,e){var n=t.type.contextTypes;if(!n)return As;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Qt(t){return t=t.childContextTypes,t!=null}function Gu(){Ve(Kt),Ve(Vt)}function bv(t,e,n){if(Vt.current!==As)throw Error(W(168));be(Vt,e),be(Kt,n)}function bE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,gk(t)||"Unknown",s));return Ge({},n,r)}function Hu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||As,yi=Vt.current,be(Vt,t),be(Kt,Kt.current),!0}function Dv(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=bE(t,e,yi),r.__reactInternalMemoizedMergedChildContext=t,Ve(Kt),Ve(Vt),be(Vt,t)):Ve(Kt),be(Kt,n)}var dr=null,$d=!1,uf=!1;function DE(t){dr===null?dr=[t]:dr.push(t)}function DA(t){$d=!0,DE(t)}function Vs(){if(!uf&&dr!==null){uf=!0;var t=0,e=ke;try{var n=dr;for(ke=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}dr=null,$d=!1}catch(s){throw dr!==null&&(dr=dr.slice(t+1)),sE(Np,Vs),s}finally{ke=e,uf=!1}}return null}var go=[],yo=0,Ku=null,Qu=0,gn=[],yn=0,vi=null,hr=1,fr="";function Ys(t,e){go[yo++]=Qu,go[yo++]=Ku,Ku=t,Qu=e}function jE(t,e,n){gn[yn++]=hr,gn[yn++]=fr,gn[yn++]=vi,vi=t;var r=hr;t=fr;var s=32-jn(r)-1;r&=~(1<<s),n+=1;var i=32-jn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,hr=1<<32-jn(e)+s|n<<s|r,fr=i+t}else hr=1<<i|n<<s|r,fr=t}function Lp(t){t.return!==null&&(Ys(t,1),jE(t,1,0))}function Fp(t){for(;t===Ku;)Ku=go[--yo],go[yo]=null,Qu=go[--yo],go[yo]=null;for(;t===vi;)vi=gn[--yn],gn[yn]=null,fr=gn[--yn],gn[yn]=null,hr=gn[--yn],gn[yn]=null}var an=null,sn=null,Me=!1,bn=null;function VE(t,e){var n=vn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function jv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,an=t,sn=ms(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,an=t,sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vi!==null?{id:hr,overflow:fr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=vn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,an=t,sn=null,!0):!1;default:return!1}}function um(t){return(t.mode&1)!==0&&(t.flags&128)===0}function dm(t){if(Me){var e=sn;if(e){var n=e;if(!jv(t,e)){if(um(t))throw Error(W(418));e=ms(n.nextSibling);var r=an;e&&jv(t,e)?VE(r,n):(t.flags=t.flags&-4097|2,Me=!1,an=t)}}else{if(um(t))throw Error(W(418));t.flags=t.flags&-4097|2,Me=!1,an=t}}}function Vv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;an=t}function Gc(t){if(t!==an)return!1;if(!Me)return Vv(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!om(t.type,t.memoizedProps)),e&&(e=sn)){if(um(t))throw OE(),Error(W(418));for(;e;)VE(t,e),e=ms(e.nextSibling)}if(Vv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){sn=ms(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}sn=null}}else sn=an?ms(t.stateNode.nextSibling):null;return!0}function OE(){for(var t=sn;t;)t=ms(t.nextSibling)}function jo(){sn=an=null,Me=!1}function Up(t){bn===null?bn=[t]:bn.push(t)}var jA=Pr.ReactCurrentBatchConfig;function Ca(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function Hc(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ov(t){var e=t._init;return e(t._payload)}function ME(t){function e(I,v){if(t){var S=I.deletions;S===null?(I.deletions=[v],I.flags|=16):S.push(v)}}function n(I,v){if(!t)return null;for(;v!==null;)e(I,v),v=v.sibling;return null}function r(I,v){for(I=new Map;v!==null;)v.key!==null?I.set(v.key,v):I.set(v.index,v),v=v.sibling;return I}function s(I,v){return I=vs(I,v),I.index=0,I.sibling=null,I}function i(I,v,S){return I.index=S,t?(S=I.alternate,S!==null?(S=S.index,S<v?(I.flags|=2,v):S):(I.flags|=2,v)):(I.flags|=1048576,v)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function a(I,v,S,D){return v===null||v.tag!==6?(v=yf(S,I.mode,D),v.return=I,v):(v=s(v,S),v.return=I,v)}function c(I,v,S,D){var L=S.type;return L===co?f(I,v,S.props.children,D,S.key):v!==null&&(v.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Jr&&Ov(L)===v.type)?(D=s(v,S.props),D.ref=Ca(I,v,S),D.return=I,D):(D=wu(S.type,S.key,S.props,null,I.mode,D),D.ref=Ca(I,v,S),D.return=I,D)}function d(I,v,S,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=vf(S,I.mode,D),v.return=I,v):(v=s(v,S.children||[]),v.return=I,v)}function f(I,v,S,D,L){return v===null||v.tag!==7?(v=fi(S,I.mode,D,L),v.return=I,v):(v=s(v,S),v.return=I,v)}function m(I,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=yf(""+v,I.mode,S),v.return=I,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Oc:return S=wu(v.type,v.key,v.props,null,I.mode,S),S.ref=Ca(I,null,v),S.return=I,S;case lo:return v=vf(v,I.mode,S),v.return=I,v;case Jr:var D=v._init;return m(I,D(v._payload),S)}if(Ua(v)||xa(v))return v=fi(v,I.mode,S,null),v.return=I,v;Hc(I,v)}return null}function g(I,v,S,D){var L=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return L!==null?null:a(I,v,""+S,D);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Oc:return S.key===L?c(I,v,S,D):null;case lo:return S.key===L?d(I,v,S,D):null;case Jr:return L=S._init,g(I,v,L(S._payload),D)}if(Ua(S)||xa(S))return L!==null?null:f(I,v,S,D,null);Hc(I,S)}return null}function x(I,v,S,D,L){if(typeof D=="string"&&D!==""||typeof D=="number")return I=I.get(S)||null,a(v,I,""+D,L);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Oc:return I=I.get(D.key===null?S:D.key)||null,c(v,I,D,L);case lo:return I=I.get(D.key===null?S:D.key)||null,d(v,I,D,L);case Jr:var V=D._init;return x(I,v,S,V(D._payload),L)}if(Ua(D)||xa(D))return I=I.get(S)||null,f(v,I,D,L,null);Hc(v,D)}return null}function A(I,v,S,D){for(var L=null,V=null,_=v,y=v=0,E=null;_!==null&&y<S.length;y++){_.index>y?(E=_,_=null):E=_.sibling;var T=g(I,_,S[y],D);if(T===null){_===null&&(_=E);break}t&&_&&T.alternate===null&&e(I,_),v=i(T,v,y),V===null?L=T:V.sibling=T,V=T,_=E}if(y===S.length)return n(I,_),Me&&Ys(I,y),L;if(_===null){for(;y<S.length;y++)_=m(I,S[y],D),_!==null&&(v=i(_,v,y),V===null?L=_:V.sibling=_,V=_);return Me&&Ys(I,y),L}for(_=r(I,_);y<S.length;y++)E=x(_,I,y,S[y],D),E!==null&&(t&&E.alternate!==null&&_.delete(E.key===null?y:E.key),v=i(E,v,y),V===null?L=E:V.sibling=E,V=E);return t&&_.forEach(function(P){return e(I,P)}),Me&&Ys(I,y),L}function N(I,v,S,D){var L=xa(S);if(typeof L!="function")throw Error(W(150));if(S=L.call(S),S==null)throw Error(W(151));for(var V=L=null,_=v,y=v=0,E=null,T=S.next();_!==null&&!T.done;y++,T=S.next()){_.index>y?(E=_,_=null):E=_.sibling;var P=g(I,_,T.value,D);if(P===null){_===null&&(_=E);break}t&&_&&P.alternate===null&&e(I,_),v=i(P,v,y),V===null?L=P:V.sibling=P,V=P,_=E}if(T.done)return n(I,_),Me&&Ys(I,y),L;if(_===null){for(;!T.done;y++,T=S.next())T=m(I,T.value,D),T!==null&&(v=i(T,v,y),V===null?L=T:V.sibling=T,V=T);return Me&&Ys(I,y),L}for(_=r(I,_);!T.done;y++,T=S.next())T=x(_,I,y,T.value,D),T!==null&&(t&&T.alternate!==null&&_.delete(T.key===null?y:T.key),v=i(T,v,y),V===null?L=T:V.sibling=T,V=T);return t&&_.forEach(function(b){return e(I,b)}),Me&&Ys(I,y),L}function C(I,v,S,D){if(typeof S=="object"&&S!==null&&S.type===co&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Oc:e:{for(var L=S.key,V=v;V!==null;){if(V.key===L){if(L=S.type,L===co){if(V.tag===7){n(I,V.sibling),v=s(V,S.props.children),v.return=I,I=v;break e}}else if(V.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Jr&&Ov(L)===V.type){n(I,V.sibling),v=s(V,S.props),v.ref=Ca(I,V,S),v.return=I,I=v;break e}n(I,V);break}else e(I,V);V=V.sibling}S.type===co?(v=fi(S.props.children,I.mode,D,S.key),v.return=I,I=v):(D=wu(S.type,S.key,S.props,null,I.mode,D),D.ref=Ca(I,v,S),D.return=I,I=D)}return o(I);case lo:e:{for(V=S.key;v!==null;){if(v.key===V)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){n(I,v.sibling),v=s(v,S.children||[]),v.return=I,I=v;break e}else{n(I,v);break}else e(I,v);v=v.sibling}v=vf(S,I.mode,D),v.return=I,I=v}return o(I);case Jr:return V=S._init,C(I,v,V(S._payload),D)}if(Ua(S))return A(I,v,S,D);if(xa(S))return N(I,v,S,D);Hc(I,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(n(I,v.sibling),v=s(v,S),v.return=I,I=v):(n(I,v),v=yf(S,I.mode,D),v.return=I,I=v),o(I)):n(I,v)}return C}var Vo=ME(!0),LE=ME(!1),Yu=js(null),Xu=null,vo=null,Bp=null;function zp(){Bp=vo=Xu=null}function $p(t){var e=Yu.current;Ve(Yu),t._currentValue=e}function hm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ko(t,e){Xu=t,Bp=vo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Gt=!0),t.firstContext=null)}function Tn(t){var e=t._currentValue;if(Bp!==t)if(t={context:t,memoizedValue:e,next:null},vo===null){if(Xu===null)throw Error(W(308));vo=t,Xu.dependencies={lanes:0,firstContext:t}}else vo=vo.next=t;return e}var li=null;function Wp(t){li===null?li=[t]:li.push(t)}function FE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Wp(e)):(n.next=s.next,s.next=n),e.interleaved=n,Tr(t,r)}function Tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zr=!1;function qp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function UE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ps(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Te&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Tr(t,n)}return s=r.interleaved,s===null?(e.next=e,Wp(r)):(e.next=s.next,s.next=e),r.interleaved=e,Tr(t,n)}function mu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Cp(t,n)}}function Mv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ju(t,e,n,r){var s=t.updateQueue;Zr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=d:a.next=d,f.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,f=d=c=null,a=i;do{var g=a.lane,x=a.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:x,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=t,N=a;switch(g=e,x=n,N.tag){case 1:if(A=N.payload,typeof A=="function"){m=A.call(x,m,g);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=N.payload,g=typeof A=="function"?A.call(x,m,g):A,g==null)break e;m=Ge({},m,g);break e;case 2:Zr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[a]:g.push(a))}else x={eventTime:x,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(d=f=x,c=m):f=f.next=x,o|=g;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;g=a,a=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(f===null&&(c=m),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);wi|=o,t.lanes=o,t.memoizedState=m}}function Lv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var nc={},Zn=js(nc),kl=js(nc),Al=js(nc);function ci(t){if(t===nc)throw Error(W(174));return t}function Gp(t,e){switch(be(Al,e),be(kl,t),be(Zn,nc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Gf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Gf(e,t)}Ve(Zn),be(Zn,e)}function Oo(){Ve(Zn),Ve(kl),Ve(Al)}function BE(t){ci(Al.current);var e=ci(Zn.current),n=Gf(e,t.type);e!==n&&(be(kl,t),be(Zn,n))}function Hp(t){kl.current===t&&(Ve(Zn),Ve(kl))}var Be=js(0);function Zu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var df=[];function Kp(){for(var t=0;t<df.length;t++)df[t]._workInProgressVersionPrimary=null;df.length=0}var pu=Pr.ReactCurrentDispatcher,hf=Pr.ReactCurrentBatchConfig,_i=0,$e=null,ot=null,dt=null,ed=!1,tl=!1,Pl=0,VA=0;function kt(){throw Error(W(321))}function Qp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!On(t[n],e[n]))return!1;return!0}function Yp(t,e,n,r,s,i){if(_i=i,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,pu.current=t===null||t.memoizedState===null?FA:UA,t=n(r,s),tl){i=0;do{if(tl=!1,Pl=0,25<=i)throw Error(W(301));i+=1,dt=ot=null,e.updateQueue=null,pu.current=BA,t=n(r,s)}while(tl)}if(pu.current=td,e=ot!==null&&ot.next!==null,_i=0,dt=ot=$e=null,ed=!1,e)throw Error(W(300));return t}function Xp(){var t=Pl!==0;return Pl=0,t}function Wn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?$e.memoizedState=dt=t:dt=dt.next=t,dt}function In(){if(ot===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=ot.next;var e=dt===null?$e.memoizedState:dt.next;if(e!==null)dt=e,ot=t;else{if(t===null)throw Error(W(310));ot=t,t={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},dt===null?$e.memoizedState=dt=t:dt=dt.next=t}return dt}function Nl(t,e){return typeof e=="function"?e(t):e}function ff(t){var e=In(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=ot,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,d=i;do{var f=d.lane;if((_i&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=m,o=r):c=c.next=m,$e.lanes|=f,wi|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=a,On(r,e.memoizedState)||(Gt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,$e.lanes|=i,wi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function mf(t){var e=In(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);On(i,e.memoizedState)||(Gt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function zE(){}function $E(t,e){var n=$e,r=In(),s=e(),i=!On(r.memoizedState,s);if(i&&(r.memoizedState=s,Gt=!0),r=r.queue,Jp(GE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||dt!==null&&dt.memoizedState.tag&1){if(n.flags|=2048,Cl(9,qE.bind(null,n,r,s,e),void 0,null),ht===null)throw Error(W(349));_i&30||WE(n,e,s)}return s}function WE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function qE(t,e,n,r){e.value=n,e.getSnapshot=r,HE(e)&&KE(t)}function GE(t,e,n){return n(function(){HE(e)&&KE(t)})}function HE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!On(t,n)}catch{return!0}}function KE(t){var e=Tr(t,1);e!==null&&Vn(e,t,1,-1)}function Fv(t){var e=Wn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nl,lastRenderedState:t},e.queue=t,t=t.dispatch=LA.bind(null,$e,t),[e.memoizedState,t]}function Cl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function QE(){return In().memoizedState}function gu(t,e,n,r){var s=Wn();$e.flags|=t,s.memoizedState=Cl(1|e,n,void 0,r===void 0?null:r)}function Wd(t,e,n,r){var s=In();r=r===void 0?null:r;var i=void 0;if(ot!==null){var o=ot.memoizedState;if(i=o.destroy,r!==null&&Qp(r,o.deps)){s.memoizedState=Cl(e,n,i,r);return}}$e.flags|=t,s.memoizedState=Cl(1|e,n,i,r)}function Uv(t,e){return gu(8390656,8,t,e)}function Jp(t,e){return Wd(2048,8,t,e)}function YE(t,e){return Wd(4,2,t,e)}function XE(t,e){return Wd(4,4,t,e)}function JE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ZE(t,e,n){return n=n!=null?n.concat([t]):null,Wd(4,4,JE.bind(null,e,t),n)}function Zp(){}function eT(t,e){var n=In();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function tT(t,e){var n=In();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function nT(t,e,n){return _i&21?(On(n,e)||(n=aE(),$e.lanes|=n,wi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Gt=!0),t.memoizedState=n)}function OA(t,e){var n=ke;ke=n!==0&&4>n?n:4,t(!0);var r=hf.transition;hf.transition={};try{t(!1),e()}finally{ke=n,hf.transition=r}}function rT(){return In().memoizedState}function MA(t,e,n){var r=ys(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},sT(t))iT(e,n);else if(n=FE(t,e,n,r),n!==null){var s=Ut();Vn(n,t,r,s),oT(n,e,r)}}function LA(t,e,n){var r=ys(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(sT(t))iT(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,On(a,o)){var c=e.interleaved;c===null?(s.next=s,Wp(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=FE(t,e,s,r),n!==null&&(s=Ut(),Vn(n,t,r,s),oT(n,e,r))}}function sT(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function iT(t,e){tl=ed=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function oT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Cp(t,n)}}var td={readContext:Tn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},FA={readContext:Tn,useCallback:function(t,e){return Wn().memoizedState=[t,e===void 0?null:e],t},useContext:Tn,useEffect:Uv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,gu(4194308,4,JE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return gu(4194308,4,t,e)},useInsertionEffect:function(t,e){return gu(4,2,t,e)},useMemo:function(t,e){var n=Wn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=MA.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=Wn();return t={current:t},e.memoizedState=t},useState:Fv,useDebugValue:Zp,useDeferredValue:function(t){return Wn().memoizedState=t},useTransition:function(){var t=Fv(!1),e=t[0];return t=OA.bind(null,t[1]),Wn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$e,s=Wn();if(Me){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),ht===null)throw Error(W(349));_i&30||WE(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Uv(GE.bind(null,r,i,t),[t]),r.flags|=2048,Cl(9,qE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Wn(),e=ht.identifierPrefix;if(Me){var n=fr,r=hr;n=(r&~(1<<32-jn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Pl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=VA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},UA={readContext:Tn,useCallback:eT,useContext:Tn,useEffect:Jp,useImperativeHandle:ZE,useInsertionEffect:YE,useLayoutEffect:XE,useMemo:tT,useReducer:ff,useRef:QE,useState:function(){return ff(Nl)},useDebugValue:Zp,useDeferredValue:function(t){var e=In();return nT(e,ot.memoizedState,t)},useTransition:function(){var t=ff(Nl)[0],e=In().memoizedState;return[t,e]},useMutableSource:zE,useSyncExternalStore:$E,useId:rT,unstable_isNewReconciler:!1},BA={readContext:Tn,useCallback:eT,useContext:Tn,useEffect:Jp,useImperativeHandle:ZE,useInsertionEffect:YE,useLayoutEffect:XE,useMemo:tT,useReducer:mf,useRef:QE,useState:function(){return mf(Nl)},useDebugValue:Zp,useDeferredValue:function(t){var e=In();return ot===null?e.memoizedState=t:nT(e,ot.memoizedState,t)},useTransition:function(){var t=mf(Nl)[0],e=In().memoizedState;return[t,e]},useMutableSource:zE,useSyncExternalStore:$E,useId:rT,unstable_isNewReconciler:!1};function Nn(t,e){if(t&&t.defaultProps){e=Ge({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function fm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ge({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var qd={isMounted:function(t){return(t=t._reactInternals)?Vi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ut(),s=ys(t),i=vr(r,s);i.payload=e,n!=null&&(i.callback=n),e=ps(t,i,s),e!==null&&(Vn(e,t,s,r),mu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ut(),s=ys(t),i=vr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ps(t,i,s),e!==null&&(Vn(e,t,s,r),mu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ut(),r=ys(t),s=vr(n,r);s.tag=2,e!=null&&(s.callback=e),e=ps(t,s,r),e!==null&&(Vn(e,t,r,n),mu(e,t,r))}};function Bv(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Tl(n,r)||!Tl(s,i):!0}function aT(t,e,n){var r=!1,s=As,i=e.contextType;return typeof i=="object"&&i!==null?i=Tn(i):(s=Qt(e)?yi:Vt.current,r=e.contextTypes,i=(r=r!=null)?Do(t,s):As),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function zv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&qd.enqueueReplaceState(e,e.state,null)}function mm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},qp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Tn(i):(i=Qt(e)?yi:Vt.current,s.context=Do(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(fm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&qd.enqueueReplaceState(s,s.state,null),Ju(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Mo(t,e){try{var n="",r=e;do n+=pk(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function pf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function pm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var zA=typeof WeakMap=="function"?WeakMap:Map;function lT(t,e,n){n=vr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){rd||(rd=!0,xm=r),pm(t,e)},n}function cT(t,e,n){n=vr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){pm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){pm(t,e),typeof r!="function"&&(gs===null?gs=new Set([this]):gs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function $v(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new zA;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=nP.bind(null,t,e,n),e.then(t,t))}function Wv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function qv(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=vr(-1,1),e.tag=2,ps(n,e,1))),n.lanes|=1),t)}var $A=Pr.ReactCurrentOwner,Gt=!1;function Lt(t,e,n,r){e.child=t===null?LE(e,null,n,r):Vo(e,t.child,n,r)}function Gv(t,e,n,r,s){n=n.render;var i=e.ref;return ko(e,s),r=Yp(t,e,n,r,i,s),n=Xp(),t!==null&&!Gt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ir(t,e,s)):(Me&&n&&Lp(e),e.flags|=1,Lt(t,e,r,s),e.child)}function Hv(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!ag(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,uT(t,e,i,r,s)):(t=wu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Tl,n(o,r)&&t.ref===e.ref)return Ir(t,e,s)}return e.flags|=1,t=vs(i,r),t.ref=e.ref,t.return=e,e.child=t}function uT(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Tl(i,r)&&t.ref===e.ref)if(Gt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Gt=!0);else return e.lanes=t.lanes,Ir(t,e,s)}return gm(t,e,n,r,s)}function dT(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(wo,en),en|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(wo,en),en|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,be(wo,en),en|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,be(wo,en),en|=r;return Lt(t,e,s,n),e.child}function hT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function gm(t,e,n,r,s){var i=Qt(n)?yi:Vt.current;return i=Do(e,i),ko(e,s),n=Yp(t,e,n,r,i,s),r=Xp(),t!==null&&!Gt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ir(t,e,s)):(Me&&r&&Lp(e),e.flags|=1,Lt(t,e,n,s),e.child)}function Kv(t,e,n,r,s){if(Qt(n)){var i=!0;Hu(e)}else i=!1;if(ko(e,s),e.stateNode===null)yu(t,e),aT(e,n,r),mm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Tn(d):(d=Qt(n)?yi:Vt.current,d=Do(e,d));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==d)&&zv(e,o,r,d),Zr=!1;var g=e.memoizedState;o.state=g,Ju(e,r,o,s),c=e.memoizedState,a!==r||g!==c||Kt.current||Zr?(typeof f=="function"&&(fm(e,n,f,r),c=e.memoizedState),(a=Zr||Bv(e,n,a,r,g,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,UE(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Nn(e.type,a),o.props=d,m=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Tn(c):(c=Qt(n)?yi:Vt.current,c=Do(e,c));var x=n.getDerivedStateFromProps;(f=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==c)&&zv(e,o,r,c),Zr=!1,g=e.memoizedState,o.state=g,Ju(e,r,o,s);var A=e.memoizedState;a!==m||g!==A||Kt.current||Zr?(typeof x=="function"&&(fm(e,n,x,r),A=e.memoizedState),(d=Zr||Bv(e,n,d,r,g,A,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return ym(t,e,n,r,i,s)}function ym(t,e,n,r,s,i){hT(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Dv(e,n,!1),Ir(t,e,i);r=e.stateNode,$A.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Vo(e,t.child,null,i),e.child=Vo(e,null,a,i)):Lt(t,e,a,i),e.memoizedState=r.state,s&&Dv(e,n,!0),e.child}function fT(t){var e=t.stateNode;e.pendingContext?bv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&bv(t,e.context,!1),Gp(t,e.containerInfo)}function Qv(t,e,n,r,s){return jo(),Up(s),e.flags|=256,Lt(t,e,n,r),e.child}var vm={dehydrated:null,treeContext:null,retryLane:0};function _m(t){return{baseLanes:t,cachePool:null,transitions:null}}function mT(t,e,n){var r=e.pendingProps,s=Be.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),be(Be,s&1),t===null)return dm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Kd(o,r,0,null),t=fi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=_m(n),e.memoizedState=vm,t):eg(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return WA(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=vs(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=vs(a,i):(i=fi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?_m(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=vm,r}return i=t.child,t=i.sibling,r=vs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function eg(t,e){return e=Kd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Kc(t,e,n,r){return r!==null&&Up(r),Vo(e,t.child,null,n),t=eg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function WA(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=pf(Error(W(422))),Kc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Kd({mode:"visible",children:r.children},s,0,null),i=fi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Vo(e,t.child,null,o),e.child.memoizedState=_m(o),e.memoizedState=vm,i);if(!(e.mode&1))return Kc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(W(419)),r=pf(i,r,void 0),Kc(t,e,o,r)}if(a=(o&t.childLanes)!==0,Gt||a){if(r=ht,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Tr(t,s),Vn(r,t,s,-1))}return og(),r=pf(Error(W(421))),Kc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=rP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,sn=ms(s.nextSibling),an=e,Me=!0,bn=null,t!==null&&(gn[yn++]=hr,gn[yn++]=fr,gn[yn++]=vi,hr=t.id,fr=t.overflow,vi=e),e=eg(e,r.children),e.flags|=4096,e)}function Yv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),hm(t.return,e,n)}function gf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function pT(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Lt(t,e,r.children,n),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Yv(t,n,e);else if(t.tag===19)Yv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Be,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Zu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),gf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Zu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}gf(e,!0,n,null,i);break;case"together":gf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ir(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),wi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=vs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function qA(t,e,n){switch(e.tag){case 3:fT(e),jo();break;case 5:BE(e);break;case 1:Qt(e.type)&&Hu(e);break;case 4:Gp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;be(Yu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Be,Be.current&1),e.flags|=128,null):n&e.child.childLanes?mT(t,e,n):(be(Be,Be.current&1),t=Ir(t,e,n),t!==null?t.sibling:null);be(Be,Be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return pT(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),be(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,dT(t,e,n)}return Ir(t,e,n)}var gT,wm,yT,vT;gT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wm=function(){};yT=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ci(Zn.current);var i=null;switch(n){case"input":s=zf(t,s),r=zf(t,r),i=[];break;case"select":s=Ge({},s,{value:void 0}),r=Ge({},r,{value:void 0}),i=[];break;case"textarea":s=qf(t,s),r=qf(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=qu)}Hf(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(pl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(pl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&je("scroll",t),i||a===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};vT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ra(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function At(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function GA(t,e,n){var r=e.pendingProps;switch(Fp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(e),null;case 1:return Qt(e.type)&&Gu(),At(e),null;case 3:return r=e.stateNode,Oo(),Ve(Kt),Ve(Vt),Kp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Gc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bn!==null&&(Pm(bn),bn=null))),wm(t,e),At(e),null;case 5:Hp(e);var s=ci(Al.current);if(n=e.type,t!==null&&e.stateNode!=null)yT(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return At(e),null}if(t=ci(Zn.current),Gc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Gn]=e,r[xl]=i,t=(e.mode&1)!==0,n){case"dialog":je("cancel",r),je("close",r);break;case"iframe":case"object":case"embed":je("load",r);break;case"video":case"audio":for(s=0;s<za.length;s++)je(za[s],r);break;case"source":je("error",r);break;case"img":case"image":case"link":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"input":iv(r,i),je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},je("invalid",r);break;case"textarea":av(r,i),je("invalid",r)}Hf(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&qc(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&qc(r.textContent,a,t),s=["children",""+a]):pl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&je("scroll",r)}switch(n){case"input":Mc(r),ov(r,i,!0);break;case"textarea":Mc(r),lv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=qu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=G0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Gn]=e,t[xl]=r,gT(t,e,!1,!1),e.stateNode=t;e:{switch(o=Kf(n,r),n){case"dialog":je("cancel",t),je("close",t),s=r;break;case"iframe":case"object":case"embed":je("load",t),s=r;break;case"video":case"audio":for(s=0;s<za.length;s++)je(za[s],t);s=r;break;case"source":je("error",t),s=r;break;case"img":case"image":case"link":je("error",t),je("load",t),s=r;break;case"details":je("toggle",t),s=r;break;case"input":iv(t,r),s=zf(t,r),je("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ge({},r,{value:void 0}),je("invalid",t);break;case"textarea":av(t,r),s=qf(t,r),je("invalid",t);break;default:s=r}Hf(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?Q0(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&H0(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&gl(t,c):typeof c=="number"&&gl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(pl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&je("scroll",t):c!=null&&Sp(t,i,c,o))}switch(n){case"input":Mc(t),ov(t,r,!1);break;case"textarea":Mc(t),lv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ks(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?To(t,!!r.multiple,i,!1):r.defaultValue!=null&&To(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=qu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return At(e),null;case 6:if(t&&e.stateNode!=null)vT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=ci(Al.current),ci(Zn.current),Gc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Gn]=e,(i=r.nodeValue!==n)&&(t=an,t!==null))switch(t.tag){case 3:qc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gn]=e,e.stateNode=r}return At(e),null;case 13:if(Ve(Be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&sn!==null&&e.mode&1&&!(e.flags&128))OE(),jo(),e.flags|=98560,i=!1;else if(i=Gc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Gn]=e}else jo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;At(e),i=!1}else bn!==null&&(Pm(bn),bn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Be.current&1?at===0&&(at=3):og())),e.updateQueue!==null&&(e.flags|=4),At(e),null);case 4:return Oo(),wm(t,e),t===null&&Il(e.stateNode.containerInfo),At(e),null;case 10:return $p(e.type._context),At(e),null;case 17:return Qt(e.type)&&Gu(),At(e),null;case 19:if(Ve(Be),i=e.memoizedState,i===null)return At(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ra(i,!1);else{if(at!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Zu(t),o!==null){for(e.flags|=128,Ra(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Be,Be.current&1|2),e.child}t=t.sibling}i.tail!==null&&Je()>Lo&&(e.flags|=128,r=!0,Ra(i,!1),e.lanes=4194304)}else{if(!r)if(t=Zu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ra(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Me)return At(e),null}else 2*Je()-i.renderingStartTime>Lo&&n!==1073741824&&(e.flags|=128,r=!0,Ra(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Je(),e.sibling=null,n=Be.current,be(Be,r?n&1|2:n&1),e):(At(e),null);case 22:case 23:return ig(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?en&1073741824&&(At(e),e.subtreeFlags&6&&(e.flags|=8192)):At(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function HA(t,e){switch(Fp(e),e.tag){case 1:return Qt(e.type)&&Gu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Oo(),Ve(Kt),Ve(Vt),Kp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Hp(e),null;case 13:if(Ve(Be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));jo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ve(Be),null;case 4:return Oo(),null;case 10:return $p(e.type._context),null;case 22:case 23:return ig(),null;case 24:return null;default:return null}}var Qc=!1,Rt=!1,KA=typeof WeakSet=="function"?WeakSet:Set,Y=null;function _o(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ke(t,e,r)}else n.current=null}function Em(t,e,n){try{n()}catch(r){Ke(t,e,r)}}var Xv=!1;function QA(t,e){if(sm=zu,t=IE(),Mp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,d=0,f=0,m=t,g=null;t:for(;;){for(var x;m!==n||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)g=m,m=x;for(;;){if(m===t)break t;if(g===n&&++d===s&&(a=o),g===i&&++f===r&&(c=o),(x=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=x}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(im={focusedElem:t,selectionRange:n},zu=!1,Y=e;Y!==null;)if(e=Y,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Y=t;else for(;Y!==null;){e=Y;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var N=A.memoizedProps,C=A.memoizedState,I=e.stateNode,v=I.getSnapshotBeforeUpdate(e.elementType===e.type?N:Nn(e.type,N),C);I.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(D){Ke(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}return A=Xv,Xv=!1,A}function nl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Em(e,n,i)}s=s.next}while(s!==r)}}function Gd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Tm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function _T(t){var e=t.alternate;e!==null&&(t.alternate=null,_T(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Gn],delete e[xl],delete e[lm],delete e[RA],delete e[bA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function wT(t){return t.tag===5||t.tag===3||t.tag===4}function Jv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||wT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Im(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qu));else if(r!==4&&(t=t.child,t!==null))for(Im(t,e,n),t=t.sibling;t!==null;)Im(t,e,n),t=t.sibling}function Sm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Sm(t,e,n),t=t.sibling;t!==null;)Sm(t,e,n),t=t.sibling}var yt=null,Cn=!1;function Gr(t,e,n){for(n=n.child;n!==null;)ET(t,e,n),n=n.sibling}function ET(t,e,n){if(Jn&&typeof Jn.onCommitFiberUnmount=="function")try{Jn.onCommitFiberUnmount(Ld,n)}catch{}switch(n.tag){case 5:Rt||_o(n,e);case 6:var r=yt,s=Cn;yt=null,Gr(t,e,n),yt=r,Cn=s,yt!==null&&(Cn?(t=yt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):yt.removeChild(n.stateNode));break;case 18:yt!==null&&(Cn?(t=yt,n=n.stateNode,t.nodeType===8?cf(t.parentNode,n):t.nodeType===1&&cf(t,n),wl(t)):cf(yt,n.stateNode));break;case 4:r=yt,s=Cn,yt=n.stateNode.containerInfo,Cn=!0,Gr(t,e,n),yt=r,Cn=s;break;case 0:case 11:case 14:case 15:if(!Rt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Em(n,e,o),s=s.next}while(s!==r)}Gr(t,e,n);break;case 1:if(!Rt&&(_o(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ke(n,e,a)}Gr(t,e,n);break;case 21:Gr(t,e,n);break;case 22:n.mode&1?(Rt=(r=Rt)||n.memoizedState!==null,Gr(t,e,n),Rt=r):Gr(t,e,n);break;default:Gr(t,e,n)}}function Zv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new KA),e.forEach(function(r){var s=sP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Pn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:yt=a.stateNode,Cn=!1;break e;case 3:yt=a.stateNode.containerInfo,Cn=!0;break e;case 4:yt=a.stateNode.containerInfo,Cn=!0;break e}a=a.return}if(yt===null)throw Error(W(160));ET(i,o,s),yt=null,Cn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Ke(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)TT(e,t),e=e.sibling}function TT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Pn(e,t),$n(t),r&4){try{nl(3,t,t.return),Gd(3,t)}catch(N){Ke(t,t.return,N)}try{nl(5,t,t.return)}catch(N){Ke(t,t.return,N)}}break;case 1:Pn(e,t),$n(t),r&512&&n!==null&&_o(n,n.return);break;case 5:if(Pn(e,t),$n(t),r&512&&n!==null&&_o(n,n.return),t.flags&32){var s=t.stateNode;try{gl(s,"")}catch(N){Ke(t,t.return,N)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&W0(s,i),Kf(a,o);var d=Kf(a,i);for(o=0;o<c.length;o+=2){var f=c[o],m=c[o+1];f==="style"?Q0(s,m):f==="dangerouslySetInnerHTML"?H0(s,m):f==="children"?gl(s,m):Sp(s,f,m,d)}switch(a){case"input":$f(s,i);break;case"textarea":q0(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?To(s,!!i.multiple,x,!1):g!==!!i.multiple&&(i.defaultValue!=null?To(s,!!i.multiple,i.defaultValue,!0):To(s,!!i.multiple,i.multiple?[]:"",!1))}s[xl]=i}catch(N){Ke(t,t.return,N)}}break;case 6:if(Pn(e,t),$n(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(N){Ke(t,t.return,N)}}break;case 3:if(Pn(e,t),$n(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{wl(e.containerInfo)}catch(N){Ke(t,t.return,N)}break;case 4:Pn(e,t),$n(t);break;case 13:Pn(e,t),$n(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(rg=Je())),r&4&&Zv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Rt=(d=Rt)||f,Pn(e,t),Rt=d):Pn(e,t),$n(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(Y=t,f=t.child;f!==null;){for(m=Y=f;Y!==null;){switch(g=Y,x=g.child,g.tag){case 0:case 11:case 14:case 15:nl(4,g,g.return);break;case 1:_o(g,g.return);var A=g.stateNode;if(typeof A.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(N){Ke(r,n,N)}}break;case 5:_o(g,g.return);break;case 22:if(g.memoizedState!==null){t_(m);continue}}x!==null?(x.return=g,Y=x):t_(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=K0("display",o))}catch(N){Ke(t,t.return,N)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(N){Ke(t,t.return,N)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Pn(e,t),$n(t),r&4&&Zv(t);break;case 21:break;default:Pn(e,t),$n(t)}}function $n(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(wT(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(gl(s,""),r.flags&=-33);var i=Jv(t);Sm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Jv(t);Im(t,a,o);break;default:throw Error(W(161))}}catch(c){Ke(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function YA(t,e,n){Y=t,IT(t)}function IT(t,e,n){for(var r=(t.mode&1)!==0;Y!==null;){var s=Y,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Qc;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Rt;a=Qc;var d=Rt;if(Qc=o,(Rt=c)&&!d)for(Y=s;Y!==null;)o=Y,c=o.child,o.tag===22&&o.memoizedState!==null?n_(s):c!==null?(c.return=o,Y=c):n_(s);for(;i!==null;)Y=i,IT(i),i=i.sibling;Y=s,Qc=a,Rt=d}e_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Y=i):e_(t)}}function e_(t){for(;Y!==null;){var e=Y;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Rt||Gd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Rt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Nn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Lv(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Lv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&wl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Rt||e.flags&512&&Tm(e)}catch(g){Ke(e,e.return,g)}}if(e===t){Y=null;break}if(n=e.sibling,n!==null){n.return=e.return,Y=n;break}Y=e.return}}function t_(t){for(;Y!==null;){var e=Y;if(e===t){Y=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Y=n;break}Y=e.return}}function n_(t){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Gd(4,e)}catch(c){Ke(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Ke(e,s,c)}}var i=e.return;try{Tm(e)}catch(c){Ke(e,i,c)}break;case 5:var o=e.return;try{Tm(e)}catch(c){Ke(e,o,c)}}}catch(c){Ke(e,e.return,c)}if(e===t){Y=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Y=a;break}Y=e.return}}var XA=Math.ceil,nd=Pr.ReactCurrentDispatcher,tg=Pr.ReactCurrentOwner,wn=Pr.ReactCurrentBatchConfig,Te=0,ht=null,tt=null,wt=0,en=0,wo=js(0),at=0,Rl=null,wi=0,Hd=0,ng=0,rl=null,qt=null,rg=0,Lo=1/0,ur=null,rd=!1,xm=null,gs=null,Yc=!1,ls=null,sd=0,sl=0,km=null,vu=-1,_u=0;function Ut(){return Te&6?Je():vu!==-1?vu:vu=Je()}function ys(t){return t.mode&1?Te&2&&wt!==0?wt&-wt:jA.transition!==null?(_u===0&&(_u=aE()),_u):(t=ke,t!==0||(t=window.event,t=t===void 0?16:mE(t.type)),t):1}function Vn(t,e,n,r){if(50<sl)throw sl=0,km=null,Error(W(185));Zl(t,n,r),(!(Te&2)||t!==ht)&&(t===ht&&(!(Te&2)&&(Hd|=n),at===4&&ts(t,wt)),Yt(t,r),n===1&&Te===0&&!(e.mode&1)&&(Lo=Je()+500,$d&&Vs()))}function Yt(t,e){var n=t.callbackNode;jk(t,e);var r=Bu(t,t===ht?wt:0);if(r===0)n!==null&&dv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&dv(n),e===1)t.tag===0?DA(r_.bind(null,t)):DE(r_.bind(null,t)),NA(function(){!(Te&6)&&Vs()}),n=null;else{switch(lE(r)){case 1:n=Np;break;case 4:n=iE;break;case 16:n=Uu;break;case 536870912:n=oE;break;default:n=Uu}n=RT(n,ST.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ST(t,e){if(vu=-1,_u=0,Te&6)throw Error(W(327));var n=t.callbackNode;if(Ao()&&t.callbackNode!==n)return null;var r=Bu(t,t===ht?wt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=id(t,r);else{e=r;var s=Te;Te|=2;var i=kT();(ht!==t||wt!==e)&&(ur=null,Lo=Je()+500,hi(t,e));do try{eP();break}catch(a){xT(t,a)}while(!0);zp(),nd.current=i,Te=s,tt!==null?e=0:(ht=null,wt=0,e=at)}if(e!==0){if(e===2&&(s=Zf(t),s!==0&&(r=s,e=Am(t,s))),e===1)throw n=Rl,hi(t,0),ts(t,r),Yt(t,Je()),n;if(e===6)ts(t,r);else{if(s=t.current.alternate,!(r&30)&&!JA(s)&&(e=id(t,r),e===2&&(i=Zf(t),i!==0&&(r=i,e=Am(t,i))),e===1))throw n=Rl,hi(t,0),ts(t,r),Yt(t,Je()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:Xs(t,qt,ur);break;case 3:if(ts(t,r),(r&130023424)===r&&(e=rg+500-Je(),10<e)){if(Bu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ut(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=am(Xs.bind(null,t,qt,ur),e);break}Xs(t,qt,ur);break;case 4:if(ts(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-jn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Je()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*XA(r/1960))-r,10<r){t.timeoutHandle=am(Xs.bind(null,t,qt,ur),r);break}Xs(t,qt,ur);break;case 5:Xs(t,qt,ur);break;default:throw Error(W(329))}}}return Yt(t,Je()),t.callbackNode===n?ST.bind(null,t):null}function Am(t,e){var n=rl;return t.current.memoizedState.isDehydrated&&(hi(t,e).flags|=256),t=id(t,e),t!==2&&(e=qt,qt=n,e!==null&&Pm(e)),t}function Pm(t){qt===null?qt=t:qt.push.apply(qt,t)}function JA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!On(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ts(t,e){for(e&=~ng,e&=~Hd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-jn(e),r=1<<n;t[n]=-1,e&=~r}}function r_(t){if(Te&6)throw Error(W(327));Ao();var e=Bu(t,0);if(!(e&1))return Yt(t,Je()),null;var n=id(t,e);if(t.tag!==0&&n===2){var r=Zf(t);r!==0&&(e=r,n=Am(t,r))}if(n===1)throw n=Rl,hi(t,0),ts(t,e),Yt(t,Je()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xs(t,qt,ur),Yt(t,Je()),null}function sg(t,e){var n=Te;Te|=1;try{return t(e)}finally{Te=n,Te===0&&(Lo=Je()+500,$d&&Vs())}}function Ei(t){ls!==null&&ls.tag===0&&!(Te&6)&&Ao();var e=Te;Te|=1;var n=wn.transition,r=ke;try{if(wn.transition=null,ke=1,t)return t()}finally{ke=r,wn.transition=n,Te=e,!(Te&6)&&Vs()}}function ig(){en=wo.current,Ve(wo)}function hi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,PA(n)),tt!==null)for(n=tt.return;n!==null;){var r=n;switch(Fp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Gu();break;case 3:Oo(),Ve(Kt),Ve(Vt),Kp();break;case 5:Hp(r);break;case 4:Oo();break;case 13:Ve(Be);break;case 19:Ve(Be);break;case 10:$p(r.type._context);break;case 22:case 23:ig()}n=n.return}if(ht=t,tt=t=vs(t.current,null),wt=en=e,at=0,Rl=null,ng=Hd=wi=0,qt=rl=null,li!==null){for(e=0;e<li.length;e++)if(n=li[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}li=null}return t}function xT(t,e){do{var n=tt;try{if(zp(),pu.current=td,ed){for(var r=$e.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ed=!1}if(_i=0,dt=ot=$e=null,tl=!1,Pl=0,tg.current=null,n===null||n.return===null){at=1,Rl=e,tt=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=wt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var x=Wv(o);if(x!==null){x.flags&=-257,qv(x,o,a,i,e),x.mode&1&&$v(i,d,e),e=x,c=d;var A=e.updateQueue;if(A===null){var N=new Set;N.add(c),e.updateQueue=N}else A.add(c);break e}else{if(!(e&1)){$v(i,d,e),og();break e}c=Error(W(426))}}else if(Me&&a.mode&1){var C=Wv(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),qv(C,o,a,i,e),Up(Mo(c,a));break e}}i=c=Mo(c,a),at!==4&&(at=2),rl===null?rl=[i]:rl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=lT(i,c,e);Mv(i,I);break e;case 1:a=c;var v=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(gs===null||!gs.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=cT(i,a,e);Mv(i,D);break e}}i=i.return}while(i!==null)}PT(n)}catch(L){e=L,tt===n&&n!==null&&(tt=n=n.return);continue}break}while(!0)}function kT(){var t=nd.current;return nd.current=td,t===null?td:t}function og(){(at===0||at===3||at===2)&&(at=4),ht===null||!(wi&268435455)&&!(Hd&268435455)||ts(ht,wt)}function id(t,e){var n=Te;Te|=2;var r=kT();(ht!==t||wt!==e)&&(ur=null,hi(t,e));do try{ZA();break}catch(s){xT(t,s)}while(!0);if(zp(),Te=n,nd.current=r,tt!==null)throw Error(W(261));return ht=null,wt=0,at}function ZA(){for(;tt!==null;)AT(tt)}function eP(){for(;tt!==null&&!xk();)AT(tt)}function AT(t){var e=CT(t.alternate,t,en);t.memoizedProps=t.pendingProps,e===null?PT(t):tt=e,tg.current=null}function PT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=HA(n,e),n!==null){n.flags&=32767,tt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{at=6,tt=null;return}}else if(n=GA(n,e,en),n!==null){tt=n;return}if(e=e.sibling,e!==null){tt=e;return}tt=e=t}while(e!==null);at===0&&(at=5)}function Xs(t,e,n){var r=ke,s=wn.transition;try{wn.transition=null,ke=1,tP(t,e,n,r)}finally{wn.transition=s,ke=r}return null}function tP(t,e,n,r){do Ao();while(ls!==null);if(Te&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Vk(t,i),t===ht&&(tt=ht=null,wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Yc||(Yc=!0,RT(Uu,function(){return Ao(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=wn.transition,wn.transition=null;var o=ke;ke=1;var a=Te;Te|=4,tg.current=null,QA(t,n),TT(n,t),EA(im),zu=!!sm,im=sm=null,t.current=n,YA(n),kk(),Te=a,ke=o,wn.transition=i}else t.current=n;if(Yc&&(Yc=!1,ls=t,sd=s),i=t.pendingLanes,i===0&&(gs=null),Nk(n.stateNode),Yt(t,Je()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(rd)throw rd=!1,t=xm,xm=null,t;return sd&1&&t.tag!==0&&Ao(),i=t.pendingLanes,i&1?t===km?sl++:(sl=0,km=t):sl=0,Vs(),null}function Ao(){if(ls!==null){var t=lE(sd),e=wn.transition,n=ke;try{if(wn.transition=null,ke=16>t?16:t,ls===null)var r=!1;else{if(t=ls,ls=null,sd=0,Te&6)throw Error(W(331));var s=Te;for(Te|=4,Y=t.current;Y!==null;){var i=Y,o=i.child;if(Y.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(Y=d;Y!==null;){var f=Y;switch(f.tag){case 0:case 11:case 15:nl(8,f,i)}var m=f.child;if(m!==null)m.return=f,Y=m;else for(;Y!==null;){f=Y;var g=f.sibling,x=f.return;if(_T(f),f===d){Y=null;break}if(g!==null){g.return=x,Y=g;break}Y=x}}}var A=i.alternate;if(A!==null){var N=A.child;if(N!==null){A.child=null;do{var C=N.sibling;N.sibling=null,N=C}while(N!==null)}}Y=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Y=o;else e:for(;Y!==null;){if(i=Y,i.flags&2048)switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,Y=I;break e}Y=i.return}}var v=t.current;for(Y=v;Y!==null;){o=Y;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Y=S;else e:for(o=v;Y!==null;){if(a=Y,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Gd(9,a)}}catch(L){Ke(a,a.return,L)}if(a===o){Y=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,Y=D;break e}Y=a.return}}if(Te=s,Vs(),Jn&&typeof Jn.onPostCommitFiberRoot=="function")try{Jn.onPostCommitFiberRoot(Ld,t)}catch{}r=!0}return r}finally{ke=n,wn.transition=e}}return!1}function s_(t,e,n){e=Mo(n,e),e=lT(t,e,1),t=ps(t,e,1),e=Ut(),t!==null&&(Zl(t,1,e),Yt(t,e))}function Ke(t,e,n){if(t.tag===3)s_(t,t,n);else for(;e!==null;){if(e.tag===3){s_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gs===null||!gs.has(r))){t=Mo(n,t),t=cT(e,t,1),e=ps(e,t,1),t=Ut(),e!==null&&(Zl(e,1,t),Yt(e,t));break}}e=e.return}}function nP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ut(),t.pingedLanes|=t.suspendedLanes&n,ht===t&&(wt&n)===n&&(at===4||at===3&&(wt&130023424)===wt&&500>Je()-rg?hi(t,0):ng|=n),Yt(t,e)}function NT(t,e){e===0&&(t.mode&1?(e=Uc,Uc<<=1,!(Uc&130023424)&&(Uc=4194304)):e=1);var n=Ut();t=Tr(t,e),t!==null&&(Zl(t,e,n),Yt(t,n))}function rP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),NT(t,n)}function sP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),NT(t,n)}var CT;CT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Kt.current)Gt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Gt=!1,qA(t,e,n);Gt=!!(t.flags&131072)}else Gt=!1,Me&&e.flags&1048576&&jE(e,Qu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;yu(t,e),t=e.pendingProps;var s=Do(e,Vt.current);ko(e,n),s=Yp(null,e,r,t,s,n);var i=Xp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qt(r)?(i=!0,Hu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,qp(e),s.updater=qd,e.stateNode=s,s._reactInternals=e,mm(e,r,t,n),e=ym(null,e,r,!0,i,n)):(e.tag=0,Me&&i&&Lp(e),Lt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(yu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=oP(r),t=Nn(r,t),s){case 0:e=gm(null,e,r,t,n);break e;case 1:e=Kv(null,e,r,t,n);break e;case 11:e=Gv(null,e,r,t,n);break e;case 14:e=Hv(null,e,r,Nn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),gm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),Kv(t,e,r,s,n);case 3:e:{if(fT(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,UE(t,e),Ju(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Mo(Error(W(423)),e),e=Qv(t,e,r,n,s);break e}else if(r!==s){s=Mo(Error(W(424)),e),e=Qv(t,e,r,n,s);break e}else for(sn=ms(e.stateNode.containerInfo.firstChild),an=e,Me=!0,bn=null,n=LE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(jo(),r===s){e=Ir(t,e,n);break e}Lt(t,e,r,n)}e=e.child}return e;case 5:return BE(e),t===null&&dm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,om(r,s)?o=null:i!==null&&om(r,i)&&(e.flags|=32),hT(t,e),Lt(t,e,o,n),e.child;case 6:return t===null&&dm(e),null;case 13:return mT(t,e,n);case 4:return Gp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Vo(e,null,r,n):Lt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),Gv(t,e,r,s,n);case 7:return Lt(t,e,e.pendingProps,n),e.child;case 8:return Lt(t,e,e.pendingProps.children,n),e.child;case 12:return Lt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,be(Yu,r._currentValue),r._currentValue=o,i!==null)if(On(i.value,o)){if(i.children===s.children&&!Kt.current){e=Ir(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=vr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),hm(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),hm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Lt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ko(e,n),s=Tn(s),r=r(s),e.flags|=1,Lt(t,e,r,n),e.child;case 14:return r=e.type,s=Nn(r,e.pendingProps),s=Nn(r.type,s),Hv(t,e,r,s,n);case 15:return uT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),yu(t,e),e.tag=1,Qt(r)?(t=!0,Hu(e)):t=!1,ko(e,n),aT(e,r,s),mm(e,r,s,n),ym(null,e,r,!0,t,n);case 19:return pT(t,e,n);case 22:return dT(t,e,n)}throw Error(W(156,e.tag))};function RT(t,e){return sE(t,e)}function iP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vn(t,e,n,r){return new iP(t,e,n,r)}function ag(t){return t=t.prototype,!(!t||!t.isReactComponent)}function oP(t){if(typeof t=="function")return ag(t)?1:0;if(t!=null){if(t=t.$$typeof,t===kp)return 11;if(t===Ap)return 14}return 2}function vs(t,e){var n=t.alternate;return n===null?(n=vn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function wu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")ag(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case co:return fi(n.children,s,i,e);case xp:o=8,s|=8;break;case Lf:return t=vn(12,n,e,s|2),t.elementType=Lf,t.lanes=i,t;case Ff:return t=vn(13,n,e,s),t.elementType=Ff,t.lanes=i,t;case Uf:return t=vn(19,n,e,s),t.elementType=Uf,t.lanes=i,t;case B0:return Kd(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case F0:o=10;break e;case U0:o=9;break e;case kp:o=11;break e;case Ap:o=14;break e;case Jr:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=vn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function fi(t,e,n,r){return t=vn(7,t,r,e),t.lanes=n,t}function Kd(t,e,n,r){return t=vn(22,t,r,e),t.elementType=B0,t.lanes=n,t.stateNode={isHidden:!1},t}function yf(t,e,n){return t=vn(6,t,null,e),t.lanes=n,t}function vf(t,e,n){return e=vn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function aP(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xh(0),this.expirationTimes=Xh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function lg(t,e,n,r,s,i,o,a,c){return t=new aP(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=vn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qp(i),t}function lP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:lo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function bT(t){if(!t)return As;t=t._reactInternals;e:{if(Vi(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(Qt(n))return bE(t,n,e)}return e}function DT(t,e,n,r,s,i,o,a,c){return t=lg(n,r,!0,t,s,i,o,a,c),t.context=bT(null),n=t.current,r=Ut(),s=ys(n),i=vr(r,s),i.callback=e??null,ps(n,i,s),t.current.lanes=s,Zl(t,s,r),Yt(t,r),t}function Qd(t,e,n,r){var s=e.current,i=Ut(),o=ys(s);return n=bT(n),e.context===null?e.context=n:e.pendingContext=n,e=vr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ps(s,e,o),t!==null&&(Vn(t,s,o,i),mu(t,s,o)),o}function od(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function i_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function cg(t,e){i_(t,e),(t=t.alternate)&&i_(t,e)}function cP(){return null}var jT=typeof reportError=="function"?reportError:function(t){console.error(t)};function ug(t){this._internalRoot=t}Yd.prototype.render=ug.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Qd(t,e,null,null)};Yd.prototype.unmount=ug.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ei(function(){Qd(null,t,null,null)}),e[Er]=null}};function Yd(t){this._internalRoot=t}Yd.prototype.unstable_scheduleHydration=function(t){if(t){var e=dE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<es.length&&e!==0&&e<es[n].priority;n++);es.splice(n,0,t),n===0&&fE(t)}};function dg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Xd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function o_(){}function uP(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=od(o);i.call(d)}}var o=DT(e,r,t,0,null,!1,!1,"",o_);return t._reactRootContainer=o,t[Er]=o.current,Il(t.nodeType===8?t.parentNode:t),Ei(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=od(c);a.call(d)}}var c=lg(t,0,!1,null,null,!1,!1,"",o_);return t._reactRootContainer=c,t[Er]=c.current,Il(t.nodeType===8?t.parentNode:t),Ei(function(){Qd(e,c,n,r)}),c}function Jd(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=od(o);a.call(c)}}Qd(e,o,t,s)}else o=uP(n,e,t,s,r);return od(o)}cE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ba(e.pendingLanes);n!==0&&(Cp(e,n|1),Yt(e,Je()),!(Te&6)&&(Lo=Je()+500,Vs()))}break;case 13:Ei(function(){var r=Tr(t,1);if(r!==null){var s=Ut();Vn(r,t,1,s)}}),cg(t,1)}};Rp=function(t){if(t.tag===13){var e=Tr(t,134217728);if(e!==null){var n=Ut();Vn(e,t,134217728,n)}cg(t,134217728)}};uE=function(t){if(t.tag===13){var e=ys(t),n=Tr(t,e);if(n!==null){var r=Ut();Vn(n,t,e,r)}cg(t,e)}};dE=function(){return ke};hE=function(t,e){var n=ke;try{return ke=t,e()}finally{ke=n}};Yf=function(t,e,n){switch(e){case"input":if($f(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=zd(r);if(!s)throw Error(W(90));$0(r),$f(r,s)}}}break;case"textarea":q0(t,n);break;case"select":e=n.value,e!=null&&To(t,!!n.multiple,e,!1)}};J0=sg;Z0=Ei;var dP={usingClientEntryPoint:!1,Events:[tc,mo,zd,Y0,X0,sg]},ba={findFiberByHostInstance:ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hP={bundleType:ba.bundleType,version:ba.version,rendererPackageName:ba.rendererPackageName,rendererConfig:ba.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nE(t),t===null?null:t.stateNode},findFiberByHostInstance:ba.findFiberByHostInstance||cP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xc.isDisabled&&Xc.supportsFiber)try{Ld=Xc.inject(hP),Jn=Xc}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dP;un.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dg(e))throw Error(W(200));return lP(t,e,null,n)};un.createRoot=function(t,e){if(!dg(t))throw Error(W(299));var n=!1,r="",s=jT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=lg(t,1,!1,null,null,n,!1,r,s),t[Er]=e.current,Il(t.nodeType===8?t.parentNode:t),new ug(e)};un.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=nE(e),t=t===null?null:t.stateNode,t};un.flushSync=function(t){return Ei(t)};un.hydrate=function(t,e,n){if(!Xd(e))throw Error(W(200));return Jd(null,t,e,!0,n)};un.hydrateRoot=function(t,e,n){if(!dg(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=jT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=DT(e,null,t,1,n??null,s,!1,i,o),t[Er]=e.current,Il(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Yd(e)};un.render=function(t,e,n){if(!Xd(e))throw Error(W(200));return Jd(null,t,e,!1,n)};un.unmountComponentAtNode=function(t){if(!Xd(t))throw Error(W(40));return t._reactRootContainer?(Ei(function(){Jd(null,null,t,!1,function(){t._reactRootContainer=null,t[Er]=null})}),!0):!1};un.unstable_batchedUpdates=sg;un.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Xd(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Jd(t,e,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function VT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(VT)}catch(t){console.error(t)}}VT(),V0.exports=un;var fP=V0.exports,a_=fP;Of.createRoot=a_.createRoot,Of.hydrateRoot=a_.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bl(){return bl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bl.apply(this,arguments)}var cs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(cs||(cs={}));const l_="popstate";function mP(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Nm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:ad(s)}return gP(e,n,null,t)}function We(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function OT(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function pP(){return Math.random().toString(36).substr(2,8)}function c_(t,e){return{usr:t.state,key:t.key,idx:e}}function Nm(t,e,n,r){return n===void 0&&(n=null),bl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ra(e):e,{state:n,key:e&&e.key||r||pP()})}function ad(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ra(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function gP(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=cs.Pop,c=null,d=f();d==null&&(d=0,o.replaceState(bl({},o.state,{idx:d}),""));function f(){return(o.state||{idx:null}).idx}function m(){a=cs.Pop;let C=f(),I=C==null?null:C-d;d=C,c&&c({action:a,location:N.location,delta:I})}function g(C,I){a=cs.Push;let v=Nm(N.location,C,I);d=f()+1;let S=c_(v,d),D=N.createHref(v);try{o.pushState(S,"",D)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(D)}i&&c&&c({action:a,location:N.location,delta:1})}function x(C,I){a=cs.Replace;let v=Nm(N.location,C,I);d=f();let S=c_(v,d),D=N.createHref(v);o.replaceState(S,"",D),i&&c&&c({action:a,location:N.location,delta:0})}function A(C){let I=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof C=="string"?C:ad(C);return v=v.replace(/ $/,"%20"),We(I,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,I)}let N={get action(){return a},get location(){return t(s,o)},listen(C){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(l_,m),c=C,()=>{s.removeEventListener(l_,m),c=null}},createHref(C){return e(s,C)},createURL:A,encodeLocation(C){let I=A(C);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:g,replace:x,go(C){return o.go(C)}};return N}var u_;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(u_||(u_={}));function yP(t,e,n){return n===void 0&&(n="/"),vP(t,e,n)}function vP(t,e,n,r){let s=typeof e=="string"?ra(e):e,i=Fo(s.pathname||"/",n);if(i==null)return null;let o=MT(t);_P(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let d=CP(i);a=PP(o[c],d)}return a}function MT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let c={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(We(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=_s([r,c.relativePath]),f=n.concat(c);i.children&&i.children.length>0&&(We(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),MT(i.children,e,f,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:kP(d,i.index),routesMeta:f})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let c of LT(i.path))s(i,o,c)}),e}function LT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=LT(r.join("/")),a=[];return a.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function _P(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:AP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const wP=/^:[\w-]+$/,EP=3,TP=2,IP=1,SP=10,xP=-2,d_=t=>t==="*";function kP(t,e){let n=t.split("/"),r=n.length;return n.some(d_)&&(r+=xP),e&&(r+=TP),n.filter(s=>!d_(s)).reduce((s,i)=>s+(wP.test(i)?EP:i===""?IP:SP),r)}function AP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function PP(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let c=r[a],d=a===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",m=Cm({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},f),g=c.route;if(!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:_s([i,m.pathname]),pathnameBase:jP(_s([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=_s([i,m.pathnameBase]))}return o}function Cm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=NP(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,f,m)=>{let{paramName:g,isOptional:x}=f;if(g==="*"){let N=a[m]||"";o=i.slice(0,i.length-N.length).replace(/(.)\/+$/,"$1")}const A=a[m];return x&&!A?d[g]=void 0:d[g]=(A||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function NP(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),OT(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function CP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return OT(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Fo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function RP(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ra(t):t;return{pathname:n?n.startsWith("/")?n:bP(n,e):e,search:VP(r),hash:OP(s)}}function bP(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function _f(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function DP(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function hg(t,e){let n=DP(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function fg(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=ra(t):(s=bl({},t),We(!s.pathname||!s.pathname.includes("?"),_f("?","pathname","search",s)),We(!s.pathname||!s.pathname.includes("#"),_f("#","pathname","hash",s)),We(!s.search||!s.search.includes("#"),_f("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let m=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}a=m>=0?e[m]:"/"}let c=RP(s,a),d=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||f)&&(c.pathname+="/"),c}const _s=t=>t.join("/").replace(/\/\/+/g,"/"),jP=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VP=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,OP=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function MP(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const FT=["post","put","patch","delete"];new Set(FT);const LP=["get",...FT];new Set(LP);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dl(){return Dl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dl.apply(this,arguments)}const Zd=R.createContext(null),UT=R.createContext(null),Nr=R.createContext(null),eh=R.createContext(null),Cr=R.createContext({outlet:null,matches:[],isDataRoute:!1}),BT=R.createContext(null);function FP(t,e){let{relative:n}=e===void 0?{}:e;sa()||We(!1);let{basename:r,navigator:s}=R.useContext(Nr),{hash:i,pathname:o,search:a}=nh(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:_s([r,o])),s.createHref({pathname:c,search:a,hash:i})}function sa(){return R.useContext(eh)!=null}function ia(){return sa()||We(!1),R.useContext(eh).location}function zT(t){R.useContext(Nr).static||R.useLayoutEffect(t)}function th(){let{isDataRoute:t}=R.useContext(Cr);return t?eN():UP()}function UP(){sa()||We(!1);let t=R.useContext(Zd),{basename:e,future:n,navigator:r}=R.useContext(Nr),{matches:s}=R.useContext(Cr),{pathname:i}=ia(),o=JSON.stringify(hg(s,n.v7_relativeSplatPath)),a=R.useRef(!1);return zT(()=>{a.current=!0}),R.useCallback(function(d,f){if(f===void 0&&(f={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let m=fg(d,JSON.parse(o),i,f.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:_s([e,m.pathname])),(f.replace?r.replace:r.push)(m,f.state,f)},[e,r,o,i,t])}const BP=R.createContext(null);function zP(t){let e=R.useContext(Cr).outlet;return e&&R.createElement(BP.Provider,{value:t},e)}function nh(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=R.useContext(Nr),{matches:s}=R.useContext(Cr),{pathname:i}=ia(),o=JSON.stringify(hg(s,r.v7_relativeSplatPath));return R.useMemo(()=>fg(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function $P(t,e){return WP(t,e)}function WP(t,e,n,r){sa()||We(!1);let{navigator:s}=R.useContext(Nr),{matches:i}=R.useContext(Cr),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=ia(),f;if(e){var m;let C=typeof e=="string"?ra(e):e;c==="/"||(m=C.pathname)!=null&&m.startsWith(c)||We(!1),f=C}else f=d;let g=f.pathname||"/",x=g;if(c!=="/"){let C=c.replace(/^\//,"").split("/");x="/"+g.replace(/^\//,"").split("/").slice(C.length).join("/")}let A=yP(t,{pathname:x}),N=QP(A&&A.map(C=>Object.assign({},C,{params:Object.assign({},a,C.params),pathname:_s([c,s.encodeLocation?s.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:_s([c,s.encodeLocation?s.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),i,n,r);return e&&N?R.createElement(eh.Provider,{value:{location:Dl({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:cs.Pop}},N):N}function qP(){let t=ZP(),e=MP(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),n?R.createElement("pre",{style:s},n):null,null)}const GP=R.createElement(qP,null);class HP extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?R.createElement(Cr.Provider,{value:this.props.routeContext},R.createElement(BT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function KP(t){let{routeContext:e,match:n,children:r}=t,s=R.useContext(Zd);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),R.createElement(Cr.Provider,{value:e},r)}function QP(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let f=o.findIndex(m=>m.route.id&&(a==null?void 0:a[m.route.id])!==void 0);f>=0||We(!1),o=o.slice(0,Math.min(o.length,f+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<o.length;f++){let m=o[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=f),m.route.id){let{loaderData:g,errors:x}=n,A=m.route.loader&&g[m.route.id]===void 0&&(!x||x[m.route.id]===void 0);if(m.route.lazy||A){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((f,m,g)=>{let x,A=!1,N=null,C=null;n&&(x=a&&m.route.id?a[m.route.id]:void 0,N=m.route.errorElement||GP,c&&(d<0&&g===0?(tN("route-fallback"),A=!0,C=null):d===g&&(A=!0,C=m.route.hydrateFallbackElement||null)));let I=e.concat(o.slice(0,g+1)),v=()=>{let S;return x?S=N:A?S=C:m.route.Component?S=R.createElement(m.route.Component,null):m.route.element?S=m.route.element:S=f,R.createElement(KP,{match:m,routeContext:{outlet:f,matches:I,isDataRoute:n!=null},children:S})};return n&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?R.createElement(HP,{location:n.location,revalidation:n.revalidation,component:N,error:x,children:v(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):v()},null)}var $T=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}($T||{}),WT=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(WT||{});function YP(t){let e=R.useContext(Zd);return e||We(!1),e}function XP(t){let e=R.useContext(UT);return e||We(!1),e}function JP(t){let e=R.useContext(Cr);return e||We(!1),e}function qT(t){let e=JP(),n=e.matches[e.matches.length-1];return n.route.id||We(!1),n.route.id}function ZP(){var t;let e=R.useContext(BT),n=XP(),r=qT();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function eN(){let{router:t}=YP($T.UseNavigateStable),e=qT(WT.UseNavigateStable),n=R.useRef(!1);return zT(()=>{n.current=!0}),R.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Dl({fromRouteId:e},i)))},[t,e])}const h_={};function tN(t,e,n){h_[t]||(h_[t]=!0)}function nN(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function ld(t){let{to:e,replace:n,state:r,relative:s}=t;sa()||We(!1);let{future:i,static:o}=R.useContext(Nr),{matches:a}=R.useContext(Cr),{pathname:c}=ia(),d=th(),f=fg(e,hg(a,i.v7_relativeSplatPath),c,s==="path"),m=JSON.stringify(f);return R.useEffect(()=>d(JSON.parse(m),{replace:n,state:r,relative:s}),[d,m,s,n,r]),null}function rN(t){return zP(t.context)}function mn(t){We(!1)}function sN(t){let{basename:e="/",children:n=null,location:r,navigationType:s=cs.Pop,navigator:i,static:o=!1,future:a}=t;sa()&&We(!1);let c=e.replace(/^\/*/,"/"),d=R.useMemo(()=>({basename:c,navigator:i,static:o,future:Dl({v7_relativeSplatPath:!1},a)}),[c,a,i,o]);typeof r=="string"&&(r=ra(r));let{pathname:f="/",search:m="",hash:g="",state:x=null,key:A="default"}=r,N=R.useMemo(()=>{let C=Fo(f,c);return C==null?null:{location:{pathname:C,search:m,hash:g,state:x,key:A},navigationType:s}},[c,f,m,g,x,A,s]);return N==null?null:R.createElement(Nr.Provider,{value:d},R.createElement(eh.Provider,{children:n,value:N}))}function iN(t){let{children:e,location:n}=t;return $P(Rm(e),n)}new Promise(()=>{});function Rm(t,e){e===void 0&&(e=[]);let n=[];return R.Children.forEach(t,(r,s)=>{if(!R.isValidElement(r))return;let i=[...e,s];if(r.type===R.Fragment){n.push.apply(n,Rm(r.props.children,i));return}r.type!==mn&&We(!1),!r.props.index||!r.props.children||We(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Rm(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cd(){return cd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cd.apply(this,arguments)}function GT(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function oN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function aN(t,e){return t.button===0&&(!e||e==="_self")&&!oN(t)}const lN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],cN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],uN="6";try{window.__reactRouterVersion=uN}catch{}const dN=R.createContext({isTransitioning:!1}),hN="startTransition",f_=nk[hN];function fN(t){let{basename:e,children:n,future:r,window:s}=t,i=R.useRef();i.current==null&&(i.current=mP({window:s,v5Compat:!0}));let o=i.current,[a,c]=R.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},f=R.useCallback(m=>{d&&f_?f_(()=>c(m)):c(m)},[c,d]);return R.useLayoutEffect(()=>o.listen(f),[o,f]),R.useEffect(()=>nN(r),[r]),R.createElement(sN,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const mN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",pN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gN=R.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:c,to:d,preventScrollReset:f,viewTransition:m}=e,g=GT(e,lN),{basename:x}=R.useContext(Nr),A,N=!1;if(typeof d=="string"&&pN.test(d)&&(A=d,mN))try{let S=new URL(window.location.href),D=d.startsWith("//")?new URL(S.protocol+d):new URL(d),L=Fo(D.pathname,x);D.origin===S.origin&&L!=null?d=L+D.search+D.hash:N=!0}catch{}let C=FP(d,{relative:s}),I=vN(d,{replace:o,state:a,target:c,preventScrollReset:f,relative:s,viewTransition:m});function v(S){r&&r(S),S.defaultPrevented||I(S)}return R.createElement("a",cd({},g,{href:A||C,onClick:N||i?r:v,ref:n,target:c}))}),Yi=R.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:a,to:c,viewTransition:d,children:f}=e,m=GT(e,cN),g=nh(c,{relative:m.relative}),x=ia(),A=R.useContext(UT),{navigator:N,basename:C}=R.useContext(Nr),I=A!=null&&_N(g)&&d===!0,v=N.encodeLocation?N.encodeLocation(g).pathname:g.pathname,S=x.pathname,D=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;s||(S=S.toLowerCase(),D=D?D.toLowerCase():null,v=v.toLowerCase()),D&&C&&(D=Fo(D,C)||D);const L=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let V=S===v||!o&&S.startsWith(v)&&S.charAt(L)==="/",_=D!=null&&(D===v||!o&&D.startsWith(v)&&D.charAt(v.length)==="/"),y={isActive:V,isPending:_,isTransitioning:I},E=V?r:void 0,T;typeof i=="function"?T=i(y):T=[i,V?"active":null,_?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let P=typeof a=="function"?a(y):a;return R.createElement(gN,cd({},m,{"aria-current":E,className:T,ref:n,style:P,to:c,viewTransition:d}),typeof f=="function"?f(y):f)});var bm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(bm||(bm={}));var m_;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(m_||(m_={}));function yN(t){let e=R.useContext(Zd);return e||We(!1),e}function vN(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,c=th(),d=ia(),f=nh(t,{relative:o});return R.useCallback(m=>{if(aN(m,n)){m.preventDefault();let g=r!==void 0?r:ad(d)===ad(f);c(t,{replace:g,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[d,c,f,r,s,n,t,i,o,a])}function _N(t,e){e===void 0&&(e={});let n=R.useContext(dN);n==null&&We(!1);let{basename:r}=yN(bm.useViewTransitionState),s=nh(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Fo(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Fo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Cm(s.pathname,o)!=null||Cm(s.pathname,i)!=null}const wN=()=>{};var p_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},EN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},KT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,f=i>>2,m=(i&3)<<4|a>>4;let g=(a&15)<<2|d>>6,x=d&63;c||(x=64,o||(g=64)),r.push(n[f],n[m],n[g],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(HT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):EN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||m==null)throw new TN;const g=i<<2|a>>4;if(r.push(g),d!==64){const x=a<<4&240|d>>2;if(r.push(x),m!==64){const A=d<<6&192|m;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class TN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const IN=function(t){const e=HT(t);return KT.encodeByteArray(e,!0)},ud=function(t){return IN(t).replace(/\./g,"")},QT=function(t){try{return KT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN=()=>YT().__FIREBASE_DEFAULTS__,xN=()=>{if(typeof process>"u"||typeof p_>"u")return;const t=p_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},kN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&QT(t[1]);return e&&JSON.parse(e)},rh=()=>{try{return wN()||SN()||xN()||kN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},XT=t=>{var e,n;return(n=(e=rh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},JT=t=>{const e=XT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},ZT=()=>{var t;return(t=rh())===null||t===void 0?void 0:t.config},eI=t=>{var e;return(e=rh())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(t){return t.endsWith(".cloudworkstations.dev")}async function mg(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ud(JSON.stringify(n)),ud(JSON.stringify(o)),""].join(".")}const il={};function NN(){const t={prod:[],emulator:[]};for(const e of Object.keys(il))il[e]?t.emulator.push(e):t.prod.push(e);return t}function CN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let g_=!1;function pg(t,e){if(typeof window>"u"||typeof document>"u"||!Oi(window.location.host)||il[t]===e||il[t]||g_)return;il[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=NN().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,x){g.setAttribute("width","24"),g.setAttribute("id",x),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{g_=!0,o()},g}function f(g,x){g.setAttribute("id",x),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=CN(r),x=n("text"),A=document.getElementById(x)||document.createElement("span"),N=n("learnmore"),C=document.getElementById(N)||document.createElement("a"),I=n("preprendIcon"),v=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const S=g.element;a(S),f(C,N);const D=d();c(v,I),S.append(v,A,C,D),document.body.appendChild(S)}i?(A.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lt())}function tI(){var t;const e=(t=rh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function jN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function VN(){const t=lt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function nI(){return!tI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rI(){return!tI()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function sI(){try{return typeof indexedDB=="object"}catch{return!1}}function ON(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN="FirebaseError";class Rr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=MN,Object.setPrototypeOf(this,Rr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rc.prototype.create)}}class rc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?LN(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Rr(s,a,r)}}function LN(t,e){return t.replace(FN,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const FN=/\{\$([^}]+)}/g;function UN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ti(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(y_(i)&&y_(o)){if(!Ti(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function y_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function $a(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Wa(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function BN(t,e){const n=new zN(t,e);return n.subscribe.bind(n)}class zN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");$N(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=wf),s.error===void 0&&(s.error=wf),s.complete===void 0&&(s.complete=wf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $N(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function wf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(t){return t&&t._delegate?t._delegate:t}class Ps{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new AN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(GN(e))try{this.getOrInitializeService({instanceIdentifier:Js})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Js){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Js){return this.instances.has(e)}getOptions(e=Js){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:qN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Js){return this.component?this.component.multipleInstances?e:Js:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qN(t){return t===Js?void 0:t}function GN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new WN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pe||(pe={}));const KN={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},QN=pe.INFO,YN={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},XN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=YN[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gg{constructor(e){this.name=e,this._logLevel=QN,this._logHandler=XN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?KN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}}const JN=(t,e)=>e.some(n=>t instanceof n);let v_,__;function ZN(){return v_||(v_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eC(){return __||(__=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iI=new WeakMap,Dm=new WeakMap,oI=new WeakMap,Ef=new WeakMap,yg=new WeakMap;function tC(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ws(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&iI.set(n,t)}).catch(()=>{}),yg.set(e,t),e}function nC(t){if(Dm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Dm.set(t,e)}let jm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Dm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||oI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ws(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function rC(t){jm=t(jm)}function sC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Tf(this),e,...n);return oI.set(r,e.sort?e.sort():[e]),ws(r)}:eC().includes(t)?function(...e){return t.apply(Tf(this),e),ws(iI.get(this))}:function(...e){return ws(t.apply(Tf(this),e))}}function iC(t){return typeof t=="function"?sC(t):(t instanceof IDBTransaction&&nC(t),JN(t,ZN())?new Proxy(t,jm):t)}function ws(t){if(t instanceof IDBRequest)return tC(t);if(Ef.has(t))return Ef.get(t);const e=iC(t);return e!==t&&(Ef.set(t,e),yg.set(e,t)),e}const Tf=t=>yg.get(t);function oC(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=ws(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ws(o.result),c.oldVersion,c.newVersion,ws(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const aC=["get","getKey","getAll","getAllKeys","count"],lC=["put","add","delete","clear"],If=new Map;function w_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(If.get(e))return If.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=lC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||aC.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&c.done]))[0]};return If.set(e,i),i}rC(t=>({...t,get:(e,n,r)=>w_(e,n)||t.get(e,n,r),has:(e,n)=>!!w_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function uC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Vm="@firebase/app",E_="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr=new gg("@firebase/app"),dC="@firebase/app-compat",hC="@firebase/analytics-compat",fC="@firebase/analytics",mC="@firebase/app-check-compat",pC="@firebase/app-check",gC="@firebase/auth",yC="@firebase/auth-compat",vC="@firebase/database",_C="@firebase/data-connect",wC="@firebase/database-compat",EC="@firebase/functions",TC="@firebase/functions-compat",IC="@firebase/installations",SC="@firebase/installations-compat",xC="@firebase/messaging",kC="@firebase/messaging-compat",AC="@firebase/performance",PC="@firebase/performance-compat",NC="@firebase/remote-config",CC="@firebase/remote-config-compat",RC="@firebase/storage",bC="@firebase/storage-compat",DC="@firebase/firestore",jC="@firebase/ai",VC="@firebase/firestore-compat",OC="firebase",MC="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om="[DEFAULT]",LC={[Vm]:"fire-core",[dC]:"fire-core-compat",[fC]:"fire-analytics",[hC]:"fire-analytics-compat",[pC]:"fire-app-check",[mC]:"fire-app-check-compat",[gC]:"fire-auth",[yC]:"fire-auth-compat",[vC]:"fire-rtdb",[_C]:"fire-data-connect",[wC]:"fire-rtdb-compat",[EC]:"fire-fn",[TC]:"fire-fn-compat",[IC]:"fire-iid",[SC]:"fire-iid-compat",[xC]:"fire-fcm",[kC]:"fire-fcm-compat",[AC]:"fire-perf",[PC]:"fire-perf-compat",[NC]:"fire-rc",[CC]:"fire-rc-compat",[RC]:"fire-gcs",[bC]:"fire-gcs-compat",[DC]:"fire-fst",[VC]:"fire-fst-compat",[jC]:"fire-vertex","fire-js":"fire-js",[OC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd=new Map,FC=new Map,Mm=new Map;function T_(t,e){try{t.container.addComponent(e)}catch(n){Sr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ii(t){const e=t.name;if(Mm.has(e))return Sr.debug(`There were multiple attempts to register component ${e}.`),!1;Mm.set(e,t);for(const n of dd.values())T_(n,t);for(const n of FC.values())T_(n,t);return!0}function sh(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function nn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Es=new rc("app","Firebase",UC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ps("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Es.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oa=MC;function aI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Om,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Es.create("bad-app-name",{appName:String(s)});if(n||(n=ZT()),!n)throw Es.create("no-options");const i=dd.get(s);if(i){if(Ti(n,i.options)&&Ti(r,i.config))return i;throw Es.create("duplicate-app",{appName:s})}const o=new HN(s);for(const c of Mm.values())o.addComponent(c);const a=new BC(n,r,o);return dd.set(s,a),a}function vg(t=Om){const e=dd.get(t);if(!e&&t===Om&&ZT())return aI();if(!e)throw Es.create("no-app",{appName:t});return e}function er(t,e,n){var r;let s=(r=LC[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Sr.warn(a.join(" "));return}Ii(new Ps(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zC="firebase-heartbeat-database",$C=1,jl="firebase-heartbeat-store";let Sf=null;function lI(){return Sf||(Sf=oC(zC,$C,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jl)}catch(n){console.warn(n)}}}}).catch(t=>{throw Es.create("idb-open",{originalErrorMessage:t.message})})),Sf}async function WC(t){try{const n=(await lI()).transaction(jl),r=await n.objectStore(jl).get(cI(t));return await n.done,r}catch(e){if(e instanceof Rr)Sr.warn(e.message);else{const n=Es.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Sr.warn(n.message)}}}async function I_(t,e){try{const r=(await lI()).transaction(jl,"readwrite");await r.objectStore(jl).put(e,cI(t)),await r.done}catch(n){if(n instanceof Rr)Sr.warn(n.message);else{const r=Es.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Sr.warn(r.message)}}}function cI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC=1024,GC=30;class HC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new QC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=S_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>GC){const o=YC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Sr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=S_(),{heartbeatsToSend:r,unsentEntries:s}=KC(this._heartbeatsCache.heartbeats),i=ud(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Sr.warn(n),""}}}function S_(){return new Date().toISOString().substring(0,10)}function KC(t,e=qC){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),x_(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),x_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class QC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sI()?ON().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await WC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return I_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return I_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function x_(t){return ud(JSON.stringify({version:2,heartbeats:t})).length}function YC(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XC(t){Ii(new Ps("platform-logger",e=>new cC(e),"PRIVATE")),Ii(new Ps("heartbeat",e=>new HC(e),"PRIVATE")),er(Vm,E_,t),er(Vm,E_,"esm2017"),er("fire-js","")}XC("");function _g(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function uI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const JC=uI,dI=new rc("auth","Firebase",uI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd=new gg("@firebase/auth");function ZC(t,...e){hd.logLevel<=pe.WARN&&hd.warn(`Auth (${oa}): ${t}`,...e)}function Eu(t,...e){hd.logLevel<=pe.ERROR&&hd.error(`Auth (${oa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(t,...e){throw wg(t,...e)}function tr(t,...e){return wg(t,...e)}function hI(t,e,n){const r=Object.assign(Object.assign({},JC()),{[e]:n});return new rc("auth","Firebase",r).create(e,{appName:t.name})}function _r(t){return hI(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wg(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return dI.create(t,...e)}function se(t,e,...n){if(!t)throw wg(e,...n)}function mr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Eu(e),new Error(e)}function xr(t,e){t||mr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function eR(){return k_()==="http:"||k_()==="https:"}function k_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(eR()||DN()||"connection"in navigator)?navigator.onLine:!0}function nR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n){this.shortDelay=e,this.longDelay=n,xr(n>e,"Short delay should be less than long delay!"),this.isMobile=RN()||jN()}get(){return tR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eg(t,e){xr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;mr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;mr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;mr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],iR=new ic(3e4,6e4);function Os(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ms(t,e,n,r,s={}){return mI(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=sc(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},i);return bN()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Oi(t.emulatorConfig.host)&&(d.credentials="include"),fI.fetch()(await pI(t,t.config.apiHost,n,a),d)})}async function mI(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},rR),e);try{const s=new aR(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Jc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Jc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Jc(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw hI(t,f,d);Mn(t,f)}}catch(s){if(s instanceof Rr)throw s;Mn(t,"network-request-failed",{message:String(s)})}}async function oc(t,e,n,r,s={}){const i=await Ms(t,e,n,r,s);return"mfaPendingCredential"in i&&Mn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function pI(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Eg(t.config,s):`${t.config.apiScheme}://${s}`;return sR.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function oR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class aR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(tr(this.auth,"network-request-failed")),iR.get())})}}function Jc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=tr(t,e,r);return s.customData._tokenResponse=n,s}function A_(t){return t!==void 0&&t.enterprise!==void 0}class lR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return oR(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function cR(t,e){return Ms(t,"GET","/v2/recaptchaConfig",Os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uR(t,e){return Ms(t,"POST","/v1/accounts:delete",e)}async function fd(t,e){return Ms(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function dR(t,e=!1){const n=rt(t),r=await n.getIdToken(e),s=Tg(r);se(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ol(xf(s.auth_time)),issuedAtTime:ol(xf(s.iat)),expirationTime:ol(xf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function xf(t){return Number(t)*1e3}function Tg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Eu("JWT malformed, contained fewer than 3 sections"),null;try{const s=QT(n);return s?JSON.parse(s):(Eu("Failed to decode base64 JWT payload"),null)}catch(s){return Eu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function P_(t){const e=Tg(t);return se(e,"internal-error"),se(typeof e.exp<"u","internal-error"),se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Rr&&hR(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function hR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ol(this.lastLoginAt),this.creationTime=ol(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function md(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Vl(t,fd(n,{idToken:r}));se(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?gI(i.providerUserInfo):[],a=pR(t.providerData,o),c=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),f=c?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Fm(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,m)}async function mR(t){const e=rt(t);await md(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function pR(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function gI(t){return t.map(e=>{var{providerId:n}=e,r=_g(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gR(t,e){const n=await mI(t,{},async()=>{const r=sc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await pI(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&Oi(t.emulatorConfig.host)&&(c.credentials="include"),fI.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function yR(t,e){return Ms(t,"POST","/v2/accounts:revokeToken",Os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){se(e.idToken,"internal-error"),se(typeof e.idToken<"u","internal-error"),se(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):P_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){se(e.length!==0,"internal-error");const n=P_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await gR(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Po;return r&&(se(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(se(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(se(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Po,this.toJSON())}_performRefresh(){return mr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(t,e){se(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Dn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=_g(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new fR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Fm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Vl(this,this.stsTokenManager.getToken(this.auth,e));return se(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return dR(this,e)}reload(){return mR(this)}_assign(e){this!==e&&(se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Dn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await md(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nn(this.auth.app))return Promise.reject(_r(this.auth));const e=await this.getIdToken();return await Vl(this,uR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,c,d,f;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(s=n.email)!==null&&s!==void 0?s:void 0,x=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,A=(o=n.photoURL)!==null&&o!==void 0?o:void 0,N=(a=n.tenantId)!==null&&a!==void 0?a:void 0,C=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,I=(d=n.createdAt)!==null&&d!==void 0?d:void 0,v=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:S,emailVerified:D,isAnonymous:L,providerData:V,stsTokenManager:_}=n;se(S&&_,e,"internal-error");const y=Po.fromJSON(this.name,_);se(typeof S=="string",e,"internal-error"),Hr(m,e.name),Hr(g,e.name),se(typeof D=="boolean",e,"internal-error"),se(typeof L=="boolean",e,"internal-error"),Hr(x,e.name),Hr(A,e.name),Hr(N,e.name),Hr(C,e.name),Hr(I,e.name),Hr(v,e.name);const E=new Dn({uid:S,auth:e,email:g,emailVerified:D,displayName:m,isAnonymous:L,photoURL:A,phoneNumber:x,tenantId:N,stsTokenManager:y,createdAt:I,lastLoginAt:v});return V&&Array.isArray(V)&&(E.providerData=V.map(T=>Object.assign({},T))),C&&(E._redirectEventId=C),E}static async _fromIdTokenResponse(e,n,r=!1){const s=new Po;s.updateFromServerResponse(n);const i=new Dn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await md(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];se(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?gI(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Po;a.updateFromIdToken(r);const c=new Dn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Fm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N_=new Map;function pr(t){xr(t instanceof Function,"Expected a class definition");let e=N_.get(t);return e?(xr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,N_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}yI.type="NONE";const C_=yI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(t,e,n){return`firebase:${t}:${e}:${n}`}class No{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Tu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Tu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await fd(this.auth,{idToken:e}).catch(()=>{});return n?Dn._fromGetAccountInfoResponse(this.auth,n,e):null}return Dn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new No(pr(C_),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||pr(C_);const o=Tu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const f=await d._get(o);if(f){let m;if(typeof f=="string"){const g=await fd(e,{idToken:f}).catch(()=>{});if(!g)break;m=await Dn._fromGetAccountInfoResponse(e,g,f)}else m=Dn._fromJSON(e,f);d!==i&&(a=m),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new No(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new No(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(EI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(II(e))return"Blackberry";if(SI(e))return"Webos";if(_I(e))return"Safari";if((e.includes("chrome/")||wI(e))&&!e.includes("edge/"))return"Chrome";if(TI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function vI(t=lt()){return/firefox\//i.test(t)}function _I(t=lt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wI(t=lt()){return/crios\//i.test(t)}function EI(t=lt()){return/iemobile/i.test(t)}function TI(t=lt()){return/android/i.test(t)}function II(t=lt()){return/blackberry/i.test(t)}function SI(t=lt()){return/webos/i.test(t)}function Ig(t=lt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function vR(t=lt()){var e;return Ig(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _R(){return VN()&&document.documentMode===10}function xI(t=lt()){return Ig(t)||TI(t)||SI(t)||II(t)||/windows phone/i.test(t)||EI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(t,e=[]){let n;switch(t){case"Browser":n=R_(lt());break;case"Worker":n=`${R_(lt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${oa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ER(t,e={}){return Ms(t,"GET","/v2/passwordPolicy",Os(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR=6;class IR{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:TR,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new b_(this),this.idTokenSubscription=new b_(this),this.beforeStateQueue=new wR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=pr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await No.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await fd(this,{idToken:e}),r=await Dn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(nn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await md(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nn(this.app))return Promise.reject(_r(this));const n=e?rt(e):null;return n&&se(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nn(this.app)?Promise.reject(_r(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nn(this.app)?Promise.reject(_r(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ER(this),n=new IR(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new rc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await yR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&pr(e)||this._popupRedirectResolver;se(n,this,"argument-error"),this.redirectPersistenceManager=await No.create(this,[pr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(se(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&ZC(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Mi(t){return rt(t)}class b_{constructor(e){this.auth=e,this.observer=null,this.addObserver=BN(n=>this.observer=n)}get next(){return se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ih={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xR(t){ih=t}function AI(t){return ih.loadJS(t)}function kR(){return ih.recaptchaEnterpriseScript}function AR(){return ih.gapiScript}function PR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class NR{constructor(){this.enterprise=new CR}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class CR{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const RR="recaptcha-enterprise",PI="NO_RECAPTCHA";class bR{constructor(e){this.type=RR,this.auth=Mi(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{cR(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new lR(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;A_(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(PI)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new NR().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&A_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=kR();c.length!==0&&(c+=a),AI(c).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function D_(t,e,n,r=!1,s=!1){const i=new bR(t);let o;if(s)o=PI;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Um(t,e,n,r,s){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await D_(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await D_(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DR(t,e){const n=sh(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Ti(i,e??{}))return s;Mn(s,"already-initialized")}return n.initialize({options:e})}function jR(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(pr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function VR(t,e,n){const r=Mi(t);se(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=NI(e),{host:o,port:a}=OR(e),c=a===null?"":`:${a}`,d={url:`${i}//${o}${c}/`},f=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){se(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),se(Ti(d,r.config.emulator)&&Ti(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Oi(o)?(mg(`${i}//${o}${c}`),pg("Auth",!0)):MR()}function NI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function OR(t){const e=NI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:j_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:j_(o)}}}function j_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function MR(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return mr("not implemented")}_getIdTokenResponse(e){return mr("not implemented")}_linkToIdToken(e,n){return mr("not implemented")}_getReauthenticationResolver(e){return mr("not implemented")}}async function LR(t,e){return Ms(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FR(t,e){return oc(t,"POST","/v1/accounts:signInWithPassword",Os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UR(t,e){return oc(t,"POST","/v1/accounts:signInWithEmailLink",Os(t,e))}async function BR(t,e){return oc(t,"POST","/v1/accounts:signInWithEmailLink",Os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol extends Sg{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Ol(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ol(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Um(e,n,"signInWithPassword",FR);case"emailLink":return UR(e,{email:this._email,oobCode:this._password});default:Mn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Um(e,r,"signUpPassword",LR);case"emailLink":return BR(e,{idToken:n,email:this._email,oobCode:this._password});default:Mn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Co(t,e){return oc(t,"POST","/v1/accounts:signInWithIdp",Os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR="http://localhost";class Si extends Sg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Si(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Mn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=_g(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Si(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Co(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Co(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Co(e,n)}buildRequest(){const e={requestUri:zR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=sc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $R(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function WR(t){const e=$a(Wa(t)).link,n=e?$a(Wa(e)).deep_link_id:null,r=$a(Wa(t)).deep_link_id;return(r?$a(Wa(r)).link:null)||r||n||e||t}class xg{constructor(e){var n,r,s,i,o,a;const c=$a(Wa(e)),d=(n=c.apiKey)!==null&&n!==void 0?n:null,f=(r=c.oobCode)!==null&&r!==void 0?r:null,m=$R((s=c.mode)!==null&&s!==void 0?s:null);se(d&&f&&m,"argument-error"),this.apiKey=d,this.operation=m,this.code=f,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=WR(e);try{return new xg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(){this.providerId=aa.PROVIDER_ID}static credential(e,n){return Ol._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=xg.parseLink(n);return se(r,"argument-error"),Ol._fromEmailAndCode(e,r.code,r.tenantId)}}aa.PROVIDER_ID="password";aa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";aa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac extends CI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends ac{constructor(){super("facebook.com")}static credential(e){return Si._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ns.credential(e.oauthAccessToken)}catch{return null}}}ns.FACEBOOK_SIGN_IN_METHOD="facebook.com";ns.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends ac{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Si._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return rs.credential(n,r)}catch{return null}}}rs.GOOGLE_SIGN_IN_METHOD="google.com";rs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends ac{constructor(){super("github.com")}static credential(e){return Si._fromParams({providerId:ss.PROVIDER_ID,signInMethod:ss.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ss.credentialFromTaggedObject(e)}static credentialFromError(e){return ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ss.credential(e.oauthAccessToken)}catch{return null}}}ss.GITHUB_SIGN_IN_METHOD="github.com";ss.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is extends ac{constructor(){super("twitter.com")}static credential(e,n){return Si._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return is.credentialFromTaggedObject(e)}static credentialFromError(e){return is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return is.credential(n,r)}catch{return null}}}is.TWITTER_SIGN_IN_METHOD="twitter.com";is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qR(t,e){return oc(t,"POST","/v1/accounts:signUp",Os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Dn._fromIdTokenResponse(e,r,s),o=V_(r);return new xi({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=V_(r);return new xi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function V_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd extends Rr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,pd.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new pd(e,n,r,s)}}function RI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?pd._fromErrorAndOperation(t,i,e,r):i})}async function GR(t,e,n=!1){const r=await Vl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return xi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HR(t,e,n=!1){const{auth:r}=t;if(nn(r.app))return Promise.reject(_r(r));const s="reauthenticate";try{const i=await Vl(t,RI(r,s,e,t),n);se(i.idToken,r,"internal-error");const o=Tg(i.idToken);se(o,r,"internal-error");const{sub:a}=o;return se(t.uid===a,r,"user-mismatch"),xi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Mn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bI(t,e,n=!1){if(nn(t.app))return Promise.reject(_r(t));const r="signIn",s=await RI(t,r,e),i=await xi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function KR(t,e){return bI(Mi(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DI(t){const e=Mi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function jI(t,e,n){if(nn(t.app))return Promise.reject(_r(t));const r=Mi(t),o=await Um(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",qR).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&DI(t),c}),a=await xi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function VI(t,e,n){return nn(t.app)?Promise.reject(_r(t)):KR(rt(t),aa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&DI(t),r})}function QR(t,e,n,r){return rt(t).onIdTokenChanged(e,n,r)}function YR(t,e,n){return rt(t).beforeAuthStateChanged(e,n)}function XR(t,e,n,r){return rt(t).onAuthStateChanged(e,n,r)}function OI(t){return rt(t).signOut()}const gd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(gd,"1"),this.storage.removeItem(gd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR=1e3,ZR=10;class LI extends MI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);_R()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,ZR):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},JR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}LI.type="LOCAL";const eb=LI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI extends MI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}FI.type="SESSION";const UI=FI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tb(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new oh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),c=await tb(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}oh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const d=kg("",20);s.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(f),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(){return window}function rb(t){nr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BI(){return typeof nr().WorkerGlobalScope<"u"&&typeof nr().importScripts=="function"}async function sb(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ib(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function ob(){return BI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI="firebaseLocalStorageDb",ab=1,yd="firebaseLocalStorage",$I="fbase_key";class lc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function ah(t,e){return t.transaction([yd],e?"readwrite":"readonly").objectStore(yd)}function lb(){const t=indexedDB.deleteDatabase(zI);return new lc(t).toPromise()}function Bm(){const t=indexedDB.open(zI,ab);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(yd,{keyPath:$I})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(yd)?e(r):(r.close(),await lb(),e(await Bm()))})})}async function O_(t,e,n){const r=ah(t,!0).put({[$I]:e,value:n});return new lc(r).toPromise()}async function cb(t,e){const n=ah(t,!1).get(e),r=await new lc(n).toPromise();return r===void 0?null:r.value}function M_(t,e){const n=ah(t,!0).delete(e);return new lc(n).toPromise()}const ub=800,db=3;class WI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>db)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return BI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=oh._getInstance(ob()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await sb(),!this.activeServiceWorker)return;this.sender=new nb(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ib()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bm();return await O_(e,gd,"1"),await M_(e,gd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>O_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>cb(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>M_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=ah(s,!1).getAll();return new lc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ub)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}WI.type="LOCAL";const hb=WI;new ic(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(t,e){return e?pr(e):(se(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag extends Sg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Co(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Co(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Co(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function mb(t){return bI(t.auth,new Ag(t),t.bypassAuthState)}function pb(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),HR(n,new Ag(t),t.bypassAuthState)}async function gb(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),GR(n,new Ag(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mb;case"linkViaPopup":case"linkViaRedirect":return gb;case"reauthViaPopup":case"reauthViaRedirect":return pb;default:Mn(this.auth,"internal-error")}}resolve(e){xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb=new ic(2e3,1e4);class Eo extends qI{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Eo.currentPopupAction&&Eo.currentPopupAction.cancel(),Eo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return se(e,this.auth,"internal-error"),e}async onExecution(){xr(this.filter.length===1,"Popup operations only handle one event");const e=kg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Eo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,yb.get())};e()}}Eo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb="pendingRedirect",Iu=new Map;class _b extends qI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Iu.get(this.auth._key());if(!e){try{const r=await wb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Iu.set(this.auth._key(),e)}return this.bypassAuthState||Iu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wb(t,e){const n=Ib(e),r=Tb(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Eb(t,e){Iu.set(t._key(),e)}function Tb(t){return pr(t._redirectPersistence)}function Ib(t){return Tu(vb,t.config.apiKey,t.name)}async function Sb(t,e,n=!1){if(nn(t.app))return Promise.reject(_r(t));const r=Mi(t),s=fb(r,e),o=await new _b(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb=10*60*1e3;class kb{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ab(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!GI(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(tr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xb&&this.cachedEventUids.clear(),this.cachedEventUids.has(L_(e))}saveEventToCache(e){this.cachedEventUids.add(L_(e)),this.lastProcessedEventTime=Date.now()}}function L_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function GI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Ab(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return GI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pb(t,e={}){return Ms(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Cb=/^https?/;async function Rb(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Pb(t);for(const n of e)try{if(bb(n))return}catch{}Mn(t,"unauthorized-domain")}function bb(t){const e=Lm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Cb.test(n))return!1;if(Nb.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db=new ic(3e4,6e4);function F_(){const t=nr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function jb(t){return new Promise((e,n)=>{var r,s,i;function o(){F_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{F_(),n(tr(t,"network-request-failed"))},timeout:Db.get()})}if(!((s=(r=nr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=nr().gapi)===null||i===void 0)&&i.load)o();else{const a=PR("iframefcb");return nr()[a]=()=>{gapi.load?o():n(tr(t,"network-request-failed"))},AI(`${AR()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Su=null,e})}let Su=null;function Vb(t){return Su=Su||jb(t),Su}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ob=new ic(5e3,15e3),Mb="__/auth/iframe",Lb="emulator/auth/iframe",Fb={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ub=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Bb(t){const e=t.config;se(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Eg(e,Lb):`https://${t.config.authDomain}/${Mb}`,r={apiKey:e.apiKey,appName:t.name,v:oa},s=Ub.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${sc(r).slice(1)}`}async function zb(t){const e=await Vb(t),n=nr().gapi;return se(n,t,"internal-error"),e.open({where:document.body,url:Bb(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Fb,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=tr(t,"network-request-failed"),a=nr().setTimeout(()=>{i(o)},Ob.get());function c(){nr().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Wb=500,qb=600,Gb="_blank",Hb="http://localhost";class U_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Kb(t,e,n,r=Wb,s=qb){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},$b),{width:r.toString(),height:s.toString(),top:i,left:o}),d=lt().toLowerCase();n&&(a=wI(d)?Gb:n),vI(d)&&(e=e||Hb,c.scrollbars="yes");const f=Object.entries(c).reduce((g,[x,A])=>`${g}${x}=${A},`,"");if(vR(d)&&a!=="_self")return Qb(e||"",a),new U_(null);const m=window.open(e||"",a,f);se(m,t,"popup-blocked");try{m.focus()}catch{}return new U_(m)}function Qb(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb="__/auth/handler",Xb="emulator/auth/handler",Jb=encodeURIComponent("fac");async function B_(t,e,n,r,s,i){se(t.config.authDomain,t,"auth-domain-config-required"),se(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:oa,eventId:s};if(e instanceof CI){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",UN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof ac){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const c=await t._getAppCheckToken(),d=c?`#${Jb}=${encodeURIComponent(c)}`:"";return`${Zb(t)}?${sc(a).slice(1)}${d}`}function Zb({config:t}){return t.emulator?Eg(t,Xb):`https://${t.authDomain}/${Yb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf="webStorageSupport";class eD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=UI,this._completeRedirectFn=Sb,this._overrideRedirectResult=Eb}async _openPopup(e,n,r,s){var i;xr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await B_(e,n,r,Lm(),s);return Kb(e,o,kg())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await B_(e,n,r,Lm(),s);return rb(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(xr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await zb(e),r=new kb(e);return n.register("authEvent",s=>(se(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(kf,{type:kf},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[kf];o!==void 0&&n(!!o),Mn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Rb(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return xI()||_I()||Ig()}}const tD=eD;var z_="@firebase/auth",$_="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function sD(t){Ii(new Ps("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;se(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kI(t)},d=new SR(r,s,i,c);return jR(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ii(new Ps("auth-internal",e=>{const n=Mi(e.getProvider("auth").getImmediate());return(r=>new nD(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),er(z_,$_,rD(t)),er(z_,$_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD=5*60,oD=eI("authIdTokenMaxAge")||iD;let W_=null;const aD=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>oD)return;const s=n==null?void 0:n.token;W_!==s&&(W_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function HI(t=vg()){const e=sh(t,"auth");if(e.isInitialized())return e.getImmediate();const n=DR(t,{popupRedirectResolver:tD,persistence:[hb,eb,UI]}),r=eI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=aD(i.toString());YR(n,o,()=>o(n.currentUser)),QR(n,a=>o(a))}}const s=XT("auth");return s&&VR(n,`http://${s}`),n}function lD(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}xR({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=tr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",lD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});sD("Browser");var q_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ts,KI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,y){function E(){}E.prototype=y.prototype,_.D=y.prototype,_.prototype=new E,_.prototype.constructor=_,_.C=function(T,P,b){for(var k=Array(arguments.length-2),le=2;le<arguments.length;le++)k[le-2]=arguments[le];return y.prototype[P].apply(T,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,y,E){E||(E=0);var T=Array(16);if(typeof y=="string")for(var P=0;16>P;++P)T[P]=y.charCodeAt(E++)|y.charCodeAt(E++)<<8|y.charCodeAt(E++)<<16|y.charCodeAt(E++)<<24;else for(P=0;16>P;++P)T[P]=y[E++]|y[E++]<<8|y[E++]<<16|y[E++]<<24;y=_.g[0],E=_.g[1],P=_.g[2];var b=_.g[3],k=y+(b^E&(P^b))+T[0]+3614090360&4294967295;y=E+(k<<7&4294967295|k>>>25),k=b+(P^y&(E^P))+T[1]+3905402710&4294967295,b=y+(k<<12&4294967295|k>>>20),k=P+(E^b&(y^E))+T[2]+606105819&4294967295,P=b+(k<<17&4294967295|k>>>15),k=E+(y^P&(b^y))+T[3]+3250441966&4294967295,E=P+(k<<22&4294967295|k>>>10),k=y+(b^E&(P^b))+T[4]+4118548399&4294967295,y=E+(k<<7&4294967295|k>>>25),k=b+(P^y&(E^P))+T[5]+1200080426&4294967295,b=y+(k<<12&4294967295|k>>>20),k=P+(E^b&(y^E))+T[6]+2821735955&4294967295,P=b+(k<<17&4294967295|k>>>15),k=E+(y^P&(b^y))+T[7]+4249261313&4294967295,E=P+(k<<22&4294967295|k>>>10),k=y+(b^E&(P^b))+T[8]+1770035416&4294967295,y=E+(k<<7&4294967295|k>>>25),k=b+(P^y&(E^P))+T[9]+2336552879&4294967295,b=y+(k<<12&4294967295|k>>>20),k=P+(E^b&(y^E))+T[10]+4294925233&4294967295,P=b+(k<<17&4294967295|k>>>15),k=E+(y^P&(b^y))+T[11]+2304563134&4294967295,E=P+(k<<22&4294967295|k>>>10),k=y+(b^E&(P^b))+T[12]+1804603682&4294967295,y=E+(k<<7&4294967295|k>>>25),k=b+(P^y&(E^P))+T[13]+4254626195&4294967295,b=y+(k<<12&4294967295|k>>>20),k=P+(E^b&(y^E))+T[14]+2792965006&4294967295,P=b+(k<<17&4294967295|k>>>15),k=E+(y^P&(b^y))+T[15]+1236535329&4294967295,E=P+(k<<22&4294967295|k>>>10),k=y+(P^b&(E^P))+T[1]+4129170786&4294967295,y=E+(k<<5&4294967295|k>>>27),k=b+(E^P&(y^E))+T[6]+3225465664&4294967295,b=y+(k<<9&4294967295|k>>>23),k=P+(y^E&(b^y))+T[11]+643717713&4294967295,P=b+(k<<14&4294967295|k>>>18),k=E+(b^y&(P^b))+T[0]+3921069994&4294967295,E=P+(k<<20&4294967295|k>>>12),k=y+(P^b&(E^P))+T[5]+3593408605&4294967295,y=E+(k<<5&4294967295|k>>>27),k=b+(E^P&(y^E))+T[10]+38016083&4294967295,b=y+(k<<9&4294967295|k>>>23),k=P+(y^E&(b^y))+T[15]+3634488961&4294967295,P=b+(k<<14&4294967295|k>>>18),k=E+(b^y&(P^b))+T[4]+3889429448&4294967295,E=P+(k<<20&4294967295|k>>>12),k=y+(P^b&(E^P))+T[9]+568446438&4294967295,y=E+(k<<5&4294967295|k>>>27),k=b+(E^P&(y^E))+T[14]+3275163606&4294967295,b=y+(k<<9&4294967295|k>>>23),k=P+(y^E&(b^y))+T[3]+4107603335&4294967295,P=b+(k<<14&4294967295|k>>>18),k=E+(b^y&(P^b))+T[8]+1163531501&4294967295,E=P+(k<<20&4294967295|k>>>12),k=y+(P^b&(E^P))+T[13]+2850285829&4294967295,y=E+(k<<5&4294967295|k>>>27),k=b+(E^P&(y^E))+T[2]+4243563512&4294967295,b=y+(k<<9&4294967295|k>>>23),k=P+(y^E&(b^y))+T[7]+1735328473&4294967295,P=b+(k<<14&4294967295|k>>>18),k=E+(b^y&(P^b))+T[12]+2368359562&4294967295,E=P+(k<<20&4294967295|k>>>12),k=y+(E^P^b)+T[5]+4294588738&4294967295,y=E+(k<<4&4294967295|k>>>28),k=b+(y^E^P)+T[8]+2272392833&4294967295,b=y+(k<<11&4294967295|k>>>21),k=P+(b^y^E)+T[11]+1839030562&4294967295,P=b+(k<<16&4294967295|k>>>16),k=E+(P^b^y)+T[14]+4259657740&4294967295,E=P+(k<<23&4294967295|k>>>9),k=y+(E^P^b)+T[1]+2763975236&4294967295,y=E+(k<<4&4294967295|k>>>28),k=b+(y^E^P)+T[4]+1272893353&4294967295,b=y+(k<<11&4294967295|k>>>21),k=P+(b^y^E)+T[7]+4139469664&4294967295,P=b+(k<<16&4294967295|k>>>16),k=E+(P^b^y)+T[10]+3200236656&4294967295,E=P+(k<<23&4294967295|k>>>9),k=y+(E^P^b)+T[13]+681279174&4294967295,y=E+(k<<4&4294967295|k>>>28),k=b+(y^E^P)+T[0]+3936430074&4294967295,b=y+(k<<11&4294967295|k>>>21),k=P+(b^y^E)+T[3]+3572445317&4294967295,P=b+(k<<16&4294967295|k>>>16),k=E+(P^b^y)+T[6]+76029189&4294967295,E=P+(k<<23&4294967295|k>>>9),k=y+(E^P^b)+T[9]+3654602809&4294967295,y=E+(k<<4&4294967295|k>>>28),k=b+(y^E^P)+T[12]+3873151461&4294967295,b=y+(k<<11&4294967295|k>>>21),k=P+(b^y^E)+T[15]+530742520&4294967295,P=b+(k<<16&4294967295|k>>>16),k=E+(P^b^y)+T[2]+3299628645&4294967295,E=P+(k<<23&4294967295|k>>>9),k=y+(P^(E|~b))+T[0]+4096336452&4294967295,y=E+(k<<6&4294967295|k>>>26),k=b+(E^(y|~P))+T[7]+1126891415&4294967295,b=y+(k<<10&4294967295|k>>>22),k=P+(y^(b|~E))+T[14]+2878612391&4294967295,P=b+(k<<15&4294967295|k>>>17),k=E+(b^(P|~y))+T[5]+4237533241&4294967295,E=P+(k<<21&4294967295|k>>>11),k=y+(P^(E|~b))+T[12]+1700485571&4294967295,y=E+(k<<6&4294967295|k>>>26),k=b+(E^(y|~P))+T[3]+2399980690&4294967295,b=y+(k<<10&4294967295|k>>>22),k=P+(y^(b|~E))+T[10]+4293915773&4294967295,P=b+(k<<15&4294967295|k>>>17),k=E+(b^(P|~y))+T[1]+2240044497&4294967295,E=P+(k<<21&4294967295|k>>>11),k=y+(P^(E|~b))+T[8]+1873313359&4294967295,y=E+(k<<6&4294967295|k>>>26),k=b+(E^(y|~P))+T[15]+4264355552&4294967295,b=y+(k<<10&4294967295|k>>>22),k=P+(y^(b|~E))+T[6]+2734768916&4294967295,P=b+(k<<15&4294967295|k>>>17),k=E+(b^(P|~y))+T[13]+1309151649&4294967295,E=P+(k<<21&4294967295|k>>>11),k=y+(P^(E|~b))+T[4]+4149444226&4294967295,y=E+(k<<6&4294967295|k>>>26),k=b+(E^(y|~P))+T[11]+3174756917&4294967295,b=y+(k<<10&4294967295|k>>>22),k=P+(y^(b|~E))+T[2]+718787259&4294967295,P=b+(k<<15&4294967295|k>>>17),k=E+(b^(P|~y))+T[9]+3951481745&4294967295,_.g[0]=_.g[0]+y&4294967295,_.g[1]=_.g[1]+(P+(k<<21&4294967295|k>>>11))&4294967295,_.g[2]=_.g[2]+P&4294967295,_.g[3]=_.g[3]+b&4294967295}r.prototype.u=function(_,y){y===void 0&&(y=_.length);for(var E=y-this.blockSize,T=this.B,P=this.h,b=0;b<y;){if(P==0)for(;b<=E;)s(this,_,b),b+=this.blockSize;if(typeof _=="string"){for(;b<y;)if(T[P++]=_.charCodeAt(b++),P==this.blockSize){s(this,T),P=0;break}}else for(;b<y;)if(T[P++]=_[b++],P==this.blockSize){s(this,T),P=0;break}}this.h=P,this.o+=y},r.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var y=1;y<_.length-8;++y)_[y]=0;var E=8*this.o;for(y=_.length-8;y<_.length;++y)_[y]=E&255,E/=256;for(this.u(_),_=Array(16),y=E=0;4>y;++y)for(var T=0;32>T;T+=8)_[E++]=this.g[y]>>>T&255;return _};function i(_,y){var E=a;return Object.prototype.hasOwnProperty.call(E,_)?E[_]:E[_]=y(_)}function o(_,y){this.h=y;for(var E=[],T=!0,P=_.length-1;0<=P;P--){var b=_[P]|0;T&&b==y||(E[P]=b,T=!1)}this.g=E}var a={};function c(_){return-128<=_&&128>_?i(_,function(y){return new o([y|0],0>y?-1:0)}):new o([_|0],0>_?-1:0)}function d(_){if(isNaN(_)||!isFinite(_))return m;if(0>_)return C(d(-_));for(var y=[],E=1,T=0;_>=E;T++)y[T]=_/E|0,E*=4294967296;return new o(y,0)}function f(_,y){if(_.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(_.charAt(0)=="-")return C(f(_.substring(1),y));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(y,8)),T=m,P=0;P<_.length;P+=8){var b=Math.min(8,_.length-P),k=parseInt(_.substring(P,P+b),y);8>b?(b=d(Math.pow(y,b)),T=T.j(b).add(d(k))):(T=T.j(E),T=T.add(d(k)))}return T}var m=c(0),g=c(1),x=c(16777216);t=o.prototype,t.m=function(){if(N(this))return-C(this).m();for(var _=0,y=1,E=0;E<this.g.length;E++){var T=this.i(E);_+=(0<=T?T:4294967296+T)*y,y*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(A(this))return"0";if(N(this))return"-"+C(this).toString(_);for(var y=d(Math.pow(_,6)),E=this,T="";;){var P=D(E,y).g;E=I(E,P.j(y));var b=((0<E.g.length?E.g[0]:E.h)>>>0).toString(_);if(E=P,A(E))return b+T;for(;6>b.length;)b="0"+b;T=b+T}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function A(_){if(_.h!=0)return!1;for(var y=0;y<_.g.length;y++)if(_.g[y]!=0)return!1;return!0}function N(_){return _.h==-1}t.l=function(_){return _=I(this,_),N(_)?-1:A(_)?0:1};function C(_){for(var y=_.g.length,E=[],T=0;T<y;T++)E[T]=~_.g[T];return new o(E,~_.h).add(g)}t.abs=function(){return N(this)?C(this):this},t.add=function(_){for(var y=Math.max(this.g.length,_.g.length),E=[],T=0,P=0;P<=y;P++){var b=T+(this.i(P)&65535)+(_.i(P)&65535),k=(b>>>16)+(this.i(P)>>>16)+(_.i(P)>>>16);T=k>>>16,b&=65535,k&=65535,E[P]=k<<16|b}return new o(E,E[E.length-1]&-2147483648?-1:0)};function I(_,y){return _.add(C(y))}t.j=function(_){if(A(this)||A(_))return m;if(N(this))return N(_)?C(this).j(C(_)):C(C(this).j(_));if(N(_))return C(this.j(C(_)));if(0>this.l(x)&&0>_.l(x))return d(this.m()*_.m());for(var y=this.g.length+_.g.length,E=[],T=0;T<2*y;T++)E[T]=0;for(T=0;T<this.g.length;T++)for(var P=0;P<_.g.length;P++){var b=this.i(T)>>>16,k=this.i(T)&65535,le=_.i(P)>>>16,ve=_.i(P)&65535;E[2*T+2*P]+=k*ve,v(E,2*T+2*P),E[2*T+2*P+1]+=b*ve,v(E,2*T+2*P+1),E[2*T+2*P+1]+=k*le,v(E,2*T+2*P+1),E[2*T+2*P+2]+=b*le,v(E,2*T+2*P+2)}for(T=0;T<y;T++)E[T]=E[2*T+1]<<16|E[2*T];for(T=y;T<2*y;T++)E[T]=0;return new o(E,0)};function v(_,y){for(;(_[y]&65535)!=_[y];)_[y+1]+=_[y]>>>16,_[y]&=65535,y++}function S(_,y){this.g=_,this.h=y}function D(_,y){if(A(y))throw Error("division by zero");if(A(_))return new S(m,m);if(N(_))return y=D(C(_),y),new S(C(y.g),C(y.h));if(N(y))return y=D(_,C(y)),new S(C(y.g),y.h);if(30<_.g.length){if(N(_)||N(y))throw Error("slowDivide_ only works with positive integers.");for(var E=g,T=y;0>=T.l(_);)E=L(E),T=L(T);var P=V(E,1),b=V(T,1);for(T=V(T,2),E=V(E,2);!A(T);){var k=b.add(T);0>=k.l(_)&&(P=P.add(E),b=k),T=V(T,1),E=V(E,1)}return y=I(_,P.j(y)),new S(P,y)}for(P=m;0<=_.l(y);){for(E=Math.max(1,Math.floor(_.m()/y.m())),T=Math.ceil(Math.log(E)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),b=d(E),k=b.j(y);N(k)||0<k.l(_);)E-=T,b=d(E),k=b.j(y);A(b)&&(b=g),P=P.add(b),_=I(_,k)}return new S(P,_)}t.A=function(_){return D(this,_).h},t.and=function(_){for(var y=Math.max(this.g.length,_.g.length),E=[],T=0;T<y;T++)E[T]=this.i(T)&_.i(T);return new o(E,this.h&_.h)},t.or=function(_){for(var y=Math.max(this.g.length,_.g.length),E=[],T=0;T<y;T++)E[T]=this.i(T)|_.i(T);return new o(E,this.h|_.h)},t.xor=function(_){for(var y=Math.max(this.g.length,_.g.length),E=[],T=0;T<y;T++)E[T]=this.i(T)^_.i(T);return new o(E,this.h^_.h)};function L(_){for(var y=_.g.length+1,E=[],T=0;T<y;T++)E[T]=_.i(T)<<1|_.i(T-1)>>>31;return new o(E,_.h)}function V(_,y){var E=y>>5;y%=32;for(var T=_.g.length-E,P=[],b=0;b<T;b++)P[b]=0<y?_.i(b+E)>>>y|_.i(b+E+1)<<32-y:_.i(b+E);return new o(P,_.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,KI=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,Ts=o}).apply(typeof q_<"u"?q_:typeof self<"u"?self:typeof window<"u"?window:{});var Zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var QI,qa,YI,xu,zm,XI,JI,ZI;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zc=="object"&&Zc];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var w=0;w<l.length-1;w++){var M=l[w];if(!(M in p))break e;p=p[M]}l=l[l.length-1],w=p[l],h=h(w),h!=w&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var p=0,w=!1,M={next:function(){if(!w&&p<l.length){var F=p++;return{value:h(F,l[F]),done:!1}}return w=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,p){return l.call.apply(l.bind,arguments)}function m(l,h,p){if(!l)throw Error();if(2<arguments.length){var w=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,w),l.apply(h,M)}}return function(){return l.apply(h,arguments)}}function g(l,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,g.apply(null,arguments)}function x(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var w=p.slice();return w.push.apply(w,arguments),l.apply(this,w)}}function A(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(w,M,F){for(var H=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)H[Ce-2]=arguments[Ce];return h.prototype[M].apply(w,H)}}function N(l){const h=l.length;if(0<h){const p=Array(h);for(let w=0;w<h;w++)p[w]=l[w];return p}return[]}function C(l,h){for(let p=1;p<arguments.length;p++){const w=arguments[p];if(c(w)){const M=l.length||0,F=w.length||0;l.length=M+F;for(let H=0;H<F;H++)l[M+H]=w[H]}else l.push(w)}}class I{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(l){return/^[\s\xa0]*$/.test(l)}function S(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function D(l){return D[" "](l),l}D[" "]=function(){};var L=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function V(l,h,p){for(const w in l)h.call(p,l[w],w,l)}function _(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function y(l){const h={};for(const p in l)h[p]=l[p];return h}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(l,h){let p,w;for(let M=1;M<arguments.length;M++){w=arguments[M];for(p in w)l[p]=w[p];for(let F=0;F<E.length;F++)p=E[F],Object.prototype.hasOwnProperty.call(w,p)&&(l[p]=w[p])}}function P(l){var h=1;l=l.split(":");const p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function b(l){a.setTimeout(()=>{throw l},0)}function k(){var l=J;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class le{constructor(){this.h=this.g=null}add(h,p){const w=ve.get();w.set(h,p),this.h?this.h.next=w:this.g=w,this.h=w}}var ve=new I(()=>new ne,l=>l.reset());class ne{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Fe,q=!1,J=new le,ue=()=>{const l=a.Promise.resolve(void 0);Fe=()=>{l.then(Pe)}};var Pe=()=>{for(var l;l=k();){try{l.h.call(l.g)}catch(p){b(p)}var h=ve;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}q=!1};function we(){this.s=this.s,this.C=this.C}we.prototype.s=!1,we.prototype.ma=function(){this.s||(this.s=!0,this.N())},we.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ne(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Ne.prototype.h=function(){this.defaultPrevented=!0};var Ot=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function Xt(l,h){if(Ne.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,w=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(L){e:{try{D(h.nodeName);var M=!0;break e}catch{}M=!1}M||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Jt[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Xt.aa.h.call(this)}}A(Xt,Ne);var Jt={2:"touch",3:"pen",4:"mouse"};Xt.prototype.h=function(){Xt.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Tt="closure_listenable_"+(1e6*Math.random()|0),Z=0;function he(l,h,p,w,M){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!w,this.ha=M,this.key=++Z,this.da=this.fa=!1}function Re(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ye(l){this.src=l,this.g={},this.h=0}Ye.prototype.add=function(l,h,p,w,M){var F=l.toString();l=this.g[F],l||(l=this.g[F]=[],this.h++);var H=ir(l,h,w,M);return-1<H?(h=l[H],p||(h.fa=!1)):(h=new he(h,this.src,F,!!w,M),h.fa=p,l.push(h)),h};function It(l,h){var p=h.type;if(p in l.g){var w=l.g[p],M=Array.prototype.indexOf.call(w,h,void 0),F;(F=0<=M)&&Array.prototype.splice.call(w,M,1),F&&(Re(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function ir(l,h,p,w){for(var M=0;M<l.length;++M){var F=l[M];if(!F.da&&F.listener==h&&F.capture==!!p&&F.ha==w)return M}return-1}var Bs="closure_lm_"+(1e6*Math.random()|0),fa={};function yc(l,h,p,w,M){if(Array.isArray(h)){for(var F=0;F<h.length;F++)yc(l,h[F],p,w,M);return null}return p=wc(p),l&&l[Tt]?l.K(h,p,d(w)?!!w.capture:!1,M):jh(l,h,p,!1,w,M)}function jh(l,h,p,w,M,F){if(!h)throw Error("Invalid event type");var H=d(M)?!!M.capture:!!M,Ce=pa(l);if(Ce||(l[Bs]=Ce=new Ye(l)),p=Ce.add(h,p,w,H,F),p.proxy)return p;if(w=Vh(),p.proxy=w,w.src=l,w.listener=p,l.addEventListener)Ot||(M=H),M===void 0&&(M=!1),l.addEventListener(h.toString(),w,M);else if(l.attachEvent)l.attachEvent(_c(h.toString()),w);else if(l.addListener&&l.removeListener)l.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Vh(){function l(p){return h.call(l.src,l.listener,p)}const h=Oh;return l}function vc(l,h,p,w,M){if(Array.isArray(h))for(var F=0;F<h.length;F++)vc(l,h[F],p,w,M);else w=d(w)?!!w.capture:!!w,p=wc(p),l&&l[Tt]?(l=l.i,h=String(h).toString(),h in l.g&&(F=l.g[h],p=ir(F,p,w,M),-1<p&&(Re(F[p]),Array.prototype.splice.call(F,p,1),F.length==0&&(delete l.g[h],l.h--)))):l&&(l=pa(l))&&(h=l.g[h.toString()],l=-1,h&&(l=ir(h,p,w,M)),(p=-1<l?h[l]:null)&&ma(p))}function ma(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Tt])It(h.i,l);else{var p=l.type,w=l.proxy;h.removeEventListener?h.removeEventListener(p,w,l.capture):h.detachEvent?h.detachEvent(_c(p),w):h.addListener&&h.removeListener&&h.removeListener(w),(p=pa(h))?(It(p,l),p.h==0&&(p.src=null,h[Bs]=null)):Re(l)}}}function _c(l){return l in fa?fa[l]:fa[l]="on"+l}function Oh(l,h){if(l.da)l=!0;else{h=new Xt(h,this);var p=l.listener,w=l.ha||l.src;l.fa&&ma(l),l=p.call(w,h)}return l}function pa(l){return l=l[Bs],l instanceof Ye?l:null}var ga="__closure_events_fn_"+(1e9*Math.random()>>>0);function wc(l){return typeof l=="function"?l:(l[ga]||(l[ga]=function(h){return l.handleEvent(h)}),l[ga])}function it(){we.call(this),this.i=new Ye(this),this.M=this,this.F=null}A(it,we),it.prototype[Tt]=!0,it.prototype.removeEventListener=function(l,h,p,w){vc(this,l,h,p,w)};function ft(l,h){var p,w=l.F;if(w)for(p=[];w;w=w.F)p.push(w);if(l=l.M,w=h.type||h,typeof h=="string")h=new Ne(h,l);else if(h instanceof Ne)h.target=h.target||l;else{var M=h;h=new Ne(w,l),T(h,M)}if(M=!0,p)for(var F=p.length-1;0<=F;F--){var H=h.g=p[F];M=hn(H,w,!0,h)&&M}if(H=h.g=l,M=hn(H,w,!0,h)&&M,M=hn(H,w,!1,h)&&M,p)for(F=0;F<p.length;F++)H=h.g=p[F],M=hn(H,w,!1,h)&&M}it.prototype.N=function(){if(it.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],w=0;w<p.length;w++)Re(p[w]);delete l.g[h],l.h--}}this.F=null},it.prototype.K=function(l,h,p,w){return this.i.add(String(l),h,!1,p,w)},it.prototype.L=function(l,h,p,w){return this.i.add(String(l),h,!0,p,w)};function hn(l,h,p,w){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var M=!0,F=0;F<h.length;++F){var H=h[F];if(H&&!H.da&&H.capture==p){var Ce=H.listener,gt=H.ha||H.src;H.fa&&It(l.i,H),M=Ce.call(gt,w)!==!1&&M}}return M&&!w.defaultPrevented}function Ec(l,h,p){if(typeof l=="function")p&&(l=g(l,p));else if(l&&typeof l.handleEvent=="function")l=g(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function Tc(l){l.g=Ec(()=>{l.g=null,l.i&&(l.i=!1,Tc(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Mh extends we{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Tc(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jr(l){we.call(this),this.h=l,this.g={}}A(jr,we);var j=[];function B(l){V(l.g,function(h,p){this.g.hasOwnProperty(p)&&ma(h)},l),l.g={}}jr.prototype.N=function(){jr.aa.N.call(this),B(this)},jr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var G=a.JSON.stringify,ee=a.JSON.parse,ie=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function ae(){}ae.prototype.h=null;function me(l){return l.h||(l.h=l.i())}function mt(){}var Ue={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function zs(){Ne.call(this,"d")}A(zs,Ne);function Bi(){Ne.call(this,"c")}A(Bi,Ne);var Ln={},zi=null;function Fn(){return zi=zi||new it}Ln.La="serverreachability";function Vr(l){Ne.call(this,Ln.La,l)}A(Vr,Ne);function Un(l){const h=Fn();ft(h,new Vr(h))}Ln.STAT_EVENT="statevent";function Or(l,h){Ne.call(this,Ln.STAT_EVENT,l),this.stat=h}A(Or,Ne);function Ze(l){const h=Fn();ft(h,new Or(h,l))}Ln.Ma="timingevent";function Mr(l,h){Ne.call(this,Ln.Ma,l),this.size=h}A(Mr,Ne);function Bn(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function Lr(){this.g=!0}Lr.prototype.xa=function(){this.g=!1};function Ic(l,h,p,w,M,F){l.info(function(){if(l.g)if(F)for(var H="",Ce=F.split("&"),gt=0;gt<Ce.length;gt++){var Ie=Ce[gt].split("=");if(1<Ie.length){var St=Ie[0];Ie=Ie[1];var xt=St.split("_");H=2<=xt.length&&xt[1]=="type"?H+(St+"="+Ie+"&"):H+(St+"=redacted&")}}else H=null;else H=F;return"XMLHTTP REQ ("+w+") [attempt "+M+"]: "+h+`
`+p+`
`+H})}function $s(l,h,p,w,M,F,H){l.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+M+"]: "+h+`
`+p+`
`+F+" "+H})}function fn(l,h,p,w){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+Wi(l,p)+(w?" "+w:"")})}function $i(l,h){l.info(function(){return"TIMEOUT: "+h})}Lr.prototype.info=function(){};function Wi(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var w=p[l];if(!(2>w.length)){var M=w[1];if(Array.isArray(M)&&!(1>M.length)){var F=M[0];if(F!="noop"&&F!="stop"&&F!="close")for(var H=1;H<M.length;H++)M[H]=""}}}}return G(p)}catch{return h}}var or={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ur;function Ws(){}A(Ws,ae),Ws.prototype.g=function(){return new XMLHttpRequest},Ws.prototype.i=function(){return{}},Ur=new Ws;function kn(l,h,p,w){this.j=l,this.i=h,this.l=p,this.R=w||1,this.U=new jr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Br}function Br(){this.i=null,this.g="",this.h=!1}var zr={},$r={};function ar(l,h,p){l.L=1,l.v=kc(lr(h)),l.m=p,l.P=!0,qi(l,null)}function qi(l,h){l.F=Date.now(),pt(l),l.A=lr(l.v);var p=l.A,w=l.R;Array.isArray(w)||(w=[String(w)]),Ry(p.i,"t",w),l.C=0,p=l.j.J,l.h=new Br,l.g=Qy(l.j,p?h:null,!l.m),0<l.O&&(l.M=new Mh(g(l.Y,l,l.g),l.O)),h=l.U,p=l.g,w=l.ca;var M="readystatechange";Array.isArray(M)||(M&&(j[0]=M.toString()),M=j);for(var F=0;F<M.length;F++){var H=yc(p,M[F],w||h.handleEvent,!1,h.h||h);if(!H)break;h.g[H.key]=H}h=l.H?y(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Un(),Ic(l.i,l.u,l.A,l.l,l.R,l.m)}kn.prototype.ca=function(l){l=l.target;const h=this.M;h&&cr(l)==3?h.j():this.Y(l)},kn.prototype.Y=function(l){try{if(l==this.g)e:{const xt=cr(this.g);var h=this.g.Ba();const Ki=this.g.Z();if(!(3>xt)&&(xt!=3||this.g&&(this.h.h||this.g.oa()||Ly(this.g)))){this.J||xt!=4||h==7||(h==8||0>=Ki?Un(3):Un(2)),qs(this);var p=this.g.Z();this.X=p;t:if(Xe(this)){var w=Ly(this.g);l="";var M=w.length,F=cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gs(this),ya(this);var H="";break t}this.h.i=new a.TextDecoder}for(h=0;h<M;h++)this.h.h=!0,l+=this.h.i.decode(w[h],{stream:!(F&&h==M-1)});w.length=0,this.h.g+=l,this.C=0,H=this.h.g}else H=this.g.oa();if(this.o=p==200,$s(this.i,this.u,this.A,this.l,this.R,xt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Ce,gt=this.g;if((Ce=gt.g?gt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Ce)){var Ie=Ce;break t}}Ie=null}if(p=Ie)fn(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Lh(this,p);else{this.o=!1,this.s=3,Ze(12),Gs(this),ya(this);break e}}if(this.P){p=!0;let An;for(;!this.J&&this.C<H.length;)if(An=Mt(this,H),An==$r){xt==4&&(this.s=4,Ze(14),p=!1),fn(this.i,this.l,null,"[Incomplete Response]");break}else if(An==zr){this.s=4,Ze(15),fn(this.i,this.l,H,"[Invalid Chunk]"),p=!1;break}else fn(this.i,this.l,An,null),Lh(this,An);if(Xe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xt!=4||H.length!=0||this.h.h||(this.s=1,Ze(16),p=!1),this.o=this.o&&p,!p)fn(this.i,this.l,H,"[Invalid Chunked Response]"),Gs(this),ya(this);else if(0<H.length&&!this.W){this.W=!0;var St=this.j;St.g==this&&St.ba&&!St.M&&(St.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),Wh(St),St.M=!0,Ze(11))}}else fn(this.i,this.l,H,null),Lh(this,H);xt==4&&Gs(this),this.o&&!this.J&&(xt==4?qy(this.j,this):(this.o=!1,pt(this)))}else M1(this.g),p==400&&0<H.indexOf("Unknown SID")?(this.s=3,Ze(12)):(this.s=0,Ze(13)),Gs(this),ya(this)}}}catch{}finally{}};function Xe(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Mt(l,h){var p=l.C,w=h.indexOf(`
`,p);return w==-1?$r:(p=Number(h.substring(p,w)),isNaN(p)?zr:(w+=1,w+p>h.length?$r:(h=h.slice(w,w+p),l.C=w+p,h)))}kn.prototype.cancel=function(){this.J=!0,Gs(this)};function pt(l){l.S=Date.now()+l.I,zn(l,l.I)}function zn(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Bn(g(l.ba,l),h)}function qs(l){l.B&&(a.clearTimeout(l.B),l.B=null)}kn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?($i(this.i,this.A),this.L!=2&&(Un(),Ze(17)),Gs(this),this.s=2,ya(this)):zn(this,this.S-l)};function ya(l){l.j.G==0||l.J||qy(l.j,l)}function Gs(l){qs(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,B(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Lh(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||Fh(p.h,l))){if(!l.K&&Fh(p.h,l)&&p.G==3){try{var w=p.Da.g.parse(h)}catch{w=null}if(Array.isArray(w)&&w.length==3){var M=w;if(M[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)bc(p),Cc(p);else break e;$h(p),Ze(18)}}else p.za=M[1],0<p.za-p.T&&37500>M[2]&&p.F&&p.v==0&&!p.C&&(p.C=Bn(g(p.Za,p),6e3));if(1>=Ty(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Ks(p,11)}else if((l.K||p.g==l)&&bc(p),!v(h))for(M=p.Da.g.parse(h),h=0;h<M.length;h++){let Ie=M[h];if(p.T=Ie[0],Ie=Ie[1],p.G==2)if(Ie[0]=="c"){p.K=Ie[1],p.ia=Ie[2];const St=Ie[3];St!=null&&(p.la=St,p.j.info("VER="+p.la));const xt=Ie[4];xt!=null&&(p.Aa=xt,p.j.info("SVER="+p.Aa));const Ki=Ie[5];Ki!=null&&typeof Ki=="number"&&0<Ki&&(w=1.5*Ki,p.L=w,p.j.info("backChannelRequestTimeoutMs_="+w)),w=p;const An=l.g;if(An){const jc=An.g?An.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jc){var F=w.h;F.g||jc.indexOf("spdy")==-1&&jc.indexOf("quic")==-1&&jc.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Uh(F,F.h),F.h=null))}if(w.D){const qh=An.g?An.g.getResponseHeader("X-HTTP-Session-Id"):null;qh&&(w.ya=qh,De(w.I,w.D,qh))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),w=p;var H=l;if(w.qa=Ky(w,w.J?w.ia:null,w.W),H.K){Iy(w.h,H);var Ce=H,gt=w.L;gt&&(Ce.I=gt),Ce.B&&(qs(Ce),pt(Ce)),w.g=H}else $y(w);0<p.i.length&&Rc(p)}else Ie[0]!="stop"&&Ie[0]!="close"||Ks(p,7);else p.G==3&&(Ie[0]=="stop"||Ie[0]=="close"?Ie[0]=="stop"?Ks(p,7):zh(p):Ie[0]!="noop"&&p.l&&p.l.ta(Ie),p.v=0)}}Un(4)}catch{}}var E1=class{constructor(l,h){this.g=l,this.map=h}};function wy(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ey(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Ty(l){return l.h?1:l.g?l.g.size:0}function Fh(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Uh(l,h){l.g?l.g.add(h):l.h=h}function Iy(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}wy.prototype.cancel=function(){if(this.i=Sy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Sy(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.D);return h}return N(l.i)}function T1(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],p=l.length,w=0;w<p;w++)h.push(l[w]);return h}h=[],p=0;for(w in l)h[p++]=l[w];return h}function I1(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(const w in l)h[p++]=w;return h}}}function xy(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=I1(l),w=T1(l),M=w.length,F=0;F<M;F++)h.call(void 0,w[F],p&&p[F],l)}var ky=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function S1(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var w=l[p].indexOf("="),M=null;if(0<=w){var F=l[p].substring(0,w);M=l[p].substring(w+1)}else F=l[p];h(F,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Hs(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Hs){this.h=l.h,Sc(this,l.j),this.o=l.o,this.g=l.g,xc(this,l.s),this.l=l.l;var h=l.i,p=new wa;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),Ay(this,p),this.m=l.m}else l&&(h=String(l).match(ky))?(this.h=!1,Sc(this,h[1]||"",!0),this.o=va(h[2]||""),this.g=va(h[3]||"",!0),xc(this,h[4]),this.l=va(h[5]||"",!0),Ay(this,h[6]||"",!0),this.m=va(h[7]||"")):(this.h=!1,this.i=new wa(null,this.h))}Hs.prototype.toString=function(){var l=[],h=this.j;h&&l.push(_a(h,Py,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(_a(h,Py,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(_a(p,p.charAt(0)=="/"?A1:k1,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",_a(p,N1)),l.join("")};function lr(l){return new Hs(l)}function Sc(l,h,p){l.j=p?va(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function xc(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Ay(l,h,p){h instanceof wa?(l.i=h,C1(l.i,l.h)):(p||(h=_a(h,P1)),l.i=new wa(h,l.h))}function De(l,h,p){l.i.set(h,p)}function kc(l){return De(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function va(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function _a(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,x1),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function x1(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Py=/[#\/\?@]/g,k1=/[#\?:]/g,A1=/[#\?]/g,P1=/[#\?@]/g,N1=/#/g;function wa(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Wr(l){l.g||(l.g=new Map,l.h=0,l.i&&S1(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=wa.prototype,t.add=function(l,h){Wr(this),this.i=null,l=Gi(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function Ny(l,h){Wr(l),h=Gi(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Cy(l,h){return Wr(l),h=Gi(l,h),l.g.has(h)}t.forEach=function(l,h){Wr(this),this.g.forEach(function(p,w){p.forEach(function(M){l.call(h,M,w,this)},this)},this)},t.na=function(){Wr(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let w=0;w<h.length;w++){const M=l[w];for(let F=0;F<M.length;F++)p.push(h[w])}return p},t.V=function(l){Wr(this);let h=[];if(typeof l=="string")Cy(this,l)&&(h=h.concat(this.g.get(Gi(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},t.set=function(l,h){return Wr(this),this.i=null,l=Gi(this,l),Cy(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Ry(l,h,p){Ny(l,h),0<p.length&&(l.i=null,l.g.set(Gi(l,h),N(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var w=h[p];const F=encodeURIComponent(String(w)),H=this.V(w);for(w=0;w<H.length;w++){var M=F;H[w]!==""&&(M+="="+encodeURIComponent(String(H[w]))),l.push(M)}}return this.i=l.join("&")};function Gi(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function C1(l,h){h&&!l.j&&(Wr(l),l.i=null,l.g.forEach(function(p,w){var M=w.toLowerCase();w!=M&&(Ny(this,w),Ry(this,M,p))},l)),l.j=h}function R1(l,h){const p=new Lr;if(a.Image){const w=new Image;w.onload=x(qr,p,"TestLoadImage: loaded",!0,h,w),w.onerror=x(qr,p,"TestLoadImage: error",!1,h,w),w.onabort=x(qr,p,"TestLoadImage: abort",!1,h,w),w.ontimeout=x(qr,p,"TestLoadImage: timeout",!1,h,w),a.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=l}else h(!1)}function b1(l,h){const p=new Lr,w=new AbortController,M=setTimeout(()=>{w.abort(),qr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:w.signal}).then(F=>{clearTimeout(M),F.ok?qr(p,"TestPingServer: ok",!0,h):qr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(M),qr(p,"TestPingServer: error",!1,h)})}function qr(l,h,p,w,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),w(p)}catch{}}function D1(){this.g=new ie}function j1(l,h,p){const w=p||"";try{xy(l,function(M,F){let H=M;d(M)&&(H=G(M)),h.push(w+F+"="+encodeURIComponent(H))})}catch(M){throw h.push(w+"type="+encodeURIComponent("_badmap")),M}}function Ac(l){this.l=l.Ub||null,this.j=l.eb||!1}A(Ac,ae),Ac.prototype.g=function(){return new Pc(this.l,this.j)},Ac.prototype.i=function(l){return function(){return l}}({});function Pc(l,h){it.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(Pc,it),t=Pc.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,Ta(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ea(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Ta(this)),this.g&&(this.readyState=3,Ta(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;by(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function by(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Ea(this):Ta(this),this.readyState==3&&by(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Ea(this))},t.Qa=function(l){this.g&&(this.response=l,Ea(this))},t.ga=function(){this.g&&Ea(this)};function Ea(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Ta(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function Ta(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Pc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Dy(l){let h="";return V(l,function(p,w){h+=w,h+=":",h+=p,h+=`\r
`}),h}function Bh(l,h,p){e:{for(w in p){var w=!1;break e}w=!0}w||(p=Dy(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):De(l,h,p))}function He(l){it.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(He,it);var V1=/^https?$/i,O1=["POST","PUT"];t=He.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,p,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ur.g(),this.v=this.o?me(this.o):me(Ur),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(F){jy(this,F);return}if(l=p||"",p=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var M in w)p.set(M,w[M]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const F of w.keys())p.set(F,w.get(F));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(p.keys()).find(F=>F.toLowerCase()=="content-type"),M=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(O1,h,void 0))||w||M||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,H]of p)this.g.setRequestHeader(F,H);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{My(this),this.u=!0,this.g.send(l),this.u=!1}catch(F){jy(this,F)}};function jy(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Vy(l),Nc(l)}function Vy(l){l.A||(l.A=!0,ft(l,"complete"),ft(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,ft(this,"complete"),ft(this,"abort"),Nc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Nc(this,!0)),He.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Oy(this):this.bb())},t.bb=function(){Oy(this)};function Oy(l){if(l.h&&typeof o<"u"&&(!l.v[1]||cr(l)!=4||l.Z()!=2)){if(l.u&&cr(l)==4)Ec(l.Ea,0,l);else if(ft(l,"readystatechange"),cr(l)==4){l.h=!1;try{const H=l.Z();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var w;if(w=H===0){var M=String(l.D).match(ky)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),w=!V1.test(M?M.toLowerCase():"")}p=w}if(p)ft(l,"complete"),ft(l,"success");else{l.m=6;try{var F=2<cr(l)?l.g.statusText:""}catch{F=""}l.l=F+" ["+l.Z()+"]",Vy(l)}}finally{Nc(l)}}}}function Nc(l,h){if(l.g){My(l);const p=l.g,w=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||ft(l,"ready");try{p.onreadystatechange=w}catch{}}}function My(l){l.I&&(a.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function cr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<cr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),ee(h)}};function Ly(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function M1(l){const h={};l=(l.g&&2<=cr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<l.length;w++){if(v(l[w]))continue;var p=P(l[w]);const M=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const F=h[M]||[];h[M]=F,F.push(p)}_(h,function(w){return w.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ia(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function Fy(l){this.Aa=0,this.i=[],this.j=new Lr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ia("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ia("baseRetryDelayMs",5e3,l),this.cb=Ia("retryDelaySeedMs",1e4,l),this.Wa=Ia("forwardChannelMaxRetries",2,l),this.wa=Ia("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new wy(l&&l.concurrentRequestLimit),this.Da=new D1,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Fy.prototype,t.la=8,t.G=1,t.connect=function(l,h,p,w){Ze(0),this.W=l,this.H=h||{},p&&w!==void 0&&(this.H.OSID=p,this.H.OAID=w),this.F=this.X,this.I=Ky(this,null,this.W),Rc(this)};function zh(l){if(Uy(l),l.G==3){var h=l.U++,p=lr(l.I);if(De(p,"SID",l.K),De(p,"RID",h),De(p,"TYPE","terminate"),Sa(l,p),h=new kn(l,l.j,h),h.L=2,h.v=kc(lr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=Qy(h.j,null),h.g.ea(h.v)),h.F=Date.now(),pt(h)}Hy(l)}function Cc(l){l.g&&(Wh(l),l.g.cancel(),l.g=null)}function Uy(l){Cc(l),l.u&&(a.clearTimeout(l.u),l.u=null),bc(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function Rc(l){if(!Ey(l.h)&&!l.s){l.s=!0;var h=l.Ga;Fe||ue(),q||(Fe(),q=!0),J.add(h,l),l.B=0}}function L1(l,h){return Ty(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Bn(g(l.Ga,l,h),Gy(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const M=new kn(this,this.j,l);let F=this.o;if(this.S&&(F?(F=y(F),T(F,this.S)):F=this.S),this.m!==null||this.O||(M.H=F,F=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var w=this.i[p];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(h+=w,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=zy(this,M,h),p=lr(this.I),De(p,"RID",l),De(p,"CVER",22),this.D&&De(p,"X-HTTP-Session-Id",this.D),Sa(this,p),F&&(this.O?h="headers="+encodeURIComponent(String(Dy(F)))+"&"+h:this.m&&Bh(p,this.m,F)),Uh(this.h,M),this.Ua&&De(p,"TYPE","init"),this.P?(De(p,"$req",h),De(p,"SID","null"),M.T=!0,ar(M,p,null)):ar(M,p,h),this.G=2}}else this.G==3&&(l?By(this,l):this.i.length==0||Ey(this.h)||By(this))};function By(l,h){var p;h?p=h.l:p=l.U++;const w=lr(l.I);De(w,"SID",l.K),De(w,"RID",p),De(w,"AID",l.T),Sa(l,w),l.m&&l.o&&Bh(w,l.m,l.o),p=new kn(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=zy(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Uh(l.h,p),ar(p,w,h)}function Sa(l,h){l.H&&V(l.H,function(p,w){De(h,w,p)}),l.l&&xy({},function(p,w){De(h,w,p)})}function zy(l,h,p){p=Math.min(l.i.length,p);var w=l.l?g(l.l.Na,l.l,l):null;e:{var M=l.i;let F=-1;for(;;){const H=["count="+p];F==-1?0<p?(F=M[0].g,H.push("ofs="+F)):F=0:H.push("ofs="+F);let Ce=!0;for(let gt=0;gt<p;gt++){let Ie=M[gt].g;const St=M[gt].map;if(Ie-=F,0>Ie)F=Math.max(0,M[gt].g-100),Ce=!1;else try{j1(St,H,"req"+Ie+"_")}catch{w&&w(St)}}if(Ce){w=H.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,w}function $y(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;Fe||ue(),q||(Fe(),q=!0),J.add(h,l),l.v=0}}function $h(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Bn(g(l.Fa,l),Gy(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Wy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Bn(g(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ze(10),Cc(this),Wy(this))};function Wh(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function Wy(l){l.g=new kn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=lr(l.qa);De(h,"RID","rpc"),De(h,"SID",l.K),De(h,"AID",l.T),De(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&De(h,"TO",l.ja),De(h,"TYPE","xmlhttp"),Sa(l,h),l.m&&l.o&&Bh(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=kc(lr(h)),p.m=null,p.P=!0,qi(p,l)}t.Za=function(){this.C!=null&&(this.C=null,Cc(this),$h(this),Ze(19))};function bc(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function qy(l,h){var p=null;if(l.g==h){bc(l),Wh(l),l.g=null;var w=2}else if(Fh(l.h,h))p=h.D,Iy(l.h,h),w=1;else return;if(l.G!=0){if(h.o)if(w==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var M=l.B;w=Fn(),ft(w,new Mr(w,p)),Rc(l)}else $y(l);else if(M=h.s,M==3||M==0&&0<h.X||!(w==1&&L1(l,h)||w==2&&$h(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),M){case 1:Ks(l,5);break;case 4:Ks(l,10);break;case 3:Ks(l,6);break;default:Ks(l,2)}}}function Gy(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Ks(l,h){if(l.j.info("Error code "+h),h==2){var p=g(l.fb,l),w=l.Xa;const M=!w;w=new Hs(w||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Sc(w,"https"),kc(w),M?R1(w.toString(),p):b1(w.toString(),p)}else Ze(2);l.G=0,l.l&&l.l.sa(h),Hy(l),Uy(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Ze(2)):(this.j.info("Failed to ping google.com"),Ze(1))};function Hy(l){if(l.G=0,l.ka=[],l.l){const h=Sy(l.h);(h.length!=0||l.i.length!=0)&&(C(l.ka,h),C(l.ka,l.i),l.h.i.length=0,N(l.i),l.i.length=0),l.l.ra()}}function Ky(l,h,p){var w=p instanceof Hs?lr(p):new Hs(p);if(w.g!="")h&&(w.g=h+"."+w.g),xc(w,w.s);else{var M=a.location;w=M.protocol,h=h?h+"."+M.hostname:M.hostname,M=+M.port;var F=new Hs(null);w&&Sc(F,w),h&&(F.g=h),M&&xc(F,M),p&&(F.l=p),w=F}return p=l.D,h=l.ya,p&&h&&De(w,p,h),De(w,"VER",l.la),Sa(l,w),w}function Qy(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new He(new Ac({eb:p})):new He(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yy(){}t=Yy.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Dc(){}Dc.prototype.g=function(l,h){return new Zt(l,h)};function Zt(l,h){it.call(this),this.g=new Fy(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!v(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Hi(this)}A(Zt,it),Zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zt.prototype.close=function(){zh(this.g)},Zt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=G(l),l=p);h.i.push(new E1(h.Ya++,l)),h.G==3&&Rc(h)},Zt.prototype.N=function(){this.g.l=null,delete this.j,zh(this.g),delete this.g,Zt.aa.N.call(this)};function Xy(l){zs.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}A(Xy,zs);function Jy(){Bi.call(this),this.status=1}A(Jy,Bi);function Hi(l){this.g=l}A(Hi,Yy),Hi.prototype.ua=function(){ft(this.g,"a")},Hi.prototype.ta=function(l){ft(this.g,new Xy(l))},Hi.prototype.sa=function(l){ft(this.g,new Jy)},Hi.prototype.ra=function(){ft(this.g,"b")},Dc.prototype.createWebChannel=Dc.prototype.g,Zt.prototype.send=Zt.prototype.o,Zt.prototype.open=Zt.prototype.m,Zt.prototype.close=Zt.prototype.close,ZI=function(){return new Dc},JI=function(){return Fn()},XI=Ln,zm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},or.NO_ERROR=0,or.TIMEOUT=8,or.HTTP_ERROR=6,xu=or,Fr.COMPLETE="complete",YI=Fr,mt.EventType=Ue,Ue.OPEN="a",Ue.CLOSE="b",Ue.ERROR="c",Ue.MESSAGE="d",it.prototype.listen=it.prototype.K,qa=mt,He.prototype.listenOnce=He.prototype.L,He.prototype.getLastError=He.prototype.Ka,He.prototype.getLastErrorCode=He.prototype.Ba,He.prototype.getStatus=He.prototype.Z,He.prototype.getResponseJson=He.prototype.Oa,He.prototype.getResponseText=He.prototype.oa,He.prototype.send=He.prototype.ea,He.prototype.setWithCredentials=He.prototype.Ha,QI=He}).apply(typeof Zc<"u"?Zc:typeof self<"u"?self:typeof window<"u"?window:{});const G_="@firebase/firestore",H_="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vt.UNAUTHENTICATED=new vt(null),vt.GOOGLE_CREDENTIALS=new vt("google-credentials-uid"),vt.FIRST_PARTY=new vt("first-party-uid"),vt.MOCK_USER=new vt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let la="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki=new gg("@firebase/firestore");function ro(){return ki.logLevel}function $(t,...e){if(ki.logLevel<=pe.DEBUG){const n=e.map(Pg);ki.debug(`Firestore (${la}): ${t}`,...n)}}function Ft(t,...e){if(ki.logLevel<=pe.ERROR){const n=e.map(Pg);ki.error(`Firestore (${la}): ${t}`,...n)}}function Ai(t,...e){if(ki.logLevel<=pe.WARN){const n=e.map(Pg);ki.warn(`Firestore (${la}): ${t}`,...n)}}function Pg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,eS(t,r,n)}function eS(t,e,n){let r=`FIRESTORE (${la}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ft(r),new Error(r)}function te(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||eS(e,s,r)}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends Rr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(vt.UNAUTHENTICATED))}shutdown(){}}class uD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class dD{constructor(e){this.t=e,this.currentUser=vt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){te(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new rr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new rr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{$("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):($("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new rr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?($("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new tS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new vt(e)}}class hD{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=vt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class fD{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new hD(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(vt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class K_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class mD{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,nn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){te(this.o===void 0,3512);const r=i=>{i.error!=null&&$("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,$("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{$("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):$("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new K_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(te(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new K_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=pD(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function oe(t,e){return t<e?-1:t>e?1:0}function $m(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return oe(r,s);{const i=nS(),o=gD(i.encode(Q_(t,n)),i.encode(Q_(e,n)));return o!==0?o:oe(r,s)}}n+=r>65535?2:1}return oe(t.length,e.length)}function Q_(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function gD(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return oe(t[n],e[n]);return oe(t.length,e.length)}function Uo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function sS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=-62135596800,X_=1e6;class qe{static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*X_);return new qe(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new K(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new K(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Y_)throw new K(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/X_}_compareTo(e){return this.seconds===e.seconds?oe(this.nanoseconds,e.nanoseconds):oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Y_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{static fromTimestamp(e){return new re(e)}static min(){return new re(new qe(0,0))}static max(){return new re(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_="__name__";class qn{constructor(e,n,r){n===void 0?n=0:n>e.length&&X(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&X(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return qn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof qn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=qn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return oe(e.length,n.length)}static compareSegments(e,n){const r=qn.isNumericId(e),s=qn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?qn.extractNumericId(e).compare(qn.extractNumericId(n)):$m(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ts.fromString(e.substring(4,e.length-2))}}class Se extends qn{construct(e,n,r){return new Se(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new K(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Se(n)}static emptyPath(){return new Se([])}}const yD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ze extends qn{construct(e,n,r){return new ze(e,n,r)}static isValidIdentifier(e){return yD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ze.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===J_}static keyField(){return new ze([J_])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new K(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new K(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new K(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new K(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ze(n)}static emptyPath(){return new ze([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.path=e}static fromPath(e){return new Q(Se.fromString(e))}static fromName(e){return new Q(Se.fromString(e).popFirst(5))}static empty(){return new Q(Se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Se.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Q(new Se(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml=-1;class vd{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Wm(t){return t.fields.find(e=>e.kind===2)}function Zs(t){return t.fields.filter(e=>e.kind!==2)}vd.UNKNOWN_ID=-1;class ku{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ll{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ll(0,cn.min())}}function vD(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=re.fromTimestamp(r===1e9?new qe(n+1,0):new qe(n,r));return new cn(s,Q.empty(),e)}function iS(t){return new cn(t.readTime,t.key,Ml)}class cn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new cn(re.min(),Q.empty(),Ml)}static max(){return new cn(re.max(),Q.empty(),Ml)}}function Ng(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Q.comparator(t.documentKey,e.documentKey),n!==0?n:oe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class aS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Li(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==oS)throw t;$("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&X(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new O((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(f=>{o[d]=f,++a,a===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new O((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn="SimpleDb";class lh{static open(e,n,r,s){try{return new lh(n,e.transaction(s,r))}catch(i){throw new al(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new rr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new al(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Cg(r.target.error);this.S.reject(new al(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||($(tn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new wD(n)}}class Is{static delete(e){return $(tn,"Removing database:",e),ti(YT().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!sI())return!1;if(Is.F())return!0;const e=lt(),n=Is.M(e),r=0<n&&n<10,s=lS(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.B=r,this.L=null,Is.M(lt())===12.2&&Ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||($(tn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new al(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new K(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new K(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new al(e,o))},s.onupgradeneeded=i=>{$(tn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;if(this.L!==null&&this.L!==i.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${i.oldVersion}, event.newVersion=${i.newVersion}, db.version=${o.version}`);this.B.q(o,s.transaction,i.oldVersion,this.version).next(()=>{$(tn,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",n=>{const r=n.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=n=>this.$(n)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const a=lh.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(d=>(a.v(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return c.catch(()=>{}),await a.D,c}catch(a){const c=a,d=c.name!=="FirebaseError"&&o<3;if($(tn,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function lS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class _D{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return ti(this.K.delete())}}class al extends K{constructor(e,n){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ls(t){return t.name==="IndexedDbTransactionError"}class wD{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?($(tn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):($(tn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ti(r)}add(e){return $(tn,"ADD",this.store.name,e,e),ti(this.store.add(e))}get(e){return ti(this.store.get(e)).next(n=>(n===void 0&&(n=null),$(tn,"GET",this.store.name,e,n),n))}delete(e){return $(tn,"DELETE",this.store.name,e),ti(this.store.delete(e))}count(){return $(tn,"COUNT",this.store.name),ti(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new O((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.Y(i,(a,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){$(tn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.ee=!1;const s=this.cursor(r);return this.Y(s,(i,o,a)=>a.delete())}te(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.Y(s,n)}ne(e){const n=this.cursor({});return new O((r,s)=>{n.onerror=i=>{const o=Cg(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}Y(e,n){const r=[];return new O((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new _D(a),d=n(a.primaryKey,a.value,c);if(d instanceof O){const f=d.catch(m=>(c.done(),O.reject(m)));r.push(f)}c.isDone?s():c.j===null?a.continue():a.continue(c.j)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ti(t){return new O((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Cg(r.target.error);n(s)}})}let Z_=!1;function Cg(t){const e=Is.M(lt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new K("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Z_||(Z_=!0,setTimeout(()=>{throw r},0)),r}}return t}const ll="IndexBackfiller";class ED{constructor(e,n){this.asyncQueue=e,this.re=n,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){$(ll,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.re.se();$(ll,`Documents written: ${n}`)}catch(n){Ls(n)?$(ll,"Ignoring IndexedDB error during index backfill: ",n):await Li(n)}await this.ie(6e4)})}}class TD{constructor(e,n){this.localStore=e,this.persistence=n}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.oe(n,e))}oe(e,n){const r=new Set;let s=n,i=!0;return O.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return $(ll,`Processing collection: ${o}`),this._e(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}_e(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(s,i)).next(a=>($(ll,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ae(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=iS(i);Ng(o,r)>0&&(r=o)}),new cn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}_n.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi=-1;function ch(t){return t==null}function Fl(t){return t===0&&1/t==-1/0}function ID(t){return typeof t=="number"&&Number.isInteger(t)&&!Fl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _d="";function jt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ew(e)),e=SD(t.get(n),e);return ew(e)}function SD(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case _d:n+="";break;default:n+=i}}return n}function ew(t){return t+_d+""}function Hn(t){const e=t.length;if(te(e>=2,64408,{path:t}),e===2)return te(t.charAt(0)===_d&&t.charAt(1)==="",56145,{path:t}),Se.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(_d,i);switch((o<0||o>n)&&X(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:X(61167,{path:t})}i=o+2}return new Se(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei="remoteDocuments",cc="owner",Xi="owner",Ul="mutationQueues",xD="userId",Rn="mutations",tw="batchId",ui="userMutationsIndex",nw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(t,e){return[t,jt(e)]}function cS(t,e,n){return[t,jt(e),n]}const kD={},Bo="documentMutations",wd="remoteDocumentsV14",AD=["prefixPath","collectionGroup","readTime","documentId"],Pu="documentKeyIndex",PD=["prefixPath","collectionGroup","documentId"],uS="collectionGroupIndex",ND=["collectionGroup","readTime","prefixPath","documentId"],Bl="remoteDocumentGlobal",qm="remoteDocumentGlobalKey",zo="targets",dS="queryTargetsIndex",CD=["canonicalId","targetId"],$o="targetDocuments",RD=["targetId","path"],Rg="documentTargetsIndex",bD=["path","targetId"],Ed="targetGlobalKey",pi="targetGlobal",zl="collectionParents",DD=["collectionId","parent"],Wo="clientMetadata",jD="clientId",uh="bundles",VD="bundleId",dh="namedQueries",OD="name",bg="indexConfiguration",MD="indexId",Gm="collectionGroupIndex",LD="collectionGroup",cl="indexState",FD=["indexId","uid"],hS="sequenceNumberIndex",UD=["uid","sequenceNumber"],ul="indexEntries",BD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],fS="documentKeyIndex",zD=["indexId","uid","orderedDocumentKey"],hh="documentOverlays",$D=["userId","collectionPath","documentId"],Hm="collectionPathOverlayIndex",WD=["userId","collectionPath","largestBatchId"],mS="collectionGroupOverlayIndex",qD=["userId","collectionGroup","largestBatchId"],Dg="globals",GD="name",pS=[Ul,Rn,Bo,ei,zo,cc,pi,$o,Wo,Bl,zl,uh,dh],HD=[...pS,hh],gS=[Ul,Rn,Bo,wd,zo,cc,pi,$o,Wo,Bl,zl,uh,dh,hh],yS=gS,jg=[...yS,bg,cl,ul],KD=jg,vS=[...jg,Dg],QD=vS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km extends aS{constructor(e,n){super(),this.he=e,this.currentSequenceNumber=n}}function ct(t,e){const n=ce(t);return Is.N(n.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _S(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e,n){this.comparator=e,this.root=n||_t.EMPTY}insert(e,n){return new Le(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(e){return new Le(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eu(this.root,e,this.comparator,!1)}getReverseIterator(){return new eu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eu(this.root,e,this.comparator,!0)}}class eu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _t{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??_t.RED,this.left=s??_t.EMPTY,this.right=i??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new _t(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return _t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw X(43730,{key:this.key,value:this.value});if(this.right.isRed())throw X(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw X(27949);return e+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw X(57766)}get value(){throw X(16141)}get color(){throw X(16727)}get left(){throw X(29726)}get right(){throw X(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new _t(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new sw(this.data.getIterator())}getIteratorFrom(e){return new sw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ae)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ae(this.comparator);return n.data=e,n}}class sw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ji(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new Ht([])}unionWith(e){let n=new Ae(ze.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ht(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Uo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new wS("Invalid base64 string: "+i):i}}(e);return new st(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new st(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}st.EMPTY_BYTE_STRING=new st("");const YD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kr(t){if(te(!!t,39018),typeof t=="string"){let e=0;const n=YD.exec(t);if(te(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Oe(t.seconds),nanos:Oe(t.nanos)}}function Oe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ar(t){return typeof t=="string"?st.fromBase64String(t):st.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES="server_timestamp",TS="__type__",IS="__previous_value__",SS="__local_write_time__";function Vg(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[TS])===null||n===void 0?void 0:n.stringValue)===ES}function fh(t){const e=t.mapValue.fields[IS];return Vg(e)?fh(e):e}function $l(t){const e=kr(t.mapValue.fields[SS].timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,n,r,s,i,o,a,c,d,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=f}}const Td="(default)";class Pi{constructor(e,n){this.projectId=e,this.database=n||Td}static empty(){return new Pi("","")}get isDefaultDatabase(){return this.database===Td}isEqual(e){return e instanceof Pi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Og="__type__",xS="__max__",us={mapValue:{fields:{__type__:{stringValue:xS}}}},Mg="__vector__",qo="value",Nu={nullValue:"NULL_VALUE"};function Ns(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vg(t)?4:kS(t)?9007199254740991:mh(t)?10:11:X(28295,{value:t})}function sr(t,e){if(t===e)return!0;const n=Ns(t);if(n!==Ns(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $l(t).isEqual($l(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=kr(s.timestampValue),a=kr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ar(s.bytesValue).isEqual(Ar(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Oe(s.geoPointValue.latitude)===Oe(i.geoPointValue.latitude)&&Oe(s.geoPointValue.longitude)===Oe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Oe(s.integerValue)===Oe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Oe(s.doubleValue),a=Oe(i.doubleValue);return o===a?Fl(o)===Fl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Uo(t.arrayValue.values||[],e.arrayValue.values||[],sr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(rw(o)!==rw(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!sr(o[c],a[c])))return!1;return!0}(t,e);default:return X(52216,{left:t})}}function Wl(t,e){return(t.values||[]).find(n=>sr(n,e))!==void 0}function Cs(t,e){if(t===e)return 0;const n=Ns(t),r=Ns(e);if(n!==r)return oe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return oe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Oe(i.integerValue||i.doubleValue),c=Oe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return iw(t.timestampValue,e.timestampValue);case 4:return iw($l(t),$l(e));case 5:return $m(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Ar(i),c=Ar(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const f=oe(a[d],c[d]);if(f!==0)return f}return oe(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=oe(Oe(i.latitude),Oe(o.latitude));return a!==0?a:oe(Oe(i.longitude),Oe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ow(t.arrayValue,e.arrayValue);case 10:return function(i,o){var a,c,d,f;const m=i.fields||{},g=o.fields||{},x=(a=m[qo])===null||a===void 0?void 0:a.arrayValue,A=(c=g[qo])===null||c===void 0?void 0:c.arrayValue,N=oe(((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0,((f=A==null?void 0:A.values)===null||f===void 0?void 0:f.length)||0);return N!==0?N:ow(x,A)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===us.mapValue&&o===us.mapValue)return 0;if(i===us.mapValue)return 1;if(o===us.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),d=o.fields||{},f=Object.keys(d);c.sort(),f.sort();for(let m=0;m<c.length&&m<f.length;++m){const g=$m(c[m],f[m]);if(g!==0)return g;const x=Cs(a[c[m]],d[f[m]]);if(x!==0)return x}return oe(c.length,f.length)}(t.mapValue,e.mapValue);default:throw X(23264,{Pe:n})}}function iw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return oe(t,e);const n=kr(t),r=kr(e),s=oe(n.seconds,r.seconds);return s!==0?s:oe(n.nanos,r.nanos)}function ow(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Cs(n[s],r[s]);if(i)return i}return oe(n.length,r.length)}function Go(t){return Qm(t)}function Qm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=kr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ar(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Q.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Qm(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Qm(n.fields[o])}`;return s+"}"}(t.mapValue):X(61005,{value:t})}function Cu(t){switch(Ns(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=fh(t);return e?16+Cu(e):16;case 5:return 2*t.stringValue.length;case 6:return Ar(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Cu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Fs(r.fields,(i,o)=>{s+=i.length+Cu(o)}),s}(t.mapValue);default:throw X(13486,{value:t})}}function ql(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ym(t){return!!t&&"integerValue"in t}function Gl(t){return!!t&&"arrayValue"in t}function aw(t){return!!t&&"nullValue"in t}function lw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ru(t){return!!t&&"mapValue"in t}function mh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Og])===null||n===void 0?void 0:n.stringValue)===Mg}function dl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Fs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=dl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=dl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function kS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===xS}const AS={mapValue:{fields:{[Og]:{stringValue:Mg},[qo]:{arrayValue:{}}}}};function JD(t){return"nullValue"in t?Nu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ql(Pi.empty(),Q.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?mh(t)?AS:{mapValue:{}}:X(35942,{value:t})}function ZD(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ql(Pi.empty(),Q.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?AS:"mapValue"in t?mh(t)?{mapValue:{}}:us:X(61959,{value:t})}function cw(t,e){const n=Cs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function uw(t,e){const n=Cs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.value=e}static empty(){return new bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ru(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=dl(n)}setAll(e){let n=ze.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=dl(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Ru(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return sr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ru(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Fs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new bt(dl(this.value))}}function PS(t){const e=[];return Fs(t.fields,(n,r)=>{const s=new ze([n]);if(Ru(r)){const i=PS(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ht(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Qe(e,0,re.min(),re.min(),re.min(),bt.empty(),0)}static newFoundDocument(e,n,r,s){return new Qe(e,1,n,re.min(),r,s,0)}static newNoDocument(e,n){return new Qe(e,2,n,re.min(),re.min(),bt.empty(),0)}static newUnknownDocument(e,n){return new Qe(e,3,n,re.min(),re.min(),bt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e,n){this.position=e,this.inclusive=n}}function dw(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Q.comparator(Q.fromName(o.referenceValue),n.key):r=Cs(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function hw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!sr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n="asc"){this.field=e,this.dir=n}}function ej(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{}class ge extends NS{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new tj(e,n,r):n==="array-contains"?new sj(e,r):n==="in"?new VS(e,r):n==="not-in"?new ij(e,r):n==="array-contains-any"?new oj(e,r):new ge(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new nj(e,r):new rj(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Cs(n,this.value)):n!==null&&Ns(this.value)===Ns(n)&&this.matchesComparison(Cs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xe extends NS{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new xe(e,n)}matches(e){return Ko(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Ko(t){return t.op==="and"}function Xm(t){return t.op==="or"}function Lg(t){return CS(t)&&Ko(t)}function CS(t){for(const e of t.filters)if(e instanceof xe)return!1;return!0}function Jm(t){if(t instanceof ge)return t.field.canonicalString()+t.op.toString()+Go(t.value);if(Lg(t))return t.filters.map(e=>Jm(e)).join(",");{const e=t.filters.map(n=>Jm(n)).join(",");return`${t.op}(${e})`}}function RS(t,e){return t instanceof ge?function(r,s){return s instanceof ge&&r.op===s.op&&r.field.isEqual(s.field)&&sr(r.value,s.value)}(t,e):t instanceof xe?function(r,s){return s instanceof xe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&RS(o,s.filters[a]),!0):!1}(t,e):void X(19439)}function bS(t,e){const n=t.filters.concat(e);return xe.create(n,t.op)}function DS(t){return t instanceof ge?function(n){return`${n.field.canonicalString()} ${n.op} ${Go(n.value)}`}(t):t instanceof xe?function(n){return n.op.toString()+" {"+n.getFilters().map(DS).join(" ,")+"}"}(t):"Filter"}class tj extends ge{constructor(e,n,r){super(e,n,r),this.key=Q.fromName(r.referenceValue)}matches(e){const n=Q.comparator(e.key,this.key);return this.matchesComparison(n)}}class nj extends ge{constructor(e,n){super(e,"in",n),this.keys=jS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class rj extends ge{constructor(e,n){super(e,"not-in",n),this.keys=jS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function jS(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Q.fromName(r.referenceValue))}class sj extends ge{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Gl(n)&&Wl(n.arrayValue,this.value)}}class VS extends ge{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Wl(this.value.arrayValue,n)}}class ij extends ge{constructor(e,n){super(e,"not-in",n)}matches(e){if(Wl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Wl(this.value.arrayValue,n)}}class oj extends ge{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Gl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Wl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Ie=null}}function Zm(t,e=null,n=[],r=[],s=null,i=null,o=null){return new aj(t,e,n,r,s,i,o)}function Ni(t){const e=ce(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Jm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ch(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Go(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Go(r)).join(",")),e.Ie=n}return e.Ie}function uc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ej(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!RS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hw(t.startAt,e.startAt)&&hw(t.endAt,e.endAt)}function Id(t){return Q.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Sd(t,e){return t.filters.filter(n=>n instanceof ge&&n.field.isEqual(e))}function fw(t,e,n){let r=Nu,s=!0;for(const i of Sd(t,e)){let o=Nu,a=!0;switch(i.op){case"<":case"<=":o=JD(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Nu}cw({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];cw({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function mw(t,e,n){let r=us,s=!0;for(const i of Sd(t,e)){let o=us,a=!0;switch(i.op){case">=":case">":o=ZD(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=us}uw({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];uw({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function lj(t,e,n,r,s,i,o,a){return new ca(t,e,n,r,s,i,o,a)}function ph(t){return new ca(t)}function pw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function OS(t){return t.collectionGroup!==null}function hl(t){const e=ce(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ae(ze.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new Hl(i,r))}),n.has(ze.keyField().canonicalString())||e.Ee.push(new Hl(ze.keyField(),r))}return e.Ee}function En(t){const e=ce(t);return e.de||(e.de=cj(e,hl(t))),e.de}function cj(t,e){if(t.limitType==="F")return Zm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Hl(s.field,i)});const n=t.endAt?new Ho(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ho(t.startAt.position,t.startAt.inclusive):null;return Zm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ep(t,e){const n=t.filters.concat([e]);return new ca(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function tp(t,e,n){return new ca(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gh(t,e){return uc(En(t),En(e))&&t.limitType===e.limitType}function MS(t){return`${Ni(En(t))}|lt:${t.limitType}`}function so(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>DS(s)).join(", ")}]`),ch(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Go(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Go(s)).join(",")),`Target(${r})`}(En(t))}; limitType=${t.limitType})`}function dc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Q.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of hl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const d=dw(o,a,c);return o.inclusive?d<=0:d<0}(r.startAt,hl(r),s)||r.endAt&&!function(o,a,c){const d=dw(o,a,c);return o.inclusive?d>=0:d>0}(r.endAt,hl(r),s))}(t,e)}function uj(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function LS(t){return(e,n)=>{let r=!1;for(const s of hl(t)){const i=dj(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function dj(t,e,n){const r=t.field.isKeyField()?Q.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),d=a.data.field(i);return c!==null&&d!==null?Cs(c,d):X(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return X(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Fs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return _S(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=new Le(Q.comparator);function on(){return hj}const FS=new Le(Q.comparator);function Ga(...t){let e=FS;for(const n of t)e=e.insert(n.key,n);return e}function US(t){let e=FS;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Kn(){return fl()}function BS(){return fl()}function fl(){return new br(t=>t.toString(),(t,e)=>t.isEqual(e))}const fj=new Le(Q.comparator),mj=new Ae(Q.comparator);function de(...t){let e=mj;for(const n of t)e=e.add(n);return e}const pj=new Ae(oe);function gj(){return pj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fl(e)?"-0":e}}function zS(t){return{integerValue:""+t}}function yj(t,e){return ID(e)?zS(e):Fg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(){this._=void 0}}function vj(t,e,n){return t instanceof Kl?function(s,i){const o={fields:{[TS]:{stringValue:ES},[SS]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Vg(i)&&(i=fh(i)),i&&(o.fields[IS]=i),{mapValue:o}}(n,e):t instanceof Qo?WS(t,e):t instanceof Yo?qS(t,e):function(s,i){const o=$S(s,i),a=gw(o)+gw(s.Re);return Ym(o)&&Ym(s.Re)?zS(a):Fg(s.serializer,a)}(t,e)}function _j(t,e,n){return t instanceof Qo?WS(t,e):t instanceof Yo?qS(t,e):n}function $S(t,e){return t instanceof Ql?function(r){return Ym(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Kl extends yh{}class Qo extends yh{constructor(e){super(),this.elements=e}}function WS(t,e){const n=GS(e);for(const r of t.elements)n.some(s=>sr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Yo extends yh{constructor(e){super(),this.elements=e}}function qS(t,e){let n=GS(e);for(const r of t.elements)n=n.filter(s=>!sr(s,r));return{arrayValue:{values:n}}}class Ql extends yh{constructor(e,n){super(),this.serializer=e,this.Re=n}}function gw(t){return Oe(t.integerValue||t.doubleValue)}function GS(t){return Gl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e,n){this.field=e,this.transform=n}}function Ej(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Qo&&s instanceof Qo||r instanceof Yo&&s instanceof Yo?Uo(r.elements,s.elements,sr):r instanceof Ql&&s instanceof Ql?sr(r.Re,s.Re):r instanceof Kl&&s instanceof Kl}(t.transform,e.transform)}class Tj{constructor(e,n){this.version=e,this.transformResults=n}}class Dt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Dt}static exists(e){return new Dt(void 0,e)}static updateTime(e){return new Dt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vh{}function HS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _h(t.key,Dt.none()):new ua(t.key,t.data,Dt.none());{const n=t.data,r=bt.empty();let s=new Ae(ze.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Dr(t.key,r,new Ht(s.toArray()),Dt.none())}}function Ij(t,e,n){t instanceof ua?function(s,i,o){const a=s.value.clone(),c=vw(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Dr?function(s,i,o){if(!bu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=vw(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(KS(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ml(t,e,n,r){return t instanceof ua?function(i,o,a,c){if(!bu(i.precondition,o))return a;const d=i.value.clone(),f=_w(i.fieldTransforms,c,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Dr?function(i,o,a,c){if(!bu(i.precondition,o))return a;const d=_w(i.fieldTransforms,c,o),f=o.data;return f.setAll(KS(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,a){return bu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function Sj(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=$S(r.transform,s||null);i!=null&&(n===null&&(n=bt.empty()),n.set(r.field,i))}return n||null}function yw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Uo(r,s,(i,o)=>Ej(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ua extends vh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Dr extends vh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function KS(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function vw(t,e,n){const r=new Map;te(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,_j(o,a,n[s]))}return r}function _w(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,vj(i,o,e))}return r}class _h extends vh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class QS extends vh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Ij(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ml(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ml(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=BS();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=HS(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),de())}isEqual(e){return this.batchId===e.batchId&&Uo(this.mutations,e.mutations,(n,r)=>yw(n,r))&&Uo(this.baseMutations,e.baseMutations,(n,r)=>yw(n,r))}}class Bg{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){te(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return fj}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Bg(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et,_e;function kj(t){switch(t){case U.OK:return X(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return X(15467,{code:t})}}function YS(t){if(t===void 0)return Ft("GRPC error has no .code"),U.UNKNOWN;switch(t){case et.OK:return U.OK;case et.CANCELLED:return U.CANCELLED;case et.UNKNOWN:return U.UNKNOWN;case et.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case et.INTERNAL:return U.INTERNAL;case et.UNAVAILABLE:return U.UNAVAILABLE;case et.UNAUTHENTICATED:return U.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case et.NOT_FOUND:return U.NOT_FOUND;case et.ALREADY_EXISTS:return U.ALREADY_EXISTS;case et.PERMISSION_DENIED:return U.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case et.ABORTED:return U.ABORTED;case et.OUT_OF_RANGE:return U.OUT_OF_RANGE;case et.UNIMPLEMENTED:return U.UNIMPLEMENTED;case et.DATA_LOSS:return U.DATA_LOSS;default:return X(39323,{code:t})}}(_e=et||(et={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=new Ts([4294967295,4294967295],0);function ww(t){const e=nS().encode(t),n=new KI;return n.update(e),new Uint8Array(n.digest())}function Ew(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ts([n,r],0),new Ts([s,i],0)]}class $g{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ha(`Invalid padding: ${n}`);if(r<0)throw new Ha(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ha(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ha(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=Ts.fromNumber(this.pe)}we(e,n,r){let s=e.add(n.multiply(Ts.fromNumber(r)));return s.compare(Aj)===1&&(s=new Ts([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=ww(e),[r,s]=Ew(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.be(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new $g(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.pe===0)return;const n=ww(e),[r,s]=Ew(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ha extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,hc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new wh(re.min(),s,new Le(oe),on(),de())}}class hc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new hc(r,n,de(),de(),de())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n,r,s){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=s}}class XS{constructor(e,n){this.targetId=e,this.Ce=n}}class JS{constructor(e,n,r=st.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Tw{constructor(){this.Fe=0,this.Me=Iw(),this.xe=st.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=de(),n=de(),r=de();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:X(38017,{changeType:i})}}),new hc(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=Iw()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,te(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class Pj{constructor(e){this.ze=e,this.je=new Map,this.He=on(),this.Je=tu(),this.Ye=tu(),this.Ze=new Le(oe)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:X(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,s)=>{this.it(s)&&n(s)})}ot(e){const n=e.targetId,r=e.Ce.count,s=this._t(n);if(s){const i=s.target;if(Id(i))if(r===0){const o=new Q(i.path);this.tt(n,o,Qe.newNoDocument(o,re.min()))}else te(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const a=this.ct(e),c=a?this.lt(a,e,o):1;if(c!==0){this.st(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Ar(r).toUint8Array()}catch(c){if(c instanceof wS)return Ai("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new $g(o,s,i)}catch(c){return Ai(c instanceof Ha?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.pe===0?null:a}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.tt(n,i,null),s++)}),s}It(e){const n=new Map;this.je.forEach((i,o)=>{const a=this._t(o);if(a){if(i.current&&Id(a.target)){const c=new Q(a.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,Qe.newNoDocument(c,e))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=de();this.Ye.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const d=this._t(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new wh(e,n,this.Ze,this.He,r);return this.He=on(),this.Je=tu(),this.Ye=tu(),this.Ze=new Le(oe),s}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,n)?s.$e(n,1):s.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new Tw,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new Ae(oe),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new Ae(oe),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||$("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Tw),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function tu(){return new Le(Q.comparator)}function Iw(){return new Le(Q.comparator)}const Nj={asc:"ASCENDING",desc:"DESCENDING"},Cj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Rj={and:"AND",or:"OR"};class bj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function np(t,e){return t.useProto3Json||ch(e)?e:{value:e}}function Xo(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ZS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Dj(t,e){return Xo(t,e.toTimestamp())}function Bt(t){return te(!!t,49232),re.fromTimestamp(function(n){const r=kr(n);return new qe(r.seconds,r.nanos)}(t))}function Wg(t,e){return rp(t,e).canonicalString()}function rp(t,e){const n=function(s){return new Se(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function ex(t){const e=Se.fromString(t);return te(cx(e),10190,{key:e.toString()}),e}function xd(t,e){return Wg(t.databaseId,e.path)}function gi(t,e){const n=ex(e);if(n.get(1)!==t.databaseId.projectId)throw new K(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new K(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Q(rx(n))}function tx(t,e){return Wg(t.databaseId,e)}function nx(t){const e=ex(t);return e.length===4?Se.emptyPath():rx(e)}function sp(t){return new Se(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function rx(t){return te(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Sw(t,e,n){return{name:xd(t,e),fields:n.value.mapValue.fields}}function jj(t,e,n){const r=gi(t,e.name),s=Bt(e.updateTime),i=e.createTime?Bt(e.createTime):re.min(),o=new bt({mapValue:{fields:e.fields}}),a=Qe.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Vj(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:X(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(te(f===void 0||typeof f=="string",58123),st.fromBase64String(f||"")):(te(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),st.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const f=d.code===void 0?U.UNKNOWN:YS(d.code);return new K(f,d.message||"")}(o);n=new JS(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=gi(t,r.document.name),i=Bt(r.document.updateTime),o=r.document.createTime?Bt(r.document.createTime):re.min(),a=new bt({mapValue:{fields:r.document.fields}}),c=Qe.newFoundDocument(s,i,o,a),d=r.targetIds||[],f=r.removedTargetIds||[];n=new Du(d,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=gi(t,r.document),i=r.readTime?Bt(r.readTime):re.min(),o=Qe.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Du([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=gi(t,r.document),i=r.removedTargetIds||[];n=new Du([],i,s,null)}else{if(!("filter"in e))return X(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new xj(s,i),a=r.targetId;n=new XS(a,o)}}return n}function kd(t,e){let n;if(e instanceof ua)n={update:Sw(t,e.key,e.value)};else if(e instanceof _h)n={delete:xd(t,e.key)};else if(e instanceof Dr)n={update:Sw(t,e.key,e.data),updateMask:Bj(e.fieldMask)};else{if(!(e instanceof QS))return X(16599,{ft:e.type});n={verify:xd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Kl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Qo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Yo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ql)return{fieldPath:o.field.canonicalString(),increment:a.Re};throw X(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Dj(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:X(27497)}(t,e.precondition)),n}function ip(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Dt.updateTime(Bt(i.updateTime)):i.exists!==void 0?Dt.exists(i.exists):Dt.none()}(e.currentDocument):Dt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)te(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Kl;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];c=new Qo(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];c=new Yo(f)}else"increment"in a?c=new Ql(o,a.increment):X(16584,{proto:a});const d=ze.fromServerFormat(a.fieldPath);return new wj(d,c)}(t,s)):[];if(e.update){e.update.name;const s=gi(t,e.update.name),i=new bt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new Ht(d.map(f=>ze.fromServerFormat(f)))}(e.updateMask);return new Dr(s,i,o,n,r)}return new ua(s,i,n,r)}if(e.delete){const s=gi(t,e.delete);return new _h(s,n)}if(e.verify){const s=gi(t,e.verify);return new QS(s,n)}return X(1463,{proto:e})}function Oj(t,e){return t&&t.length>0?(te(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Bt(s.updateTime):Bt(i);return o.isEqual(re.min())&&(o=Bt(i)),new Tj(o,s.transformResults||[])}(n,e))):[]}function sx(t,e){return{documents:[tx(t,e.path)]}}function ix(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=tx(t,s);const i=function(d){if(d.length!==0)return lx(xe.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(g){return{field:io(g.field),direction:Lj(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=np(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{gt:n,parent:s}}function ox(t){let e=nx(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){te(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(m){const g=ax(m);return g instanceof xe&&Lg(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(A){return new Hl(oo(A.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,ch(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(m){const g=!!m.before,x=m.values||[];return new Ho(x,g)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const g=!m.before,x=m.values||[];return new Ho(x,g)}(n.endAt)),lj(e,s,o,i,a,"F",c,d)}function Mj(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function ax(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=oo(n.unaryFilter.field);return ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=oo(n.unaryFilter.field);return ge.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=oo(n.unaryFilter.field);return ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=oo(n.unaryFilter.field);return ge.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return X(61313);default:return X(60726)}}(t):t.fieldFilter!==void 0?function(n){return ge.create(oo(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return X(58110);default:return X(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return xe.create(n.compositeFilter.filters.map(r=>ax(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return X(1026)}}(n.compositeFilter.op))}(t):X(30097,{filter:t})}function Lj(t){return Nj[t]}function Fj(t){return Cj[t]}function Uj(t){return Rj[t]}function io(t){return{fieldPath:t.canonicalString()}}function oo(t){return ze.fromServerFormat(t.fieldPath)}function lx(t){return t instanceof ge?function(n){if(n.op==="=="){if(lw(n.value))return{unaryFilter:{field:io(n.field),op:"IS_NAN"}};if(aw(n.value))return{unaryFilter:{field:io(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(lw(n.value))return{unaryFilter:{field:io(n.field),op:"IS_NOT_NAN"}};if(aw(n.value))return{unaryFilter:{field:io(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:io(n.field),op:Fj(n.op),value:n.value}}}(t):t instanceof xe?function(n){const r=n.getFilters().map(s=>lx(s));return r.length===1?r[0]:{compositeFilter:{op:Uj(n.op),filters:r}}}(t):X(54877,{filter:t})}function Bj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function cx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n,r,s,i=re.min(),o=re.min(),a=st.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new gr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(e){this.wt=e}}function zj(t,e){let n;if(e.document)n=jj(t.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Q.fromSegments(e.noDocument.path),s=Ri(e.noDocument.readTime);n=Qe.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return X(56709);{const r=Q.fromSegments(e.unknownDocument.path),s=Ri(e.unknownDocument.version);n=Qe.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new qe(s[0],s[1]);return re.fromTimestamp(i)}(e.readTime)),n}function xw(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ad(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:xd(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Xo(i,o.version.toTimestamp()),createTime:Xo(i,o.createTime.toTimestamp())}}(t.wt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ci(e.version)};else{if(!e.isUnknownDocument())return X(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Ci(e.version)}}return r}function Ad(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ci(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ri(t){const e=new qe(t.seconds,t.nanoseconds);return re.fromTimestamp(e)}function ni(t,e){const n=(e.baseMutations||[]).map(i=>ip(t.wt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>ip(t.wt,i)),s=qe.fromMillis(e.localWriteTimeMs);return new Ug(e.batchId,s,n,r)}function Ka(t){const e=Ri(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ri(t.lastLimboFreeSnapshotVersion):re.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return te(o===1,1966,{count:o}),En(ph(nx(i.documents[0])))}(t.query):function(i){return En(ox(i))}(t.query),new gr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,st.fromBase64String(t.resumeToken))}function dx(t,e){const n=Ci(e.snapshotVersion),r=Ci(e.lastLimboFreeSnapshotVersion);let s;s=Id(e.target)?sx(t.wt,e.target):ix(t.wt,e.target).gt;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ni(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function hx(t){const e=ox({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tp(e,e.limit,"L"):e}function Af(t,e){return new zg(e.largestBatchId,ip(t.wt,e.overlayMutation))}function kw(t,e){const n=e.path.lastSegment();return[t,jt(e.path.popLast()),n]}function Aw(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ci(r.readTime),documentKey:jt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{getBundleMetadata(e,n){return Pw(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Ri(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return Pw(e).put(function(s){return{bundleId:s.id,createTime:Ci(Bt(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return Nw(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:hx(i.bundledQuery),readTime:Ri(i.readTime)}}(r)})}saveNamedQuery(e,n){return Nw(e).put(function(s){return{name:s.name,readTime:Ci(Bt(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function Pw(t){return ct(t,uh)}function Nw(t){return ct(t,dh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,n){this.serializer=e,this.userId=n}static bt(e,n){const r=n.uid||"";return new Eh(e,r)}getOverlay(e,n){return Da(e).get(kw(this.userId,n)).next(r=>r?Af(this.serializer,r):null)}getOverlays(e,n){const r=Kn();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new zg(n,o);s.push(this.St(e,a))}),O.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(jt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Da(e).X(Hm,a))}),O.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Kn(),i=jt(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Da(e).J(Hm,o).next(a=>{for(const c of a){const d=Af(this.serializer,c);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Kn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Da(e).te({index:mS,range:a},(c,d,f)=>{const m=Af(this.serializer,d);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>i)}St(e,n){return Da(e).put(function(s,i,o){const[a,c,d]=kw(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:kd(s.wt,o.mutation)}}(this.serializer,this.userId,n))}}function Da(t){return ct(t,hh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{Dt(e){return ct(e,Dg)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?st.fromUint8Array(r):st.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Dt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(){}vt(e,n){this.Ct(e,n),n.Ft()}Ct(e,n){if("nullValue"in e)this.Mt(n,5);else if("booleanValue"in e)this.Mt(n,10),n.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(n,15),n.xt(Oe(e.integerValue));else if("doubleValue"in e){const r=Oe(e.doubleValue);isNaN(r)?this.Mt(n,13):(this.Mt(n,15),Fl(r)?n.xt(0):n.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(n,20),typeof r=="string"&&(r=kr(r)),n.Ot(`${r.seconds||""}`),n.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,n),this.Bt(n);else if("bytesValue"in e)this.Mt(n,30),n.Lt(Ar(e.bytesValue)),this.Bt(n);else if("referenceValue"in e)this.kt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(n,45),n.xt(r.latitude||0),n.xt(r.longitude||0)}else"mapValue"in e?kS(e)?this.Mt(n,Number.MAX_SAFE_INTEGER):mh(e)?this.qt(e.mapValue,n):(this.Qt(e.mapValue,n),this.Bt(n)):"arrayValue"in e?(this.$t(e.arrayValue,n),this.Bt(n)):X(19022,{Ut:e})}Nt(e,n){this.Mt(n,25),this.Kt(e,n)}Kt(e,n){n.Ot(e)}Qt(e,n){const r=e.fields||{};this.Mt(n,55);for(const s of Object.keys(r))this.Nt(s,n),this.Ct(r[s],n)}qt(e,n){var r,s;const i=e.fields||{};this.Mt(n,53);const o=qo,a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(n,15),n.xt(Oe(a)),this.Nt(o,n),this.Ct(i[o],n)}$t(e,n){const r=e.values||[];this.Mt(n,50);for(const s of r)this.Ct(s,n)}kt(e,n){this.Mt(n,37),Q.fromName(e).path.forEach(r=>{this.Mt(n,60),this.Kt(r,n)})}Mt(e,n){e.xt(n)}Bt(e){e.xt(2)}}ri.Wt=new ri;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=255;function qj(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function Cw(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=qj(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class Gj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.zt(r.value),r=n.next();this.jt()}Ht(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Yt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=n.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const n=this.tn(e),r=Cw(n);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}rn(e){const n=this.tn(e),r=Cw(n);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}sn(){this._n(Zi),this._n(255)}an(){this.un(Zi),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}zt(e){const n=255&e;n===0?(this._n(0),this._n(255)):n===Zi?(this._n(Zi),this._n(0)):this._n(n)}Jt(e){const n=255&e;n===0?(this.un(0),this.un(255)):n===Zi?(this.un(Zi),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Hj{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class Kj{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class ja{constructor(){this.ln=new Gj,this.hn=new Hj(this.ln),this.Pn=new Kj(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n,r,s){this.In=e,this.En=n,this.dn=r,this.An=s}Rn(){const e=this.An.length,n=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.An,0),n!==e?r.set([0],this.An.length):++r[r.length-1],new si(this.In,this.En,this.dn,r)}Vn(e,n,r){return{indexId:this.In,uid:e,arrayValue:ju(this.dn),directionalValue:ju(this.An),orderedDocumentKey:ju(n),documentKey:r.path.toArray()}}mn(e,n,r){const s=this.Vn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Kr(t,e){let n=t.In-e.In;return n!==0?n:(n=Rw(t.dn,e.dn),n!==0?n:(n=Rw(t.An,e.An),n!==0?n:Q.comparator(t.En,e.En)))}function Rw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function ju(t){return rI()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function bw(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class Dw{constructor(e){this.fn=new Ae((n,r)=>ze.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const n of e.filters){const r=n;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(te(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const n=Wm(e);if(n!==void 0&&!this.bn(n))return!1;const r=Zs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.bn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.fn.size>0){const a=this.fn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.Sn(a,c)||!this.Dn(this.gn[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.gn.length||!this.Dn(this.gn[o++],a))return!1}return!0}vn(){if(this.yn)return null;let e=new Ae(ze.comparator);const n=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new ku(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new ku(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new ku(r.field,r.dir==="asc"?0:1)));return new vd(vd.UNKNOWN_ID,this.collectionId,n,Ll.empty())}bn(e){for(const n of this.pn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}Dn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fx(t){var e,n;if(te(t instanceof ge||t instanceof xe,20012),t instanceof ge){if(t instanceof VS){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>ge.create(t.field,"==",i)))||[];return xe.create(s,"or")}return t}const r=t.filters.map(s=>fx(s));return xe.create(r,t.op)}function Qj(t){if(t.getFilters().length===0)return[];const e=lp(fx(t));return te(mx(e),7391),op(e)||ap(e)?[e]:e.getFilters()}function op(t){return t instanceof ge}function ap(t){return t instanceof xe&&Lg(t)}function mx(t){return op(t)||ap(t)||function(n){if(n instanceof xe&&Xm(n)){for(const r of n.getFilters())if(!op(r)&&!ap(r))return!1;return!0}return!1}(t)}function lp(t){if(te(t instanceof ge||t instanceof xe,34018),t instanceof ge)return t;if(t.filters.length===1)return lp(t.filters[0]);const e=t.filters.map(r=>lp(r));let n=xe.create(e,t.op);return n=Pd(n),mx(n)?n:(te(n instanceof xe,64498),te(Ko(n),40251),te(n.filters.length>1,57927),n.filters.reduce((r,s)=>qg(r,s)))}function qg(t,e){let n;return te(t instanceof ge||t instanceof xe,38388),te(e instanceof ge||e instanceof xe,25473),n=t instanceof ge?e instanceof ge?function(s,i){return xe.create([s,i],"and")}(t,e):jw(t,e):e instanceof ge?jw(e,t):function(s,i){if(te(s.filters.length>0&&i.filters.length>0,48005),Ko(s)&&Ko(i))return bS(s,i.getFilters());const o=Xm(s)?s:i,a=Xm(s)?i:s,c=o.filters.map(d=>qg(d,a));return xe.create(c,"or")}(t,e),Pd(n)}function jw(t,e){if(Ko(e))return bS(e,t.getFilters());{const n=e.filters.map(r=>qg(t,r));return xe.create(n,"or")}}function Pd(t){if(te(t instanceof ge||t instanceof xe,11850),t instanceof ge)return t;const e=t.getFilters();if(e.length===1)return Pd(e[0]);if(CS(t))return t;const n=e.map(s=>Pd(s)),r=[];return n.forEach(s=>{s instanceof ge?r.push(s):s instanceof xe&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:xe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(){this.Cn=new Gg}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(cn.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(cn.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class Gg{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ae(Se.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ae(Se.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="IndexedDbIndexManager",nu=new Uint8Array(0);class Xj{constructor(e,n){this.databaseId=n,this.Fn=new Gg,this.Mn=new br(r=>Ni(r),(r,s)=>uc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Fn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Fn.add(n)});const i={collectionId:r,parent:jt(s)};return Ow(e).put(i)}return O.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[sS(n),""],!1,!0);return Ow(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Hn(o.parent))}return r})}addFieldIndex(e,n){const r=Va(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=to(e);return i.next(a=>{o.put(Aw(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Va(e),s=to(e),i=eo(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Va(e),r=eo(e),s=to(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return O.forEach(this.xn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Dw(r).vn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=eo(e);let s=!0;const i=new Map;return O.forEach(this.xn(n),o=>this.On(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=de();const a=[];return O.forEach(i,(c,d)=>{$(Vw,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(c)} to execute ${Ni(n)}`);const f=function(S,D){const L=Wm(D);if(L===void 0)return null;for(const V of Sd(S,L.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null}(d,c),m=function(S,D){const L=new Map;for(const V of Zs(D))for(const _ of Sd(S,V.fieldPath))switch(_.op){case"==":case"in":L.set(V.fieldPath.canonicalString(),_.value);break;case"not-in":case"!=":return L.set(V.fieldPath.canonicalString(),_.value),Array.from(L.values())}return null}(d,c),g=function(S,D){const L=[];let V=!0;for(const _ of Zs(D)){const y=_.kind===0?fw(S,_.fieldPath,S.startAt):mw(S,_.fieldPath,S.startAt);L.push(y.value),V&&(V=y.inclusive)}return new Ho(L,V)}(d,c),x=function(S,D){const L=[];let V=!0;for(const _ of Zs(D)){const y=_.kind===0?mw(S,_.fieldPath,S.endAt):fw(S,_.fieldPath,S.endAt);L.push(y.value),V&&(V=y.inclusive)}return new Ho(L,V)}(d,c),A=this.Nn(c,d,g),N=this.Nn(c,d,x),C=this.Bn(c,d,m),I=this.Ln(c.indexId,f,A,g.inclusive,N,x.inclusive,C);return O.forEach(I,v=>r.Z(v,n.limit).next(S=>{S.forEach(D=>{const L=Q.fromSegments(D.documentKey);o.has(L)||(o=o.add(L),a.push(L))})}))}).next(()=>a)}return O.resolve(null)})}xn(e){let n=this.Mn.get(e);return n||(e.filters.length===0?n=[e]:n=Qj(xe.create(e.filters,"and")).map(r=>Zm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,n),n)}Ln(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),d=c/(n!=null?n.length:1),f=[];for(let m=0;m<c;++m){const g=n?this.kn(n[m/d]):nu,x=this.qn(e,g,r[m%d],s),A=this.Qn(e,g,i[m%d],o),N=a.map(C=>this.qn(e,g,C,!0));f.push(...this.createRange(x,A,N))}return f}qn(e,n,r,s){const i=new si(e,Q.empty(),n,r);return s?i:i.Rn()}Qn(e,n,r,s){const i=new si(e,Q.empty(),n,r);return s?i.Rn():i}On(e,n){const r=new Dw(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.wn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.xn(n);return O.forEach(s,i=>this.On(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let d=new Ae(ze.comparator),f=!1;for(const m of c.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:d=d.add(g.field));for(const m of c.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(f?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}$n(e,n){const r=new ja;for(const s of Zs(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Tn(s.kind);ri.Wt.vt(i,o)}return r.cn()}kn(e){const n=new ja;return ri.Wt.vt(e,n.Tn(0)),n.cn()}Un(e,n){const r=new ja;return ri.Wt.vt(ql(this.databaseId,n),r.Tn(function(i){const o=Zs(i);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Bn(e,n,r){if(r===null)return[];let s=[];s.push(new ja);let i=0;for(const o of Zs(e)){const a=r[i++];for(const c of s)if(this.Kn(n,o.fieldPath)&&Gl(a))s=this.Wn(s,o,a);else{const d=c.Tn(o.kind);ri.Wt.vt(a,d)}}return this.Gn(s)}Nn(e,n,r){return this.Bn(e,n,r.position)}Gn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].cn();return n}Wn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new ja;c.seed(a.cn()),ri.Wt.vt(o,c.Tn(n.kind)),i.push(c)}return i}Kn(e,n){return!!e.filters.find(r=>r instanceof ge&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Va(e),s=to(e);return(n?r.J(Gm,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return O.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(f,m){const g=m?new Ll(m.sequenceNumber,new cn(Ri(m.readTime),new Q(Hn(m.documentKey)),m.largestBatchId)):Ll.empty(),x=f.fields.map(([A,N])=>new ku(ze.fromServerFormat(A),N));return new vd(f.indexId,f.collectionGroup,x,g)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:oe(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Va(e),i=to(e);return this.zn(e).next(o=>s.J(Gm,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,c=>i.put(Aw(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),O.forEach(a,c=>this.jn(e,s,c).next(d=>{const f=this.Hn(i,c);return d.isEqual(f)?O.resolve():this.Jn(e,i,c,d,f)}))))})}Yn(e,n,r,s){return eo(e).put(s.Vn(this.uid,this.Un(r,n.key),n.key))}Zn(e,n,r,s){return eo(e).delete(s.mn(this.uid,this.Un(r,n.key),n.key))}jn(e,n,r){const s=eo(e);let i=new Ae(Kr);return s.te({index:fS,range:IDBKeyRange.only([r.indexId,this.uid,ju(this.Un(r,n))])},(o,a)=>{i=i.add(new si(r.indexId,n,bw(a.arrayValue),bw(a.directionalValue)))}).next(()=>i)}Hn(e,n){let r=new Ae(Kr);const s=this.$n(n,e);if(s==null)return r;const i=Wm(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Gl(o))for(const a of o.arrayValue.values||[])r=r.add(new si(n.indexId,e.key,this.kn(a),s))}else r=r.add(new si(n.indexId,e.key,nu,s));return r}Jn(e,n,r,s,i){$(Vw,"Updating index entries for document '%s'",n.key);const o=[];return function(c,d,f,m,g){const x=c.getIterator(),A=d.getIterator();let N=Ji(x),C=Ji(A);for(;N||C;){let I=!1,v=!1;if(N&&C){const S=f(N,C);S<0?v=!0:S>0&&(I=!0)}else N!=null?v=!0:I=!0;I?(m(C),C=Ji(A)):v?(g(N),N=Ji(x)):(N=Ji(x),C=Ji(A))}}(s,i,Kr,a=>{o.push(this.Yn(e,n,r,a))},a=>{o.push(this.Zn(e,n,r,a))}),O.waitFor(o)}zn(e){let n=1;return to(e).te({index:hS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Kr(o,a)).filter((o,a,c)=>!a||Kr(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Kr(o,e),c=Kr(o,n);if(a===0)s[0]=e.Rn();else if(a>0&&c<0)s.push(o),s.push(o.Rn());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Xn(s[o],s[o+1]))return[];const a=s[o].mn(this.uid,nu,Q.empty()),c=s[o+1].mn(this.uid,nu,Q.empty());i.push(IDBKeyRange.bound(a,c))}return i}Xn(e,n){return Kr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Mw)}getMinOffset(e,n){return O.mapArray(this.xn(n),r=>this.On(e,r).next(s=>s||X(44426))).next(Mw)}}function Ow(t){return ct(t,zl)}function eo(t){return ct(t,ul)}function Va(t){return ct(t,bg)}function to(t){return ct(t,cl)}function Mw(t){te(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Ng(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new cn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},px=41943040;class Nt{static withCacheSize(e){return new Nt(e,Nt.DEFAULT_COLLECTION_PERCENTILE,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(t,e,n){const r=t.store(Rn),s=t.store(Bo),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.te({range:o},(f,m,g)=>(a++,g.delete()));i.push(c.next(()=>{te(a===1,47070,{batchId:n.batchId})}));const d=[];for(const f of n.mutations){const m=cS(e,f.key.path,n.batchId);i.push(s.delete(m)),d.push(f.key)}return O.waitFor(i).next(()=>d)}function Nd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw X(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nt.DEFAULT_COLLECTION_PERCENTILE=10,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nt.DEFAULT=new Nt(px,Nt.DEFAULT_COLLECTION_PERCENTILE,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nt.DISABLED=new Nt(-1,0,0);class Th{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.er={}}static bt(e,n,r,s){te(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Th(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qr(e).te({index:ui,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=ao(e),o=Qr(e);return o.add({}).next(a=>{te(typeof a=="number",49019);const c=new Ug(a,n,r,s),d=function(x,A,N){const C=N.baseMutations.map(v=>kd(x.wt,v)),I=N.mutations.map(v=>kd(x.wt,v));return{userId:A,batchId:N.batchId,localWriteTimeMs:N.localWriteTime.toMillis(),baseMutations:C,mutations:I}}(this.serializer,this.userId,c),f=[];let m=new Ae((g,x)=>oe(g.canonicalString(),x.canonicalString()));for(const g of s){const x=cS(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),f.push(o.put(d)),f.push(i.put(x,kD))}return m.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.er[a]=c.keys()}),O.waitFor(f).next(()=>c)})}lookupMutationBatch(e,n){return Qr(e).get(n).next(r=>r?(te(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),ni(this.serializer,r)):null)}tr(e,n){return this.er[n]?O.resolve(this.er[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.er[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Qr(e).te({index:ui,range:s},(o,a,c)=>{a.userId===this.userId&&(te(a.batchId>=r,47524,{nr:r}),i=ni(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=mi;return Qr(e).te({index:ui,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,mi],[this.userId,Number.POSITIVE_INFINITY]);return Qr(e).J(ui,n).next(r=>r.map(s=>ni(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Au(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return ao(e).te({range:s},(o,a,c)=>{const[d,f,m]=o,g=Hn(f);if(d===this.userId&&n.path.isEqual(g))return Qr(e).get(m).next(x=>{if(!x)throw X(61480,{rr:o,batchId:m});te(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:m}),i.push(ni(this.serializer,x))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ae(oe);const s=[];return n.forEach(i=>{const o=Au(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=ao(e).te({range:a},(d,f,m)=>{const[g,x,A]=d,N=Hn(x);g===this.userId&&i.path.isEqual(N)?r=r.add(A):m.done()});s.push(c)}),O.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Au(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Ae(oe);return ao(e).te({range:o},(c,d,f)=>{const[m,g,x]=c,A=Hn(g);m===this.userId&&r.isPrefixOf(A)?A.length===s&&(a=a.add(x)):f.done()}).next(()=>this.ir(e,a))}ir(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Qr(e).get(i).next(o=>{if(o===null)throw X(35274,{batchId:i});te(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(ni(this.serializer,o))}))}),O.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return gx(e.he,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.sr(n.batchId)}),O.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ao(e).te({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=Hn(i[1]);s.push(c)}else a.done()}).next(()=>{te(s.length===0,56720,{_r:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return yx(e,this.userId,n)}ar(e){return vx(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:mi,lastStreamToken:""})}}function yx(t,e,n){const r=Au(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ao(t).te({range:i,ee:!0},(a,c,d)=>{const[f,m,g]=a;f===e&&m===s&&(o=!0),d.done()}).next(()=>o)}function Qr(t){return ct(t,Rn)}function ao(t){return ct(t,Bo)}function vx(t){return ct(t,Ul)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new bi(0)}static lr(){return new bi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.hr(e).next(n=>{const r=new bi(n.highestTargetId);return n.highestTargetId=r.next(),this.Pr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(n=>re.fromTimestamp(new qe(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pr(e,s)))}addTargetData(e,n){return this.Tr(e,n).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(n,r),this.Pr(e,r))))}updateTargetData(e,n){return this.Tr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>no(e).delete(n.targetId)).next(()=>this.hr(e)).next(r=>(te(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return no(e).te((o,a)=>{const c=Ka(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>O.waitFor(i)).next(()=>s)}forEachTarget(e,n){return no(e).te((r,s)=>{const i=Ka(s);n(i)})}hr(e){return Fw(e).get(Ed).next(n=>(te(n!==null,2888),n))}Pr(e,n){return Fw(e).put(Ed,n)}Tr(e,n){return no(e).put(dx(this.serializer,n))}Ir(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ni(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return no(e).te({range:s,index:dS},(o,a,c)=>{const d=Ka(a);uc(n,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=os(e);return n.forEach(o=>{const a=jt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(s)}removeMatchingKeys(e,n,r){const s=os(e);return O.forEach(n,i=>{const o=jt(i.path);return O.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=os(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=os(e);let i=de();return s.te({range:r,ee:!0},(o,a,c)=>{const d=Hn(o[1]),f=new Q(d);i=i.add(f)}).next(()=>i)}containsKey(e,n){const r=jt(n.path),s=IDBKeyRange.bound([r],[sS(r)],!1,!0);let i=0;return os(e).te({index:Rg,ee:!0,range:s},([o,a],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}Rt(e,n){return no(e).get(n).next(r=>r?Ka(r):null)}}function no(t){return ct(t,zo)}function Fw(t){return ct(t,pi)}function os(t){return ct(t,$o)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="LruGarbageCollector",Zj=1048576;function Bw([t,e],[n,r]){const s=oe(t,n);return s===0?oe(e,r):s}class e2{constructor(e){this.Er=e,this.buffer=new Ae(Bw),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Bw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class _x{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){$(Uw,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ls(n)?$(Uw,"Ignoring IndexedDB error during garbage collection: ",n):await Li(n)}await this.mr(3e5)})}}class t2{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(_n.le);const r=new e2(n);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?($("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(Lw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?($("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lw):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,s,i,o,a,c,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?($("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),ro()<=pe.DEBUG&&$("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${m} documents in `+(d-c)+`ms
Total Duration: ${d-f}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function wx(t,e){return new t2(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n){this.db=e,this.garbageCollector=wx(this,n)}pr(e){const n=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}br(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}yr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return ru(e,r)}removeReference(e,n,r){return ru(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ru(e,n)}Dr(e,n){return function(s,i){let o=!1;return vx(s).ne(a=>yx(s,a,i).next(c=>(c&&(o=!0),O.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const c=this.Dr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,re.min()),os(e).delete(function(m){return[0,jt(m.path)]}(o))))});s.push(c)}}).next(()=>O.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ru(e,n)}Sr(e,n){const r=os(e);let s,i=_n.le;return r.te({index:Rg},([o,a],{path:c,sequenceNumber:d})=>{o===0?(i!==_n.le&&n(new Q(Hn(s)),i),i=d,s=c):i=_n.le}).next(()=>{i!==_n.le&&n(new Q(Hn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ru(t,e){return os(t).put(function(r,s){return{targetId:0,path:jt(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(){this.changes=new br(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Qe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Qs(e).put(r)}removeEntry(e,n,r){return Qs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ad(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.vr(e,r)))}getEntry(e,n){let r=Qe.newInvalidDocument(n);return Qs(e).te({index:Pu,range:IDBKeyRange.only(Oa(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}Fr(e,n){let r={size:0,document:Qe.newInvalidDocument(n)};return Qs(e).te({index:Pu,range:IDBKeyRange.only(Oa(n))},(s,i)=>{r={document:this.Cr(n,i),size:Nd(i)}}).next(()=>r)}getEntries(e,n){let r=on();return this.Mr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Or(e,n){let r=on(),s=new Le(Q.comparator);return this.Mr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,Nd(o))}).next(()=>({documents:r,Nr:s}))}Mr(e,n,r){if(n.isEmpty())return O.resolve();let s=new Ae(Ww);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Oa(s.first()),Oa(s.last())),o=s.getIterator();let a=o.getNext();return Qs(e).te({index:Pu,range:i},(c,d,f)=>{const m=Q.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&Ww(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?f.H(Oa(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Ad(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Qs(e).J(IDBKeyRange.bound(a,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let f=on();for(const m of d){const g=this.Cr(Q.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(dc(n,g)||s.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(e,n,r,s){let i=on();const o=$w(n,r),a=$w(n,cn.max());return Qs(e).te({index:uS,range:IDBKeyRange.bound(o,a,!0)},(c,d,f)=>{const m=this.Cr(Q.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&f.done()}).next(()=>i)}newChangeBuffer(e){return new s2(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return zw(e).get(qm).next(n=>(te(!!n,20021),n))}vr(e,n){return zw(e).put(qm,n)}Cr(e,n){if(n){const r=zj(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(re.min())))return r}return Qe.newInvalidDocument(e)}}function Tx(t){return new r2(t)}class s2 extends Ex{constructor(e,n){super(),this.Br=e,this.trackRemovals=n,this.Lr=new br(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Ae((i,o)=>oe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Lr.get(i);if(n.push(this.Br.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=xw(this.Br.serializer,o);s=s.add(i.path.popLast());const d=Nd(c);r+=d-a.size,n.push(this.Br.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=xw(this.Br.serializer,o.convertToNoDocument(re.min()));n.push(this.Br.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Br.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Br.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Br.Fr(e,n).next(r=>(this.Lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Br.Or(e,n).next(({documents:r,Nr:s})=>(s.forEach((i,o)=>{this.Lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function zw(t){return ct(t,Bl)}function Qs(t){return ct(t,wd)}function Oa(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $w(t,e){const n=e.documentKey.path.toArray();return[t,Ad(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Ww(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=oe(n[i],r[i]),s)return s;return s=oe(n.length,r.length),s||(s=oe(n[n.length-2],r[r.length-2]),s||oe(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ix{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ml(r.mutation,s,Ht.empty(),qe.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,de()).next(()=>r))}getLocalViewOfDocuments(e,n,r=de()){const s=Kn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ga();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Kn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,de()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=on();const o=fl(),a=function(){return fl()}();return n.forEach((c,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Dr)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),ml(f.mutation,d,f.mutation.getFieldMask(),qe.now())):o.set(d.key,Ht.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>{var m;return a.set(d,new i2(f,(m=o.get(d))!==null&&m!==void 0?m:null))}),a))}recalculateAndSaveOverlays(e,n){const r=fl();let s=new Le((o,a)=>o-a),i=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let f=r.get(c)||Ht.empty();f=a.applyToLocalView(d,f),r.set(c,f);const m=(s.get(a.batchId)||de()).add(c);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,f=c.value,m=BS();f.forEach(g=>{if(!i.has(g)){const x=HS(n.get(g),r.get(g));x!==null&&m.set(g,x),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):OS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):O.resolve(Kn());let a=Ml,c=i;return o.next(d=>O.forEach(d,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(f)?O.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{c=c.insert(f,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,de())).next(f=>({batchId:a,changes:US(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Q(n)).next(r=>{let s=Ga();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ga();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,c=>{const d=function(m,g){return new ca(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,Qe.newInvalidDocument(f)))});let a=Ga();return o.forEach((c,d)=>{const f=i.get(c);f!==void 0&&ml(f.mutation,d,Ht.empty(),qe.now()),dc(n,d)&&(a=a.insert(c,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return O.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Bt(s.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(s){return{name:s.name,query:hx(s.bundledQuery),readTime:Bt(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(){this.overlays=new Le(Q.comparator),this.Qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Kn();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const s=Kn(),i=n.length+1,o=new Q(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return O.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Le((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Kn(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const a=Kn(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,f)=>a.set(d,f)),!(a.size()>=s)););return O.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new zg(n,r));let i=this.Qr.get(n);i===void 0&&(i=de(),this.Qr.set(n,i)),this.Qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2{constructor(){this.sessionToken=st.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(){this.$r=new Ae(ut.Ur),this.Kr=new Ae(ut.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new ut(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new ut(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new Q(new Se([])),r=new ut(n,e),s=new ut(n,e+1),i=[];return this.Kr.forEachInRange([r,s],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new Q(new Se([])),r=new ut(n,e),s=new ut(n,e+1);let i=de();return this.Kr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new ut(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ut{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return Q.comparator(e.key,n.key)||oe(e.Zr,n.Zr)}static Wr(e,n){return oe(e.Zr,n.Zr)||Q.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new Ae(ut.Ur)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ug(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Xr=this.Xr.add(new ut(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ti(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?mi:this.nr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ut(n,0),s=new ut(n,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,s],o=>{const a=this.ei(o.Zr);i.push(a)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ae(oe);return n.forEach(s=>{const i=new ut(s,0),o=new ut(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],a=>{r=r.add(a.Zr)})}),O.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Q.isDocumentKey(i)||(i=i.child(""));const o=new ut(new Q(i),0);let a=new Ae(oe);return this.Xr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(c.Zr)),!0)},o),O.resolve(this.ni(a))}ni(e){const n=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){te(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return O.forEach(n.mutations,s=>{const i=new ut(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new ut(n,0),s=this.Xr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(e){this.ii=e,this.docs=function(){return new Le(Q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():Qe.newInvalidDocument(n))}getEntries(e,n){let r=on();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Qe.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=on();const o=n.path,a=new Q(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:f}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Ng(iS(f),r)<=0||(s.has(f.key)||dc(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,n,r,s){X(9500)}si(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new d2(this)}getSize(e){return O.resolve(this.size)}}class d2 extends Ex{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e){this.persistence=e,this.oi=new br(n=>Ni(n),uc),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this._i=0,this.ai=new Hg,this.targetCount=0,this.ui=bi.cr()}forEachTarget(e,n){return this.oi.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),O.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new bi(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Tr(n),O.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.oi.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,n){this.ci={},this.overlays={},this.li=new _n(0),this.hi=!1,this.hi=!0,this.Pi=new l2,this.referenceDelegate=e(this),this.Ti=new h2(this),this.indexManager=new Yj,this.remoteDocumentCache=function(s){return new u2(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new ux(n),this.Ei=new o2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new a2,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new c2(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){$("MemoryPersistence","Starting transaction:",e);const s=new f2(this.li.next());return this.referenceDelegate.di(),r(s).next(i=>this.referenceDelegate.Ai(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ri(e,n){return O.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class f2 extends aS{constructor(e){super(),this.currentSequenceNumber=e}}class Ih{constructor(e){this.persistence=e,this.Vi=new Hg,this.mi=null}static fi(e){return new Ih(e)}get gi(){if(this.mi)return this.mi;throw X(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.gi,r=>{const s=Q.fromPath(r);return this.pi(e,s).next(i=>{i||n.removeEntry(s,re.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return O.or([()=>O.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class Cd{constructor(e,n){this.persistence=e,this.yi=new br(r=>jt(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=wx(this,n)}static fi(e,n){return new Cd(e,n)}di(){}Ai(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}br(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return O.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,re.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),O.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Cu(e.data.value)),n}Dr(e,n,r){return O.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.yi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e){this.serializer=e}q(e,n,r,s){const i=new lh("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(cc)}(e),function(c){c.createObjectStore(Ul,{keyPath:xD}),c.createObjectStore(Rn,{keyPath:tw,autoIncrement:!0}).createIndex(ui,nw,{unique:!0}),c.createObjectStore(Bo)}(e),qw(e),function(c){c.createObjectStore(ei)}(e));let o=O.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore($o),c.deleteObjectStore(zo),c.deleteObjectStore(pi)}(e),qw(e)),o=o.next(()=>function(c){const d=c.store(pi),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return d.put(Ed,f)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,d){return d.store(Rn).J().next(m=>{c.deleteObjectStore(Rn),c.createObjectStore(Rn,{keyPath:tw,autoIncrement:!0}).createIndex(ui,nw,{unique:!0});const g=d.store(Rn),x=m.map(A=>g.put(A));return O.waitFor(x)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(Wo,{keyPath:jD})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.wi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Bl)}(e),this.bi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.Di(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ci(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(uh,{keyPath:VD})})(e),function(c){c.createObjectStore(dh,{keyPath:OD})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore(hh,{keyPath:$D});d.createIndex(Hm,WD,{unique:!1}),d.createIndex(mS,qD,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore(wd,{keyPath:AD});d.createIndex(Pu,PD),d.createIndex(uS,ND)}(e)).next(()=>this.Fi(e,i)).next(()=>e.deleteObjectStore(ei))),r<14&&s>=14&&(o=o.next(()=>this.Mi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(bg,{keyPath:MD,autoIncrement:!0}).createIndex(Gm,LD,{unique:!1}),c.createObjectStore(cl,{keyPath:FD}).createIndex(hS,UD,{unique:!1}),c.createObjectStore(ul,{keyPath:BD}).createIndex(fS,zD,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(cl).clear()}).next(()=>{n.objectStore(ul).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(Dg,{keyPath:GD})})(e)})),r<18&&s>=18&&rI()&&(o=o.next(()=>{n.objectStore(cl).clear()}).next(()=>{n.objectStore(ul).clear()})),o}bi(e){let n=0;return e.store(ei).te((r,s)=>{n+=Nd(s)}).next(()=>{const r={byteSize:n};return e.store(Bl).put(qm,r)})}wi(e){const n=e.store(Ul),r=e.store(Rn);return n.J().next(s=>O.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,mi],[i.userId,i.lastAcknowledgedBatchId]);return r.J(ui,o).next(a=>O.forEach(a,c=>{te(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const d=ni(this.serializer,c);return gx(e,i.userId,d).next(()=>{})}))}))}Si(e){const n=e.store($o),r=e.store(ei);return e.store(pi).get(Ed).next(s=>{const i=[];return r.te((o,a)=>{const c=new Se(o),d=function(m){return[0,jt(m)]}(c);i.push(n.get(d).next(f=>f?O.resolve():(m=>n.put({targetId:0,path:jt(m),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>O.waitFor(i))})}Di(e,n){e.createObjectStore(zl,{keyPath:DD});const r=n.store(zl),s=new Gg,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:jt(c)})}};return n.store(ei).te({ee:!0},(o,a)=>{const c=new Se(o);return i(c.popLast())}).next(()=>n.store(Bo).te({ee:!0},([o,a,c],d)=>{const f=Hn(a);return i(f.popLast())}))}Ci(e){const n=e.store(zo);return n.te((r,s)=>{const i=Ka(s),o=dx(this.serializer,i);return n.put(o)})}Fi(e,n){const r=n.store(ei),s=[];return r.te((i,o)=>{const a=n.store(wd),c=function(m){return m.document?new Q(Se.fromString(m.document.name).popFirst(5)):m.noDocument?Q.fromSegments(m.noDocument.path):m.unknownDocument?Q.fromSegments(m.unknownDocument.path):X(36783)}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>O.waitFor(s))}Mi(e,n){const r=n.store(Rn),s=Tx(this.serializer),i=new Kg(Ih.fi,this.serializer.wt);return r.J().next(o=>{const a=new Map;return o.forEach(c=>{var d;let f=(d=a.get(c.userId))!==null&&d!==void 0?d:de();ni(this.serializer,c).keys().forEach(m=>f=f.add(m)),a.set(c.userId,f)}),O.forEach(a,(c,d)=>{const f=new vt(d),m=Eh.bt(this.serializer,f),g=i.getIndexManager(f),x=Th.bt(f,this.serializer,g,i.referenceDelegate);return new Ix(s,x,m,g).recalculateAndSaveOverlaysForDocumentKeys(new Km(n,_n.le),c).next()})})}}function qw(t){t.createObjectStore($o,{keyPath:RD}).createIndex(Rg,bD,{unique:!0}),t.createObjectStore(zo,{keyPath:"targetId"}).createIndex(dS,CD,{unique:!0}),t.createObjectStore(pi)}const Yr="IndexedDbPersistence",Pf=18e5,Nf=5e3,Cf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",p2="main";class Qg{constructor(e,n,r,s,i,o,a,c,d,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.xi=i,this.window=o,this.document=a,this.Oi=d,this.Ni=f,this.Bi=m,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=g=>Promise.resolve(),!Qg.C())throw new K(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new n2(this,s),this.Ui=n+p2,this.serializer=new ux(c),this.Ki=new Is(this.Ui,this.Bi,new m2(this.serializer)),this.Pi=new Wj,this.Ti=new Jj(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Tx(this.serializer),this.Ei=new $j,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,f===!1&&Ft(Yr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new K(U.FAILED_PRECONDITION,Cf);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new _n(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>su(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(n=>{n||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(n=>this.isPrimary&&!n?this.Xi(e).next(()=>!1):!!n&&this.es(e).next(()=>!0))).catch(e=>{if(Ls(e))return $(Yr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return $(Yr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return Ma(e).get(Xi).next(n=>O.resolve(this.ts(n)))}ns(e){return su(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,Pf)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=ct(n,Wo);return r.J().next(s=>{const i=this._s(s,Pf),o=s.filter(a=>i.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const n of e)this.Wi.removeItem(this.us(n.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?O.resolve(!0):Ma(e).get(Xi).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,Nf)&&!this.cs(n.ownerId)){if(this.ts(n)&&this.networkEnabled)return!0;if(!this.ts(n)){if(!n.allowTabSynchronization)throw new K(U.FAILED_PRECONDITION,Cf);return!1}}return!(!this.networkEnabled||!this.inForeground)||su(e).J().next(r=>this._s(r,Nf).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&$(Yr,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[cc,Wo],e=>{const n=new Km(e,_n.le);return this.Xi(n).next(()=>this.ns(n))}),this.Ki.close(),this.Ts()}_s(e,n){return e.filter(r=>this.ss(r.updateTimeMs,n)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>su(e).J().next(n=>this._s(n,Pf).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,n){return Th.bt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Xj(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Eh.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,n,r){$(Yr,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?QD:c===17?vS:c===16?KD:c===15?jg:c===14?yS:c===13?gS:c===12?HD:c===11?pS:void X(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,s,i,a=>(o=new Km(a,this.li?this.li.next():_n.le),n==="readwrite-primary"?this.Yi(o).next(c=>!!c||this.Zi(o)).next(c=>{if(!c)throw Ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new K(U.FAILED_PRECONDITION,oS);return r(o)}).next(c=>this.es(o).next(()=>c)):this.Es(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Es(e){return Ma(e).get(Xi).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,Nf)&&!this.cs(n.ownerId)&&!this.ts(n)&&!(this.Ni||this.allowTabSynchronization&&n.allowTabSynchronization))throw new K(U.FAILED_PRECONDITION,Cf)})}es(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ma(e).put(Xi,n)}static C(){return Is.C()}Xi(e){const n=Ma(e);return n.get(Xi).next(r=>this.ts(r)?($(Yr,"Releasing primary lease."),n.delete(Xi)):O.resolve())}ss(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ft(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const n=/(?:Version|Mobile)\/1[456]/;nI()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var n;try{const r=((n=this.Wi)===null||n===void 0?void 0:n.getItem(this.us(e)))!==null;return $(Yr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ft(Yr,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Ft("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ma(t){return ct(t,cc)}function su(t){return ct(t,Wo)}function g2(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ds=r,this.As=s}static Rs(e,n){let r=de(),s=de();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Yg(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return nI()?8:lS(lt())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ws(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.bs(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new y2;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.fs)return this.Ds(e,n,o,a.size)})}).next(()=>i.result)}Ds(e,n,r,s){return r.documentReadCount<this.gs?(ro()<=pe.DEBUG&&$("QueryEngine","SDK will not create cache indexes for query:",so(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),O.resolve()):(ro()<=pe.DEBUG&&$("QueryEngine","Query:",so(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(ro()<=pe.DEBUG&&$("QueryEngine","The SDK decides to create cache indexes for query:",so(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,En(n))):O.resolve())}ws(e,n){if(pw(n))return O.resolve(null);let r=En(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=tp(n,null,"F"),r=En(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=de(...i);return this.ys.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.vs(n,a);return this.Cs(n,d,o,c.readTime)?this.ws(e,tp(n,null,"F")):this.Fs(e,d,n,c)}))})))}bs(e,n,r,s){return pw(n)||s.isEqual(re.min())?O.resolve(null):this.ys.getDocuments(e,r).next(i=>{const o=this.vs(n,i);return this.Cs(n,o,r,s)?O.resolve(null):(ro()<=pe.DEBUG&&$("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),so(n)),this.Fs(e,o,n,vD(s,Ml)).next(a=>a))})}vs(e,n){let r=new Ae(LS(e));return n.forEach((s,i)=>{dc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return ro()<=pe.DEBUG&&$("QueryEngine","Using full collection scan to execute query:",so(n)),this.ys.getDocumentsMatchingQuery(e,n,cn.min(),r)}Fs(e,n,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="LocalStore",v2=3e8;class _2{constructor(e,n,r,s){this.persistence=e,this.Ms=n,this.serializer=s,this.xs=new Le(oe),this.Os=new br(i=>Ni(i),uc),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ix(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function xx(t,e,n,r){return new _2(t,e,n,r)}async function kx(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=de();for(const d of s){o.push(d.batchId);for(const f of d.mutations)c=c.add(f.key)}for(const d of i){a.push(d.batchId);for(const f of d.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(d=>({ks:d,removedBatchIds:o,addedBatchIds:a}))})})}function w2(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(a,c,d,f){const m=d.batch,g=m.keys();let x=O.resolve();return g.forEach(A=>{x=x.next(()=>f.getEntry(c,A)).next(N=>{const C=d.docVersions.get(A);te(C!==null,48541),N.version.compareTo(C)<0&&(m.applyToRemoteDocument(N,d),N.isValidDocument()&&(N.setReadTime(d.commitVersion),f.addEntry(N)))})}),x.next(()=>a.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=de();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Ax(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function E2(t,e){const n=ce(t),r=e.snapshotVersion;let s=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.xs;const a=[];e.targetChanges.forEach((f,m)=>{const g=s.get(m);if(!g)return;a.push(n.Ti.removeMatchingKeys(i,f.removedDocuments,m).next(()=>n.Ti.addMatchingKeys(i,f.addedDocuments,m)));let x=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(st.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):f.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(f.resumeToken,r)),s=s.insert(m,x),function(N,C,I){return N.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=v2?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(g,x,f)&&a.push(n.Ti.updateTargetData(i,x))});let c=on(),d=de();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),a.push(T2(i,o,e.documentUpdates).next(f=>{c=f.qs,d=f.Qs})),!r.isEqual(re.min())){const f=n.Ti.getLastRemoteSnapshotVersion(i).next(m=>n.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(f)}return O.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.xs=s,i))}function T2(t,e,n){let r=de(),s=de();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=on();return n.forEach((a,c)=>{const d=i.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(re.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):$(Xg,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{qs:o,Qs:s}})}function I2(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=mi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function S2(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ti.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):n.Ti.allocateTargetId(r).next(o=>(s=new gr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function cp(t,e,n){const r=ce(t),s=r.xs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ls(o))throw o;$(Xg,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function Gw(t,e,n){const r=ce(t);let s=re.min(),i=de();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,f){const m=ce(c),g=m.Os.get(f);return g!==void 0?O.resolve(m.xs.get(g)):m.Ti.getTargetData(d,f)}(r,o,En(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,n?s:re.min(),n?i:de())).next(a=>(x2(r,uj(e),a),{documents:a,$s:i})))}function x2(t,e,n){let r=t.Ns.get(e)||re.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ns.set(e,r)}class Hw{constructor(){this.activeTargetIds=gj()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Px{constructor(){this.xo=new Hw,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Hw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw="ConnectivityMonitor";class Qw{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){$(Kw,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){$(Kw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iu=null;function up(){return iu===null?iu=function(){return 268435456+Math.round(2147483648*Math.random())}():iu++,"0x"+iu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf="RestConnection",A2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class P2{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===Td?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,n,r,s,i){const o=up(),a=this.jo(e,n.toUriEncodedString());$(Rf,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,s,i);const{host:d}=new URL(a),f=Oi(d);return this.Jo(e,a,c,r,f).then(m=>($(Rf,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Ai(Rf,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Yo(e,n,r,s,i,o){return this.zo(e,n,r,s,i)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+la}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}jo(e,n){const r=A2[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pt="WebChannelConnection";class C2 extends P2{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=up();return new Promise((a,c)=>{const d=new QI;d.setWithCredentials(!0),d.listenOnce(YI.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case xu.NO_ERROR:const m=d.getResponseJson();$(Pt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case xu.TIMEOUT:$(Pt,`RPC '${e}' ${o} timed out`),c(new K(U.DEADLINE_EXCEEDED,"Request time out"));break;case xu.HTTP_ERROR:const g=d.getStatus();if($(Pt,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const A=x==null?void 0:x.error;if(A&&A.status&&A.message){const N=function(I){const v=I.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(v)>=0?v:U.UNKNOWN}(A.status);c(new K(N,A.message))}else c(new K(U.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new K(U.UNAVAILABLE,"Connection failed."));break;default:X(9055,{h_:e,streamId:o,P_:d.getLastErrorCode(),T_:d.getLastError()})}}finally{$(Pt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);$(Pt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",f,r,15)})}I_(e,n,r){const s=up(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ZI(),a=JI(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=i.join("");$(Pt,`Creating RPC '${e}' stream ${s}: ${f}`,c);const m=o.createWebChannel(f,c);this.E_(m);let g=!1,x=!1;const A=new N2({Zo:C=>{x?$(Pt,`Not sending because RPC '${e}' stream ${s} is closed:`,C):(g||($(Pt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),$(Pt,`RPC '${e}' stream ${s} sending:`,C),m.send(C))},Xo:()=>m.close()}),N=(C,I,v)=>{C.listen(I,S=>{try{v(S)}catch(D){setTimeout(()=>{throw D},0)}})};return N(m,qa.EventType.OPEN,()=>{x||($(Pt,`RPC '${e}' stream ${s} transport opened.`),A.__())}),N(m,qa.EventType.CLOSE,()=>{x||(x=!0,$(Pt,`RPC '${e}' stream ${s} transport closed`),A.u_(),this.d_(m))}),N(m,qa.EventType.ERROR,C=>{x||(x=!0,Ai(Pt,`RPC '${e}' stream ${s} transport errored. Name:`,C.name,"Message:",C.message),A.u_(new K(U.UNAVAILABLE,"The operation could not be completed")))}),N(m,qa.EventType.MESSAGE,C=>{var I;if(!x){const v=C.data[0];te(!!v,16349);const S=v,D=(S==null?void 0:S.error)||((I=S[0])===null||I===void 0?void 0:I.error);if(D){$(Pt,`RPC '${e}' stream ${s} received error:`,D);const L=D.status;let V=function(E){const T=et[E];if(T!==void 0)return YS(T)}(L),_=D.message;V===void 0&&(V=U.INTERNAL,_="Unknown error status: "+L+" with message "+D.message),x=!0,A.u_(new K(V,_)),m.close()}else $(Pt,`RPC '${e}' stream ${s} received:`,v),A.c_(v)}}),N(a,XI.STAT_EVENT,C=>{C.stat===zm.PROXY?$(Pt,`RPC '${e}' stream ${s} detected buffering proxy`):C.stat===zm.NOPROXY&&$(Pt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.a_()},0),A}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(){return typeof window<"u"?window:null}function Vu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t){return new bj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(e,n,r=1e3,s=1.5,i=6e4){this.xi=e,this.timerId=n,this.A_=r,this.R_=s,this.V_=i,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const n=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),s=Math.max(0,n-r);s>0&&$("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.m_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw="PersistentStream";class Cx{constructor(e,n,r,s,i,o,a,c){this.xi=e,this.S_=r,this.D_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Nx(e,n)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,n){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(Ft(n.toString()),Ft("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),n=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.v_===n&&this.z_(r,s)},r=>{e(()=>{const s=new K(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(s)})})}z_(e,n){const r=this.G_(this.v_);this.stream=this.H_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.j_(s))}),this.stream.onMessage(s=>{r(()=>++this.M_==1?this.J_(s):this.onNext(s))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return $(Yw,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return n=>{this.xi.enqueueAndForget(()=>this.v_===e?n():($(Yw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class b2 extends Cx{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}H_(e,n){return this.connection.I_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const n=Vj(this.serializer,e),r=function(i){if(!("targetChange"in i))return re.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?re.min():o.readTime?Bt(o.readTime):re.min()}(e);return this.listener.Y_(n,r)}Z_(e){const n={};n.database=sp(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=Id(c)?{documents:sx(i,c)}:{query:ix(i,c).gt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=ZS(i,o.resumeToken);const d=np(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(re.min())>0){a.readTime=Xo(i,o.snapshotVersion.toTimestamp());const d=np(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=Mj(this.serializer,e);r&&(n.labels=r),this.Q_(n)}X_(e){const n={};n.database=sp(this.serializer),n.removeTarget=e,this.Q_(n)}}class D2 extends Cx{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,n){return this.connection.I_("Write",e,n)}J_(e){return te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const n=Oj(e.writeResults,e.commitTime),r=Bt(e.commitTime);return this.listener.ra(r,n)}ia(){const e={};e.database=sp(this.serializer),this.Q_(e)}ta(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>kd(this.serializer,r))};this.Q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{}class V2 extends j2{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.sa=!1}oa(){if(this.sa)throw new K(U.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(e,rp(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new K(U.UNKNOWN,i.toString())})}Yo(e,n,r,s,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Yo(e,rp(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K(U.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class O2{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ft(n),this.ua=!1):$("OnlineStateTracker",n)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di="RemoteStore";class M2{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=i,this.Ra.No(o=>{r.enqueueAndForget(async()=>{Fi(this)&&($(Di,"Restarting streams for network reachability change."),await async function(c){const d=ce(c);d.da.add(4),await fc(d),d.Va.set("Unknown"),d.da.delete(4),await xh(d)}(this))})}),this.Va=new O2(r,s)}}async function xh(t){if(Fi(t))for(const e of t.Aa)await e(!0)}async function fc(t){for(const e of t.Aa)await e(!1)}function Rx(t,e){const n=ce(t);n.Ea.has(e.targetId)||(n.Ea.set(e.targetId,e),ty(n)?ey(n):da(n).N_()&&Zg(n,e))}function Jg(t,e){const n=ce(t),r=da(n);n.Ea.delete(e),r.N_()&&bx(n,e),n.Ea.size===0&&(r.N_()?r.k_():Fi(n)&&n.Va.set("Unknown"))}function Zg(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}da(t).Z_(e)}function bx(t,e){t.ma.Ke(e),da(t).X_(e)}function ey(t){t.ma=new Pj({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),da(t).start(),t.Va.ca()}function ty(t){return Fi(t)&&!da(t).O_()&&t.Ea.size>0}function Fi(t){return ce(t).da.size===0}function Dx(t){t.ma=void 0}async function L2(t){t.Va.set("Online")}async function F2(t){t.Ea.forEach((e,n)=>{Zg(t,e)})}async function U2(t,e){Dx(t),ty(t)?(t.Va.Pa(e),ey(t)):t.Va.set("Unknown")}async function B2(t,e,n){if(t.Va.set("Online"),e instanceof JS&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ea.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ea.delete(a),s.ma.removeTarget(a))}(t,e)}catch(r){$(Di,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Rd(t,r)}else if(e instanceof Du?t.ma.Xe(e):e instanceof XS?t.ma.ot(e):t.ma.nt(e),!n.isEqual(re.min()))try{const r=await Ax(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.ma.It(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.Ea.get(d);f&&i.Ea.set(d,f.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const f=i.Ea.get(c);if(!f)return;i.Ea.set(c,f.withResumeToken(st.EMPTY_BYTE_STRING,f.snapshotVersion)),bx(i,c);const m=new gr(f.target,c,d,f.sequenceNumber);Zg(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){$(Di,"Failed to raise snapshot:",r),await Rd(t,r)}}async function Rd(t,e,n){if(!Ls(e))throw e;t.da.add(1),await fc(t),t.Va.set("Offline"),n||(n=()=>Ax(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{$(Di,"Retrying IndexedDB access"),await n(),t.da.delete(1),await xh(t)})}function jx(t,e){return e().catch(n=>Rd(t,n,e))}async function mc(t){const e=ce(t),n=Rs(e);let r=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:mi;for(;z2(e);)try{const s=await I2(e.localStore,r);if(s===null){e.Ia.length===0&&n.k_();break}r=s.batchId,$2(e,s)}catch(s){await Rd(e,s)}Vx(e)&&Ox(e)}function z2(t){return Fi(t)&&t.Ia.length<10}function $2(t,e){t.Ia.push(e);const n=Rs(t);n.N_()&&n.ea&&n.ta(e.mutations)}function Vx(t){return Fi(t)&&!Rs(t).O_()&&t.Ia.length>0}function Ox(t){Rs(t).start()}async function W2(t){Rs(t).ia()}async function q2(t){const e=Rs(t);for(const n of t.Ia)e.ta(n.mutations)}async function G2(t,e,n){const r=t.Ia.shift(),s=Bg.from(r,e,n);await jx(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await mc(t)}async function H2(t,e){e&&Rs(t).ea&&await async function(r,s){if(function(o){return kj(o)&&o!==U.ABORTED}(s.code)){const i=r.Ia.shift();Rs(r).L_(),await jx(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await mc(r)}}(t,e),Vx(t)&&Ox(t)}async function Xw(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),$(Di,"RemoteStore received new credentials");const r=Fi(n);n.da.add(3),await fc(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.da.delete(3),await xh(n)}async function K2(t,e){const n=ce(t);e?(n.da.delete(2),await xh(n)):e||(n.da.add(2),await fc(n),n.Va.set("Unknown"))}function da(t){return t.fa||(t.fa=function(n,r,s){const i=ce(n);return i.oa(),new b2(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:L2.bind(null,t),n_:F2.bind(null,t),i_:U2.bind(null,t),Y_:B2.bind(null,t)}),t.Aa.push(async e=>{e?(t.fa.L_(),ty(t)?ey(t):t.Va.set("Unknown")):(await t.fa.stop(),Dx(t))})),t.fa}function Rs(t){return t.ga||(t.ga=function(n,r,s){const i=ce(n);return i.oa(),new D2(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:W2.bind(null,t),i_:H2.bind(null,t),na:q2.bind(null,t),ra:G2.bind(null,t)}),t.Aa.push(async e=>{e?(t.ga.L_(),await mc(t)):(await t.ga.stop(),t.Ia.length>0&&($(Di,`Stopping write stream with ${t.Ia.length} pending writes`),t.Ia=[]))})),t.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new ny(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ry(t,e){if(Ft("AsyncQueue",`${e}: ${t}`),Ls(t))return new K(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{static emptySet(e){return new Ro(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Q.comparator(n.key,r.key):(n,r)=>Q.comparator(n.key,r.key),this.keyedMap=Ga(),this.sortedSet=new Le(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ro)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ro;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(){this.pa=new Le(Q.comparator)}track(e){const n=e.doc.key,r=this.pa.get(n);r?e.type!==0&&r.type===3?this.pa=this.pa.insert(n,e):e.type===3&&r.type!==1?this.pa=this.pa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.pa=this.pa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.pa=this.pa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.pa=this.pa.remove(n):e.type===1&&r.type===2?this.pa=this.pa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.pa=this.pa.insert(n,{type:2,doc:e.doc}):X(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(n,e)}wa(){const e=[];return this.pa.inorderTraversal((n,r)=>{e.push(r)}),e}}class Jo{constructor(e,n,r,s,i,o,a,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Jo(e,n,Ro.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class Y2{constructor(){this.queries=Zw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ce(n),i=s.queries;s.queries=Zw(),i.forEach((o,a)=>{for(const c of a.Sa)c.onError(r)})})(this,new K(U.ABORTED,"Firestore shutting down"))}}function Zw(){return new br(t=>MS(t),gh)}async function Mx(t,e){const n=ce(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Da()&&e.va()&&(r=2):(i=new Q2,r=e.va()?0:1);try{switch(r){case 0:i.ba=await n.onListen(s,!0);break;case 1:i.ba=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=ry(o,`Initialization of query '${so(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.Fa(n.onlineState),i.ba&&e.Ma(i.ba)&&sy(n)}async function Lx(t,e){const n=ce(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.va()?0:1:!i.Da()&&e.va()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function X2(t,e){const n=ce(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Ma(s)&&(r=!0);o.ba=s}}r&&sy(n)}function J2(t,e,n){const r=ce(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function sy(t){t.Ca.forEach(e=>{e.next()})}var dp,e0;(e0=dp||(dp={})).xa="default",e0.Cache="cache";class Fx{constructor(e,n,r){this.query=e,this.Oa=n,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Jo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Na?this.La(e)&&(this.Oa.next(e),n=!0):this.ka(e,this.onlineState)&&(this.qa(e),n=!0),this.Ba=e,n}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let n=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),n=!0),n}ka(e,n){if(!e.fromCache||!this.va())return!0;const r=n!=="Offline";return(!this.options.Qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}La(e){if(e.docChanges.length>0)return!0;const n=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}qa(e){e=Jo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==dp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e){this.key=e}}class Bx{constructor(e){this.key=e}}class Z2{constructor(e,n){this.query=e,this.Ha=n,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=de(),this.mutatedKeys=de(),this.Za=LS(e),this.Xa=new Ro(this.Za)}get eu(){return this.Ha}tu(e,n){const r=n?n.nu:new Jw,s=n?n.Xa:this.Xa;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const g=s.get(f),x=dc(this.query,m)?m:null,A=!!g&&this.mutatedKeys.has(g.key),N=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let C=!1;g&&x?g.data.isEqual(x.data)?A!==N&&(r.track({type:3,doc:x}),C=!0):this.ru(g,x)||(r.track({type:2,doc:x}),C=!0,(c&&this.Za(x,c)>0||d&&this.Za(x,d)<0)&&(a=!0)):!g&&x?(r.track({type:0,doc:x}),C=!0):g&&!x&&(r.track({type:1,doc:g}),C=!0,(c||d)&&(a=!0)),C&&(x?(o=o.add(x),i=N?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Xa:o,nu:r,Cs:a,mutatedKeys:i}}ru(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const o=e.nu.wa();o.sort((f,m)=>function(x,A){const N=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X(20277,{Vt:C})}};return N(x)-N(A)}(f.type,m.type)||this.Za(f.doc,m.doc)),this.iu(r),s=s!=null&&s;const a=n&&!s?this.su():[],c=this.Ya.size===0&&this.current&&!s?1:0,d=c!==this.Ja;return this.Ja=c,o.length!==0||d?{snapshot:new Jo(this.query,e.Xa,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:a}:{ou:a}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new Jw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=de(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new Bx(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new Ux(r))}),n}au(e){this.Ha=e.$s,this.Ya=de();const n=this.tu(e.documents);return this.applyChanges(n,!0)}uu(){return Jo.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const iy="SyncEngine";class eV{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class tV{constructor(e){this.key=e,this.cu=!1}}class nV{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new br(a=>MS(a),gh),this.Pu=new Map,this.Tu=new Set,this.Iu=new Le(Q.comparator),this.Eu=new Map,this.du=new Hg,this.Au={},this.Ru=new Map,this.Vu=bi.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function rV(t,e,n=!0){const r=Hx(t);let s;const i=r.hu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.uu()):s=await zx(r,e,n,!0),s}async function sV(t,e){const n=Hx(t);await zx(n,e,!0,!1)}async function zx(t,e,n,r){const s=await S2(t.localStore,En(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await iV(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Rx(t.remoteStore,s),a}async function iV(t,e,n,r,s){t.fu=(m,g,x)=>async function(N,C,I,v){let S=C.view.tu(I);S.Cs&&(S=await Gw(N.localStore,C.query,!1).then(({documents:_})=>C.view.tu(_,S)));const D=v&&v.targetChanges.get(C.targetId),L=v&&v.targetMismatches.get(C.targetId)!=null,V=C.view.applyChanges(S,N.isPrimaryClient,D,L);return n0(N,C.targetId,V.ou),V.snapshot}(t,m,g,x);const i=await Gw(t.localStore,e,!0),o=new Z2(e,i.$s),a=o.tu(i.documents),c=hc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,c);n0(t,n,d.ou);const f=new eV(e,n,o);return t.hu.set(e,f),t.Pu.has(n)?t.Pu.get(n).push(e):t.Pu.set(n,[e]),d.snapshot}async function oV(t,e,n){const r=ce(t),s=r.hu.get(e),i=r.Pu.get(s.targetId);if(i.length>1)return r.Pu.set(s.targetId,i.filter(o=>!gh(o,e))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await cp(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Jg(r.remoteStore,s.targetId),hp(r,s.targetId)}).catch(Li)):(hp(r,s.targetId),await cp(r.localStore,s.targetId,!0))}async function aV(t,e){const n=ce(t),r=n.hu.get(e),s=n.Pu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Jg(n.remoteStore,r.targetId))}async function lV(t,e,n){const r=Kx(t);try{const s=await function(o,a){const c=ce(o),d=qe.now(),f=a.reduce((x,A)=>x.add(A.key),de());let m,g;return c.persistence.runTransaction("Locally write mutations","readwrite",x=>{let A=on(),N=de();return c.Bs.getEntries(x,f).next(C=>{A=C,A.forEach((I,v)=>{v.isValidDocument()||(N=N.add(I))})}).next(()=>c.localDocuments.getOverlayedDocuments(x,A)).next(C=>{m=C;const I=[];for(const v of a){const S=Sj(v,m.get(v.key).overlayedDocument);S!=null&&I.push(new Dr(v.key,S,PS(S.value.mapValue),Dt.exists(!0)))}return c.mutationQueue.addMutationBatch(x,d,I,a)}).next(C=>{g=C;const I=C.applyToLocalDocumentSet(m,N);return c.documentOverlayCache.saveOverlays(x,C.batchId,I)})}).then(()=>({batchId:g.batchId,changes:US(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let d=o.Au[o.currentUser.toKey()];d||(d=new Le(oe)),d=d.insert(a,c),o.Au[o.currentUser.toKey()]=d}(r,s.batchId,n),await pc(r,s.changes),await mc(r.remoteStore)}catch(s){const i=ry(s,"Failed to persist write");n.reject(i)}}async function $x(t,e){const n=ce(t);try{const r=await E2(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Eu.get(i);o&&(te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.cu=!0:s.modifiedDocuments.size>0?te(o.cu,14607):s.removedDocuments.size>0&&(te(o.cu,42227),o.cu=!1))}),await pc(n,r,e)}catch(r){await Li(r)}}function t0(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.hu.forEach((i,o)=>{const a=o.view.Fa(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=ce(o);c.onlineState=a;let d=!1;c.queries.forEach((f,m)=>{for(const g of m.Sa)g.Fa(a)&&(d=!0)}),d&&sy(c)}(r.eventManager,e),s.length&&r.lu.Y_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function cV(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Eu.get(e),i=s&&s.key;if(i){let o=new Le(Q.comparator);o=o.insert(i,Qe.newNoDocument(i,re.min()));const a=de().add(i),c=new wh(re.min(),new Map,new Le(oe),o,a);await $x(r,c),r.Iu=r.Iu.remove(i),r.Eu.delete(e),oy(r)}else await cp(r.localStore,e,!1).then(()=>hp(r,e,n)).catch(Li)}async function uV(t,e){const n=ce(t),r=e.batch.batchId;try{const s=await w2(n.localStore,e);qx(n,r,null),Wx(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await pc(n,s)}catch(s){await Li(s)}}async function dV(t,e,n){const r=ce(t);try{const s=await function(o,a){const c=ce(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return c.mutationQueue.lookupMutationBatch(d,a).next(m=>(te(m!==null,37113),f=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,f,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>c.localDocuments.getDocuments(d,f))})}(r.localStore,e);qx(r,e,n),Wx(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await pc(r,s)}catch(s){await Li(s)}}function Wx(t,e){(t.Ru.get(e)||[]).forEach(n=>{n.resolve()}),t.Ru.delete(e)}function qx(t,e,n){const r=ce(t);let s=r.Au[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Au[r.currentUser.toKey()]=s}}function hp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Pu.get(e))t.hu.delete(r),n&&t.lu.gu(r,n);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach(r=>{t.du.containsKey(r)||Gx(t,r)})}function Gx(t,e){t.Tu.delete(e.path.canonicalString());const n=t.Iu.get(e);n!==null&&(Jg(t.remoteStore,n),t.Iu=t.Iu.remove(e),t.Eu.delete(n),oy(t))}function n0(t,e,n){for(const r of n)r instanceof Ux?(t.du.addReference(r.key,e),hV(t,r)):r instanceof Bx?($(iy,"Document no longer in limbo: "+r.key),t.du.removeReference(r.key,e),t.du.containsKey(r.key)||Gx(t,r.key)):X(19791,{pu:r})}function hV(t,e){const n=e.key,r=n.path.canonicalString();t.Iu.get(n)||t.Tu.has(r)||($(iy,"New document in limbo: "+n),t.Tu.add(r),oy(t))}function oy(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const n=new Q(Se.fromString(e)),r=t.Vu.next();t.Eu.set(r,new tV(n)),t.Iu=t.Iu.insert(n,r),Rx(t.remoteStore,new gr(En(ph(n.path)),r,"TargetPurposeLimboResolution",_n.le))}}async function pc(t,e,n){const r=ce(t),s=[],i=[],o=[];r.hu.isEmpty()||(r.hu.forEach((a,c)=>{o.push(r.fu(c,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Yg.Rs(c.targetId,d);i.push(m)}}))}),await Promise.all(o),r.lu.Y_(s),await async function(c,d){const f=ce(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>O.forEach(d,g=>O.forEach(g.ds,x=>f.persistence.referenceDelegate.addReference(m,g.targetId,x)).next(()=>O.forEach(g.As,x=>f.persistence.referenceDelegate.removeReference(m,g.targetId,x)))))}catch(m){if(!Ls(m))throw m;$(Xg,"Failed to update sequence numbers: "+m)}for(const m of d){const g=m.targetId;if(!m.fromCache){const x=f.xs.get(g),A=x.snapshotVersion,N=x.withLastLimboFreeSnapshotVersion(A);f.xs=f.xs.insert(g,N)}}}(r.localStore,i))}async function fV(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){$(iy,"User change. New user:",e.toKey());const r=await kx(n.localStore,e);n.currentUser=e,function(i,o){i.Ru.forEach(a=>{a.forEach(c=>{c.reject(new K(U.CANCELLED,o))})}),i.Ru.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await pc(n,r.ks)}}function mV(t,e){const n=ce(t),r=n.Eu.get(e);if(r&&r.cu)return de().add(r.key);{let s=de();const i=n.Pu.get(e);if(!i)return s;for(const o of i){const a=n.hu.get(o);s=s.unionWith(a.view.eu)}return s}}function Hx(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=$x.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cV.bind(null,e),e.lu.Y_=X2.bind(null,e.eventManager),e.lu.gu=J2.bind(null,e.eventManager),e}function Kx(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=uV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dV.bind(null,e),e}class Yl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Sh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,n){return null}Cu(e,n){return null}Du(e){return xx(this.persistence,new Sx,e.initialUser,this.serializer)}Su(e){return new Kg(Ih.fi,this.serializer)}bu(e){return new Px}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Yl.provider={build:()=>new Yl};class pV extends Yl{constructor(e){super(),this.cacheSizeBytes=e}vu(e,n){te(this.persistence.referenceDelegate instanceof Cd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new _x(r,e.asyncQueue,n)}Su(e){const n=this.cacheSizeBytes!==void 0?Nt.withCacheSize(this.cacheSizeBytes):Nt.DEFAULT;return new Kg(r=>Cd.fi(r,n),this.serializer)}}class gV extends Yl{constructor(e,n,r){super(),this.Fu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await Kx(this.Fu.syncEngine),await mc(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return xx(this.persistence,new Sx,e.initialUser,this.serializer)}vu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new _x(r,e.asyncQueue,n)}Cu(e,n){const r=new TD(n,this.persistence);return new ED(e.asyncQueue,r)}Su(e){const n=g2(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Nt.withCacheSize(this.cacheSizeBytes):Nt.DEFAULT;return new Qg(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,R2(),Vu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new Px}}class bd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>t0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fV.bind(null,this.syncEngine),await K2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Y2}()}createDatastore(e){const n=Sh(e.databaseInfo.databaseId),r=function(i){return new C2(i)}(e.databaseInfo);return function(i,o,a,c){return new V2(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new M2(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>t0(this.syncEngine,n,0),function(){return Qw.C()?new Qw:new k2}())}createSyncEngine(e,n){return function(s,i,o,a,c,d,f){const m=new nV(s,i,o,a,c,d);return f&&(m.mu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ce(s);$(Di,"RemoteStore shutting down."),i.da.add(5),await fc(i),i.Ra.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}bd.provider={build:()=>new bd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ft("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs="FirestoreClient";class yV{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=vt.UNAUTHENTICATED,this.clientId=rS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{$(bs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>($(bs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ry(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function bf(t,e){t.asyncQueue.verifyOperationInProgress(),$(bs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await kx(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function r0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await vV(t);$(bs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Xw(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Xw(e.remoteStore,s)),t._onlineComponents=e}async function vV(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){$(bs,"Using user provided OfflineComponentProvider");try{await bf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ai("Error using user provided cache. Falling back to memory cache: "+n),await bf(t,new Yl)}}else $(bs,"Using default OfflineComponentProvider"),await bf(t,new pV(void 0));return t._offlineComponents}async function Yx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?($(bs,"Using user provided OnlineComponentProvider"),await r0(t,t._uninitializedComponentsProvider._online)):($(bs,"Using default OnlineComponentProvider"),await r0(t,new bd))),t._onlineComponents}function _V(t){return Yx(t).then(e=>e.syncEngine)}async function Xx(t){const e=await Yx(t),n=e.eventManager;return n.onListen=rV.bind(null,e.syncEngine),n.onUnlisten=oV.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=sV.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=aV.bind(null,e.syncEngine),n}function wV(t,e,n={}){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const f=new Qx({next:g=>{f.xu(),o.enqueueAndForget(()=>Lx(i,m));const x=g.docs.has(a);!x&&g.fromCache?d.reject(new K(U.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&g.fromCache&&c&&c.source==="server"?d.reject(new K(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new Fx(ph(a.path),f,{includeMetadataChanges:!0,Qa:!0});return Mx(i,m)}(await Xx(t),t.asyncQueue,e,n,r)),r.promise}function EV(t,e,n={}){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const f=new Qx({next:g=>{f.xu(),o.enqueueAndForget(()=>Lx(i,m)),g.fromCache&&c.source==="server"?d.reject(new K(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new Fx(a,f,{includeMetadataChanges:!0,Qa:!0});return Mx(i,m)}(await Xx(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t,e,n){if(!n)throw new K(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function TV(t,e,n,r){if(e===!0&&r===!0)throw new K(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function i0(t){if(!Q.isDocumentKey(t))throw new K(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function o0(t){if(Q.isDocumentKey(t))throw new K(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function kh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":X(12329,{type:typeof t})}function Sn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new K(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=kh(t);throw new K(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="firestore.googleapis.com",a0=!0;class l0{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new K(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=e1,this.ssl=a0}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:a0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=px;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Zj)throw new K(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}TV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Jx((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new K(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new K(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new K(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ah{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new l0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new l0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new cD;switch(r.type){case"firstParty":return new fD(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=s0.get(n);r&&($("ComponentProvider","Removing Datastore"),s0.delete(n),r.terminate())}(this),Promise.resolve()}}function IV(t,e,n,r={}){var s;t=Sn(t,Ah);const i=Oi(e),o=t._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;i&&(mg(`https://${c}`),pg("Firestore",!0)),o.host!==e1&&o.host!==c&&Ai("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!Ti(d,a)&&(t._setSettings(d),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=vt.MOCK_USER;else{f=PN(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new K(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new vt(g)}t._authCredentials=new uD(new tS(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ui(this.firestore,e,this._query)}}class zt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ss(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new zt(this.firestore,e,this._key)}}class Ss extends Ui{constructor(e,n,r){super(e,n,ph(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new zt(this.firestore,null,new Q(e))}withConverter(e){return new Ss(this.firestore,e,this._path)}}function rn(t,e,...n){if(t=rt(t),Zx("collection","path",e),t instanceof Ah){const r=Se.fromString(e,...n);return o0(r),new Ss(t,null,r)}{if(!(t instanceof zt||t instanceof Ss))throw new K(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Se.fromString(e,...n));return o0(r),new Ss(t.firestore,null,r)}}function nt(t,e,...n){if(t=rt(t),arguments.length===1&&(e=rS.newId()),Zx("doc","path",e),t instanceof Ah){const r=Se.fromString(e,...n);return i0(r),new zt(t,null,new Q(r))}{if(!(t instanceof zt||t instanceof Ss))throw new K(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Se.fromString(e,...n));return i0(r),new zt(t.firestore,t instanceof Ss?t.converter:null,new Q(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0="AsyncQueue";class u0{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Nx(this,"async_queue_retry"),this.rc=()=>{const r=Vu();r&&$(c0,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=e;const n=Vu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const n=Vu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const n=new rr;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Ls(e))throw e;$(c0,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const n=this.sc.then(()=>(this.ec=!0,e().catch(r=>{throw this.Xu=r,this.ec=!1,Ft("INTERNAL UNHANDLED ERROR: ",d0(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=n,n}enqueueAfterDelay(e,n,r){this.oc(),this.nc.indexOf(e)>-1&&(n=0);const s=ny.createAndSchedule(this,e,n,r,i=>this.uc(i));return this.Zu.push(s),s}oc(){this.Xu&&X(47125,{cc:d0(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const n of this.Zu)if(n.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Zu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const n=this.Zu.indexOf(e);this.Zu.splice(n,1)}}function d0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Us extends Ah{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new u0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new u0(e),this._firestoreClient=void 0,await e}}}function SV(t,e){const n=typeof t=="object"?t:vg(),r=typeof t=="string"?t:Td,s=sh(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=JT("firestore");i&&IV(s,...i)}return s}function ay(t){if(t._terminated)throw new K(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||t1(t),t._firestoreClient}function t1(t){var e,n,r;const s=t._freezeSettings(),i=function(a,c,d,f){return new XD(a,c,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Jx(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new yV(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}}(t._componentsProvider))}function xV(t,e){Ai("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return kV(t,bd.provider,{build:r=>new gV(r,n.cacheSizeBytes,void 0)}),Promise.resolve()}function kV(t,e,n){if((t=Sn(t,Us))._firestoreClient||t._terminated)throw new K(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new K(U.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},t1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zo(st.fromBase64String(e))}catch(n){throw new K(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Zo(st.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new K(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new K(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new K(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return oe(this._lat,e._lat)||oe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AV=/^__.*__$/;class PV{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Dr(e,this.data,this.fieldMask,n,this.fieldTransforms):new ua(e,this.data,n,this.fieldTransforms)}}class n1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Dr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function r1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X(40011,{Ic:t})}}class dy{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Ec(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new dy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.dc({path:r,Rc:!1});return s.Vc(e),s}mc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.dc({path:r,Rc:!1});return s.Ec(),s}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Dd(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(r1(this.Ic)&&AV.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class NV{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Sh(e)}bc(e,n,r,s=!1){return new dy({Ic:e,methodName:n,wc:r,path:ze.emptyPath(),Rc:!1,yc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nh(t){const e=t._freezeSettings(),n=Sh(t._databaseId);return new NV(t._databaseId,!!e.ignoreUndefinedProperties,n)}function s1(t,e,n,r,s,i={}){const o=t.bc(i.merge||i.mergeFields?2:0,e,n,s);hy("Data must be an object, but it was:",o,r);const a=i1(r,o);let c,d;if(i.merge)c=new Ht(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const g=fp(e,m,n);if(!o.contains(g))throw new K(U.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);a1(f,g)||f.push(g)}c=new Ht(f),d=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=o.fieldTransforms;return new PV(new bt(a),c,d)}class Ch extends ly{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ch}}function CV(t,e,n,r){const s=t.bc(1,e,n);hy("Data must be an object, but it was:",s,r);const i=[],o=bt.empty();Fs(r,(c,d)=>{const f=fy(e,c,n);d=rt(d);const m=s.mc(f);if(d instanceof Ch)i.push(f);else{const g=gc(d,m);g!=null&&(i.push(f),o.set(f,g))}});const a=new Ht(i);return new n1(o,a,s.fieldTransforms)}function RV(t,e,n,r,s,i){const o=t.bc(1,e,n),a=[fp(e,r,n)],c=[s];if(i.length%2!=0)throw new K(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(fp(e,i[g])),c.push(i[g+1]);const d=[],f=bt.empty();for(let g=a.length-1;g>=0;--g)if(!a1(d,a[g])){const x=a[g];let A=c[g];A=rt(A);const N=o.mc(x);if(A instanceof Ch)d.push(x);else{const C=gc(A,N);C!=null&&(d.push(x),f.set(x,C))}}const m=new Ht(d);return new n1(f,m,o.fieldTransforms)}function bV(t,e,n,r=!1){return gc(n,t.bc(r?4:3,e))}function gc(t,e){if(o1(t=rt(t)))return hy("Unsupported field value:",e,t),i1(t,e);if(t instanceof ly)return function(r,s){if(!r1(s.Ic))throw s.gc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.gc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=gc(a,s.fc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=rt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return yj(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=qe.fromDate(r);return{timestampValue:Xo(s.serializer,i)}}if(r instanceof qe){const i=new qe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Xo(s.serializer,i)}}if(r instanceof cy)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Zo)return{bytesValue:ZS(s.serializer,r._byteString)};if(r instanceof zt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Wg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof uy)return function(o,a){return{mapValue:{fields:{[Og]:{stringValue:Mg},[qo]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.gc("VectorValues must only contain numeric values.");return Fg(a.serializer,d)})}}}}}}(r,s);throw s.gc(`Unsupported field value: ${kh(r)}`)}(t,e)}function i1(t,e){const n={};return _S(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fs(t,(r,s)=>{const i=gc(s,e.Ac(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function o1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qe||t instanceof cy||t instanceof Zo||t instanceof zt||t instanceof ly||t instanceof uy)}function hy(t,e,n){if(!o1(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=kh(n);throw r==="an object"?e.gc(t+" a custom object"):e.gc(t+" "+r)}}function fp(t,e,n){if((e=rt(e))instanceof Ph)return e._internalPath;if(typeof e=="string")return fy(t,e);throw Dd("Field path arguments must be of type string or ",t,!1,void 0,n)}const DV=new RegExp("[~\\*/\\[\\]]");function fy(t,e,n){if(e.search(DV)>=0)throw Dd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ph(...e.split("."))._internalPath}catch{throw Dd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Dd(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new K(U.INVALID_ARGUMENT,a+t+c)}function a1(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new jV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Rh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class jV extends l1{data(){return super.data()}}function Rh(t,e){return typeof e=="string"?fy(t,e):e instanceof Ph?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new K(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class my{}class c1 extends my{}function Qn(t,e,...n){let r=[];e instanceof my&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof py).length,a=i.filter(c=>c instanceof bh).length;if(o>1||o>0&&a>0)throw new K(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class bh extends c1{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new bh(e,n,r)}_apply(e){const n=this._parse(e);return u1(e._query,n),new Ui(e.firestore,e.converter,ep(e._query,n))}_parse(e){const n=Nh(e.firestore);return function(i,o,a,c,d,f,m){let g;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new K(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){f0(m,f);const A=[];for(const N of m)A.push(h0(c,i,N));g={arrayValue:{values:A}}}else g=h0(c,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||f0(m,f),g=bV(a,o,m,f==="in"||f==="not-in");return ge.create(d,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ct(t,e,n){const r=e,s=Rh("where",t);return bh._create(s,r,n)}class py extends my{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new py(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:xe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)u1(o,c),o=ep(o,c)}(e._query,n),new Ui(e.firestore,e.converter,ep(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class gy extends c1{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new gy(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new K(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new K(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hl(i,o)}(e._query,this._field,this._direction);return new Ui(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new ca(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Yn(t,e="asc"){const n=e,r=Rh("orderBy",t);return gy._create(r,n)}function h0(t,e,n){if(typeof(n=rt(n))=="string"){if(n==="")throw new K(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!OS(e)&&n.indexOf("/")!==-1)throw new K(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Se.fromString(n));if(!Q.isDocumentKey(r))throw new K(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ql(t,new Q(r))}if(n instanceof zt)return ql(t,n._key);throw new K(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${kh(n)}.`)}function f0(t,e){if(!Array.isArray(t)||t.length===0)throw new K(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function u1(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new K(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class OV{convertValue(e,n="none"){switch(Ns(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ar(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw X(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Fs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[qo].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Oe(o.doubleValue));return new uy(i)}convertGeoPoint(e){return new cy(Oe(e.latitude),Oe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=fh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp($l(e));default:return null}}convertTimestamp(e){const n=kr(e);return new qe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Se.fromString(e);te(cx(r),9688,{name:e});const s=new Pi(r.get(1),r.get(3)),i=new Q(r.popFirst(5));return s.isEqual(n)||Ft(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d1(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class h1 extends l1{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ou(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Rh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ou extends h1{data(e={}){return super.data(e)}}class MV{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Qa(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ou(this._firestore,this._userDataWriter,r.key,r,new Qa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new K(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new Ou(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Qa(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Ou(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Qa(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:LV(a.type),doc:c,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function LV(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(t){t=Sn(t,zt);const e=Sn(t.firestore,Us);return wV(ay(e),t._key).then(n=>FV(e,t,n))}class f1 extends OV{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new zt(this.firestore,null,n)}}function Xn(t){t=Sn(t,Ui);const e=Sn(t.firestore,Us),n=ay(e),r=new f1(e);return VV(t._query),EV(n,t._query).then(s=>new MV(e,r,t,s))}function jd(t,e,n){t=Sn(t,zt);const r=Sn(t.firestore,Us),s=d1(t.converter,e,n);return Dh(r,[s1(Nh(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Dt.none())])}function xs(t,e,n,...r){t=Sn(t,zt);const s=Sn(t.firestore,Us),i=Nh(s);let o;return o=typeof(e=rt(e))=="string"||e instanceof Ph?RV(i,"updateDoc",t._key,e,n,r):CV(i,"updateDoc",t._key,e),Dh(s,[o.toMutation(t._key,Dt.exists(!0))])}function yy(t){return Dh(Sn(t.firestore,Us),[new _h(t._key,Dt.none())])}function vy(t,e){const n=Sn(t.firestore,Us),r=nt(t),s=d1(t.converter,e);return Dh(n,[s1(Nh(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Dt.exists(!1))]).then(()=>r)}function Dh(t,e){return function(r,s){const i=new rr;return r.asyncQueue.enqueueAndForget(async()=>lV(await _V(r),s,i)),i.promise}(ay(t),e)}function FV(t,e,n){const r=n.docs.get(e._key),s=new f1(t);return new h1(t,s,e._key,r,new Qa(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){la=s})(oa),Ii(new Ps("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Us(new dD(r.getProvider("auth-internal")),new mD(o,r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new K(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pi(d.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),er(G_,H_,e),er(G_,H_,"esm2017")})();var UV="firebase",BV="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */er(UV,BV,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,nn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mp="us-central1";class $V{constructor(e,n,r,s,i=mp,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new zV(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=mp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function WV(t,e,n){const r=Oi(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(mg(t.emulatorOrigin),pg("Functions",!0))}const m0="@firebase/functions",p0="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV="auth-internal",GV="app-check-internal",HV="messaging-internal";function KV(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(qV),o=n.getProvider(HV),a=n.getProvider(GV);return new $V(s,i,o,a,r)};Ii(new Ps(m1,e,"PUBLIC").setMultipleInstances(!0)),er(m0,p0,t),er(m0,p0,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(t=vg(),e=mp){const r=sh(rt(t),m1).getImmediate({identifier:e}),s=JT("functions");return s&&YV(r,...s),r}function YV(t,e,n){WV(rt(t),e,n)}KV();const XV={apiKey:"AIzaSyBn2jG-T2SesKFr0TsfeQa04wlBmDeEoG4",authDomain:"clarity-311c3.firebaseapp.com",projectId:"clarity-311c3",storageBucket:"clarity-311c3.firebasestorage.app",messagingSenderId:"459484415688",appId:"1:459484415688:web:bac719ee243bbd9821c7fd"},_y=aI(XV),di=HI(_y),Ee=SV(_y);xV(Ee).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore persistence failed: multiple tabs open"):t.code==="unimplemented"&&console.warn("Firestore persistence is not available in this browser")});QV(_y,"us-central1");const p1=R.createContext(),xn=()=>{const t=R.useContext(p1);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},g1=({children:t})=>{const[e,n]=R.useState(null),[r,s]=R.useState(null),[i,o]=R.useState("free"),[a,c]=R.useState(!0),[d,f]=R.useState(!1),m=R.useRef(!0),g=(D,L)=>{if(!D||!L)return{isTrialActive:!1,daysRemaining:0};const V=L.seconds?new Date(L.seconds*1e3):new Date(L),_=new Date,y=_<V,E=Math.ceil((V-_)/(24*60*60*1e3));return{isTrialActive:y,daysRemaining:Math.max(0,E),trialEndDate:V}},x=async D=>{try{const L=await ha(nt(Ee,"users",D));if(L.exists()){const V=L.data(),_=g(V.trialStartDate,V.trialEndDate);if(console.log(" Profile Data:",V),console.log(" Trial Status:",_),!m.current)return;if(V.subscription==="trial"&&!_.isTrialActive){const y={...V,subscription:"free",subscriptionStatus:"trial_expired",updatedAt:new Date};await xs(nt(Ee,"users",D),{subscription:"free",subscriptionStatus:"trial_expired",updatedAt:new Date}),m.current&&(s({...y,..._}),o("free"))}else m.current&&(s({...V,..._}),o(V.subscription))}}catch(L){console.error("Error fetching user profile:",L),m.current&&c(!1)}};R.useEffect(()=>XR(di,async L=>{console.log(" Auth state changed:",L?"User logged in":"User logged out");try{if(!m.current)return;n(L),f(!!L),L?await x(L.uid):m.current&&(s(null),o("free"))}catch(V){console.error("Error in auth state change:",V)}finally{m.current&&c(!1)}}),[]),R.useEffect(()=>()=>{m.current=!1},[]);const A=async(D,L,V={})=>{try{const{user:_}=await jI(di,D,L),y={email:_.email,uid:_.uid,subscription:"trial",subscriptionStatus:"trial_active",trialStartDate:new Date,trialEndDate:new Date(Date.now()+14*24*60*60*1e3),createdAt:new Date,updatedAt:new Date,firstName:V.firstName||"",lastName:V.lastName||"",exerciseGoalMinutes:V.exerciseGoalMinutes||30,waterGoalOz:V.waterGoalOz||64,meditationGoalMinutes:V.meditationGoalMinutes||10};if(await jd(nt(Ee,"users",_.uid),y),m.current){const E=g(y.trialStartDate,y.trialEndDate);s({...y,...E}),o("trial")}return{success:!0,user:_}}catch(_){throw console.error("Signup error:",_),_}},N=async(D,L)=>{try{const{user:V}=await VI(di,D,L);return console.log(" Login successful, Firebase will trigger auth state change"),{success:!0,user:V}}catch(V){throw console.error("Login error:",V),V}},C=async()=>{try{return await OI(di),m.current&&(n(null),s(null),o("free"),f(!1)),{success:!0}}catch(D){throw console.error("Logout error:",D),D}},I=async()=>{try{if(e!=null&&e.uid){const D={subscription:"premium",subscriptionStatus:"premium_paid",premiumStartDate:new Date,updatedAt:new Date};return await xs(nt(Ee,"users",e.uid),D),m.current&&(o("premium"),s(L=>({...L,...D}))),{success:!0}}}catch(D){throw console.error("Error upgrading to premium:",D),D}},v=async()=>{try{if(e!=null&&e.uid){const D={subscription:"free",subscriptionCancelledAt:new Date,updatedAt:new Date};return await xs(nt(Ee,"users",e.uid),D),m.current&&(o("free"),s(L=>({...L,...D}))),{success:!0}}}catch(D){throw console.error("Error cancelling subscription:",D),D}},S={user:e,userProfile:r,userSubscription:i,isAuthenticated:d,isPremium:i==="premium"||i==="trial",isTrialActive:(r==null?void 0:r.isTrialActive)||!1,trialDaysRemaining:(r==null?void 0:r.daysRemaining)||0,loading:a,signup:A,login:N,logout:C,upgradeToPremium:I,cancelSubscription:v,fetchUserProfile:x,authKey:(e==null?void 0:e.uid)||"no-user"};return u.jsx(p1.Provider,{value:S,children:t})},y1="/assets/Logo-BuPYrDrj.png";var v1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},g0=yr.createContext&&yr.createContext(v1),JV=["attr","size","title"];function ZV(t,e){if(t==null)return{};var n=eO(t,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function eO(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Vd(){return Vd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vd.apply(this,arguments)}function y0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Od(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?y0(Object(n),!0).forEach(function(r){tO(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y0(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function tO(t,e,n){return e=nO(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nO(t){var e=rO(t,"string");return typeof e=="symbol"?e:e+""}function rO(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _1(t){return t&&t.map((e,n)=>yr.createElement(e.tag,Od({key:n},e.attr),_1(e.child)))}function sO(t){return e=>yr.createElement(iO,Vd({attr:Od({},t.attr)},e),_1(t.child))}function iO(t){var e=n=>{var{attr:r,size:s,title:i}=t,o=ZV(t,JV),a=s||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),yr.createElement("svg",Vd({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:Od(Od({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),i&&yr.createElement("title",null,i),t.children)};return g0!==void 0?yr.createElement(g0.Consumer,null,n=>e(n)):e(v1)}function oO(t){return sO({attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"User"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M17.438,21.937H6.562a2.5,2.5,0,0,1-2.5-2.5V18.61c0-3.969,3.561-7.2,7.938-7.2s7.938,3.229,7.938,7.2v.827A2.5,2.5,0,0,1,17.438,21.937ZM12,12.412c-3.826,0-6.938,2.78-6.938,6.2v.827a1.5,1.5,0,0,0,1.5,1.5H17.438a1.5,1.5,0,0,0,1.5-1.5V18.61C18.938,15.192,15.826,12.412,12,12.412Z"},child:[]},{tag:"path",attr:{d:"M12,9.911a3.924,3.924,0,1,1,3.923-3.924A3.927,3.927,0,0,1,12,9.911Zm0-6.847a2.924,2.924,0,1,0,2.923,2.923A2.926,2.926,0,0,0,12,3.064Z"},child:[]}]}]}]})(t)}async function aO(t,e){try{const n=nt(Ee,"users",t),r=await ha(n);let s=0;return r.exists()&&typeof r.data().points=="number"&&(s=r.data().points),await xs(n,{points:s+e,updatedAt:new Date}),{success:!0,newPoints:s+e}}catch(n){return console.error("Error adding points:",n),{success:!1,error:n}}}async function lO(t,e){try{const n=nt(Ee,"users",t),r=await ha(n);let s=0;return r.exists()&&typeof r.data().points=="number"&&(s=r.data().points),s<e?{success:!1,error:"Not enough points"}:(await xs(n,{points:s-e,updatedAt:new Date}),{success:!0,newPoints:s-e})}catch(n){return console.error("Error deducting points:",n),{success:!1,error:n}}}async function cO(t){try{const e=nt(Ee,"users",t),n=await ha(e);return n.exists()&&typeof n.data().points=="number"?n.data().points:0}catch(e){return console.error("Error getting points:",e),0}}async function uO(t,e,n="daily"){try{const r=new Date;let s;if(n==="daily")s=r.toISOString().split("T")[0];else if(n==="weekly"){const o=r.getFullYear(),a=Math.ceil(((r-new Date(o,0,1))/864e5+new Date(o,0,1).getDay()+1)/7);s=`${o}-W${a}`}else s="unknown";const i=nt(Ee,`users/${t}/challenges`,`${e}_${s}`);return await jd(i,{challengeId:e,period:n,periodKey:s,completedAt:new Date}),{success:!0}}catch(r){return console.error("Error completing challenge:",r),{success:!1,error:r}}}async function dO(t,e,n="daily"){try{const r=new Date;let s;if(n==="daily")s=r.toISOString().split("T")[0];else if(n==="weekly"){const a=r.getFullYear(),c=Math.ceil(((r-new Date(a,0,1))/864e5+new Date(a,0,1).getDay()+1)/7);s=`${a}-W${c}`}else s="unknown";const i=nt(Ee,`users/${t}/challenges`,`${e}_${s}`);return(await ha(i)).exists()}catch(r){return console.error("Error checking challenge completion:",r),!1}}const ye={async register(t){try{const e=await jI(di,t.email,t.password);return await jd(nt(Ee,"users",e.user.uid),{username:t.username,email:t.email,firstName:t.firstName,lastName:t.lastName,exerciseGoalMinutes:t.exerciseGoalMinutes||30,waterGoalOz:t.waterGoalOz||64,meditationGoalMinutes:t.meditationGoalMinutes||10,subscription:"trial",subscriptionStatus:"trial_active",trialStartDate:new Date,trialEndDate:new Date(Date.now()+14*24*60*60*1e3),createdAt:new Date,updatedAt:new Date}),{user:e.user}}catch(e){throw new Error(e.message)}},async login(t,e){try{return{user:(await VI(di,t,e)).user}}catch{throw new Error("Invalid credentials")}},async logout(){try{return await OI(di),{message:"success"}}catch(t){throw new Error(t.message)}},async getUserProfile(t){try{const e=await ha(nt(Ee,"users",t));if(!e.exists())throw new Error("User not found");return{user:{id:t,...e.data()}}}catch(e){throw new Error(e.message)}},async updateUserProfile(t,e){try{const n=nt(Ee,"users",t);return await jd(n,{...e,updatedAt:new Date},{merge:!0}),{user:{id:t,...e}}}catch(n){throw new Error("Error updating profile: "+n.message)}},addPoints:aO,deductPoints:lO,getPoints:cO,completeChallenge:uO,isChallengeCompleted:dO};function hO(){const{user:t,logout:e}=xn(),n=th(),[r,s]=R.useState(!1),[i,o]=R.useState(null),[a,c]=R.useState(!1),d=R.useRef();R.useEffect(()=>{const A=async()=>{if(t!=null&&t.uid)try{c(!0);const N=await ye.getUserProfile(t.uid);o(N.user)}catch(N){console.error("Error fetching user profile:",N)}finally{c(!1)}};t!=null&&t.uid&&A()},[t]);const f=A=>{A.stopPropagation(),s(!r)};R.useEffect(()=>{if(!r)return;const A=N=>{d.current&&!d.current.contains(N.target)&&s(!1)};return document.addEventListener("click",A),()=>document.removeEventListener("click",A)},[r]);const m=async A=>{A.preventDefault(),s(!1);try{await e(),n("/welcome")}catch(N){console.error("Error logging out:",N),n("/welcome")}},g=()=>{s(!1),n("/profile")};if(!t)return null;const x="profile-dropdown"+(r?"":" hidden");return u.jsxs("div",{className:"profile-button-container",children:[u.jsx("button",{onClick:f,className:"profile-button",children:u.jsx(oO,{className:"profile-icon"})}),u.jsxs("ul",{className:x,ref:d,children:[u.jsx("li",{className:"profile-info",children:u.jsx("div",{className:"user-details",children:u.jsx("span",{className:"user-name",children:i!=null&&i.firstName&&(i!=null&&i.lastName)?`${i.firstName} ${i.lastName}`:(i==null?void 0:i.username)||"User"})})}),u.jsx("li",{className:"menu-divider"}),u.jsx("li",{children:u.jsx("button",{onClick:g,className:"dropdown-button",children:" Edit Profile"})}),u.jsx("li",{children:u.jsx("button",{onClick:()=>{s(!1),n("/dashboard")},className:"dropdown-button",children:" Dashboard"})}),u.jsx("li",{className:"menu-divider"}),u.jsx("li",{children:u.jsx("button",{onClick:m,className:"dropdown-button logout-button",children:" Sign Out"})})]})]})}function fO(){const{userSubscription:t,isTrialActive:e,trialDaysRemaining:n,upgradeToPremium:r}=xn();if(t==="premium"||t==="free"||!e)return null;const s=n<=3,i=(14-n)/14*100,o=()=>n===1?"Last day of premium!":n<=3?`Only ${n} days left!`:`${n} days remaining`,a=()=>n===1?"Keep Premium - $4.99/mo":n<=3?"Don't Lose Premium!":"Keep Premium - $4.99/mo";return u.jsxs("div",{className:`trial-banner ${s?"urgent":""}`,children:[u.jsxs("div",{className:"trial-content",children:[u.jsxs("div",{className:"trial-info",children:[u.jsx("span",{className:"trial-icon",children:s?"":""}),u.jsxs("div",{className:"trial-text",children:[u.jsx("h4",{children:s?"Premium Trial Ending!":"Premium Trial Active"}),u.jsx("p",{children:o()})]})]}),u.jsx("button",{onClick:r,className:"trial-upgrade-btn",children:a()})]}),u.jsx("div",{className:"trial-progress",children:u.jsx("div",{className:"trial-progress-bar",style:{width:`${i}%`}})})]})}function mO(){return u.jsxs("div",{className:"navigation-container",children:[u.jsxs("div",{className:"top-header",children:[u.jsxs("div",{className:"logo-container",children:[u.jsx("img",{src:y1,alt:"Clarity logo",className:"logo"}),u.jsx("span",{className:"logo-text",children:"Your Mind + Wellness Tracker"})]}),u.jsx(hO,{})]}),u.jsx(fO,{}),u.jsx("main",{className:"main-content",children:u.jsx(rN,{})}),u.jsxs("nav",{className:"bottom-navigation",children:[u.jsxs(Yi,{to:"/dashboard",className:({isActive:t})=>`nav-tab ${t?"active":""}`,children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{className:"nav-label",children:"Home"})]}),u.jsxs(Yi,{to:"/workout",className:({isActive:t})=>`nav-tab ${t?"active":""}`,children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{className:"nav-label",children:"Workout"})]}),u.jsxs(Yi,{to:"/meditation",className:({isActive:t})=>`nav-tab ${t?"active":""}`,children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{className:"nav-label",children:"Meditate"})]}),u.jsxs(Yi,{to:"/water",className:({isActive:t})=>`nav-tab ${t?"active":""}`,children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{className:"nav-label",children:"Water"})]}),u.jsxs(Yi,{to:"/games",className:({isActive:t})=>`nav-tab ${t?"active":""}`,children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{className:"nav-label",children:"Games"})]}),u.jsxs(Yi,{to:"/goals",className:({isActive:t})=>`nav-tab ${t?"active":""}`,children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{className:"nav-label",children:"Goals"})]})]})]})}function pO(){const{user:t,loading:e}=xn(),[n,r]=R.useState(""),[s,i]=R.useState(""),[o,a]=R.useState(""),[c,d]=R.useState(""),[f,m]=R.useState(""),[g,x]=R.useState(""),[A,N]=R.useState(""),[C,I]=R.useState("30"),[v,S]=R.useState("64"),[D,L]=R.useState("10"),[V,_]=R.useState({}),[y,E]=R.useState(!1),[T,P]=R.useState(!1),[b,k]=R.useState("pulse");if(R.useEffect(()=>{const ne=[setTimeout(()=>k("open"),2500),setTimeout(()=>k("form"),4500)];return()=>ne.forEach(clearTimeout)},[]),e)return u.jsx("div",{children:"Loading..."});if(t)return u.jsx(ld,{to:"/dashboard",replace:!0});const le=async ne=>{ne.preventDefault(),_({}),P(!0);try{await ye.login(n,s)}catch(Fe){_({credential:Fe.message})}finally{P(!1)}},ve=async ne=>{if(ne.preventDefault(),s!==A){_({confirmPassword:"Confirm Password field must be the same as the Password field"});return}_({}),P(!0);try{await ye.register({email:o,password:s,username:c,firstName:f,lastName:g,exerciseGoalMinutes:parseInt(C),waterGoalOz:parseInt(v),meditationGoalMinutes:parseInt(D)})}catch(Fe){_({general:Fe.message})}finally{P(!1)}};return u.jsxs("div",{className:"welcome-container",children:[b!=="form"&&u.jsx("div",{className:`awakening-bg ${b}`,children:u.jsx("div",{className:"awakening-eye"})}),u.jsxs("div",{className:`welcome-card ${b==="form"?"visible":""}`,children:[u.jsxs("div",{className:"welcome-header",children:[u.jsx("img",{src:y1,alt:"Clarity logo"}),u.jsx("p",{children:"Begin your wellness today"})]}),y?u.jsxs("form",{className:"welcome-form",onSubmit:ve,children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Email"}),u.jsx("input",{type:"email",value:o,onChange:ne=>a(ne.target.value),required:!0,placeholder:"Enter your email"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Username"}),u.jsx("input",{type:"text",value:c,onChange:ne=>d(ne.target.value),required:!0,placeholder:"Choose a username"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"First Name"}),u.jsx("input",{type:"text",value:f,onChange:ne=>m(ne.target.value),required:!0,placeholder:"Enter your first name"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Last Name"}),u.jsx("input",{type:"text",value:g,onChange:ne=>x(ne.target.value),required:!0,placeholder:"Enter your last name"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Password"}),u.jsx("input",{type:"password",value:s,onChange:ne=>i(ne.target.value),required:!0,placeholder:"Create a password"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Confirm Password"}),u.jsx("input",{type:"password",value:A,onChange:ne=>N(ne.target.value),required:!0,placeholder:"Confirm your password"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Exercise Goal (minutes)"}),u.jsx("input",{type:"number",value:C,onChange:ne=>I(ne.target.value),required:!0,placeholder:"Daily exercise goal in minutes"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Water Goal (oz)"}),u.jsx("input",{type:"number",value:v,onChange:ne=>S(ne.target.value),required:!0,placeholder:"Daily water goal in ounces"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Meditation Goal (minutes)"}),u.jsx("input",{type:"number",value:D,onChange:ne=>L(ne.target.value),required:!0,placeholder:"Daily meditation goal in minutes"})]}),V.confirmPassword&&u.jsx("p",{className:"error-message",children:V.confirmPassword}),V.general&&u.jsx("p",{className:"error-message",children:V.general}),u.jsx("button",{type:"submit",className:"primary-button",disabled:T,children:T?"Creating Account...":"Sign Up"})]}):u.jsxs("form",{className:"welcome-form",onSubmit:le,children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Username or Email"}),u.jsx("input",{type:"text",value:n,onChange:ne=>r(ne.target.value),required:!0,placeholder:"Enter your username or email"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Password"}),u.jsx("input",{type:"password",value:s,onChange:ne=>i(ne.target.value),required:!0,placeholder:"Enter your password"})]}),V.credential&&u.jsx("p",{className:"error-message",children:V.credential}),u.jsx("button",{type:"submit",className:"primary-button",disabled:T,children:T?"Logging In...":"Log In"})]}),u.jsx("button",{className:"secondary-button",onClick:()=>E(!y),disabled:T,children:y?"Already have an account? Log In":"Don't have an account? Sign Up"})]})]})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var pp=function(t,e){return pp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},pp(t,e)};function gO(t,e){pp(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var yO=100,vO=100,v0=50,gp=50,yp=50;function _0(t){var e=t.className,n=t.counterClockwise,r=t.dashRatio,s=t.pathRadius,i=t.strokeWidth,o=t.style;return R.createElement("path",{className:e,style:Object.assign({},o,wO({pathRadius:s,dashRatio:r,counterClockwise:n})),d:_O({pathRadius:s,counterClockwise:n}),strokeWidth:i,fillOpacity:0})}function _O(t){var e=t.pathRadius,n=t.counterClockwise,r=e,s=n?1:0;return`
      M `+gp+","+yp+`
      m 0,-`+r+`
      a `+r+","+r+" "+s+" 1 1 0,"+2*r+`
      a `+r+","+r+" "+s+" 1 1 0,-"+2*r+`
    `}function wO(t){var e=t.counterClockwise,n=t.dashRatio,r=t.pathRadius,s=Math.PI*2*r,i=(1-n)*s;return{strokeDasharray:s+"px "+s+"px",strokeDashoffset:(e?-i:i)+"px"}}var Df=function(t){gO(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},e.prototype.getPathRadius=function(){return v0-this.props.strokeWidth/2-this.getBackgroundPadding()},e.prototype.getPathRatio=function(){var n=this.props,r=n.value,s=n.minValue,i=n.maxValue,o=Math.min(Math.max(r,s),i);return(o-s)/(i-s)},e.prototype.render=function(){var n=this.props,r=n.circleRatio,s=n.className,i=n.classes,o=n.counterClockwise,a=n.styles,c=n.strokeWidth,d=n.text,f=this.getPathRadius(),m=this.getPathRatio();return R.createElement("svg",{className:i.root+" "+s,style:a.root,viewBox:"0 0 "+yO+" "+vO,"data-test-id":"CircularProgressbar"},this.props.background?R.createElement("circle",{className:i.background,style:a.background,cx:gp,cy:yp,r:v0}):null,R.createElement(_0,{className:i.trail,counterClockwise:o,dashRatio:r,pathRadius:f,strokeWidth:c,style:a.trail}),R.createElement(_0,{className:i.path,counterClockwise:o,dashRatio:m*r,pathRadius:f,strokeWidth:c,style:a.path}),d?R.createElement("text",{className:i.text,style:a.text,x:gp,y:yp},d):null)},e.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},e}(R.Component);function jf(t){var e=t.rotation,n=t.strokeLinecap,r=t.textColor,s=t.textSize,i=t.pathColor,o=t.pathTransition,a=t.pathTransitionDuration,c=t.trailColor,d=t.backgroundColor,f=e==null?void 0:"rotate("+e+"turn)",m=e==null?void 0:"center center";return{root:{},path:ou({stroke:i,strokeLinecap:n,transform:f,transformOrigin:m,transition:o,transitionDuration:a==null?void 0:a+"s"}),trail:ou({stroke:c,strokeLinecap:n,transform:f,transformOrigin:m}),text:ou({fill:r,fontSize:s}),background:ou({fill:d})}}function ou(t){return Object.keys(t).forEach(function(e){t[e]==null&&delete t[e]}),t}const z={getUserTimezone(){return Intl.DateTimeFormat().resolvedOptions().timeZone},getCurrentLocalTime(){return new Date},getStartOfDay(t=new Date){const e=new Date(t);return e.setHours(0,0,0,0),e},getEndOfDay(t=new Date){const e=new Date(t);return e.setHours(23,59,59,999),e},formatLocalDate(t){return t.toLocaleDateString("en-CA")},formatLocalDateTime(t){return t.toLocaleString()},formatLocalTime(t){return t.toLocaleTimeString()},getLocalDateRange(t=7){const e=this.getEndOfDay(new Date),n=this.getStartOfDay(new Date);return n.setDate(n.getDate()-(t-1)),{startDate:n,endDate:e}},isToday(t){const e=new Date;return this.formatLocalDate(t)===this.formatLocalDate(e)},isSameLocalDay(t,e){return this.formatLocalDate(t)===this.formatLocalDate(e)},toLocalTimezone(t){return new Date(t)},getRelativeTime(t){const n=new Date-t,r=Math.floor(n/6e4),s=Math.floor(r/60),i=Math.floor(s/24);return r<1?"Just now":r<60?`${r} minutes ago`:s<24?`${s} hours ago`:i===1?"Yesterday":i<7?`${i} days ago`:this.formatLocalDate(t)},getCurrentWeekRange(){const t=new Date,e=t.getDay(),n=new Date(t);n.setHours(0,0,0,0),n.setDate(t.getDate()-e);const r=new Date(n);return r.setDate(n.getDate()+6),r.setHours(23,59,59,999),{startDate:n,endDate:r}}},ii={async logWorkout(t,e){try{console.log(" Logging workout in timezone:",z.getUserTimezone());let n=z.getCurrentLocalTime();e.date&&(n=z.toLocalTimezone(e.date));const r={title:e.title,type:e.type||"General",durationMinutes:e.durationMinutes,date:n,notes:e.notes||"",caloriesBurned:e.caloriesBurned||0,completed:!0,createdAt:z.getCurrentLocalTime(),updatedAt:z.getCurrentLocalTime(),userTimezone:z.getUserTimezone()},s=await vy(rn(Ee,`users/${t}/workouts`),r);return{id:s.id,success:!0,workout:{...e,id:s.id}}}catch(n){throw new Error("Error logging workout: "+n.message)}},async fetchWorkoutsByUser(t){try{const e=Qn(rn(Ee,`users/${t}/workouts`),Yn("date","desc"));return{workouts:(await Xn(e)).docs.map(s=>{var i,o,a,c;return{id:s.id,...s.data(),date:(i=s.data().date)==null?void 0:i.toDate(),localDate:z.formatLocalDate((o=s.data().date)==null?void 0:o.toDate()),localDateTime:z.formatLocalDateTime((a=s.data().date)==null?void 0:a.toDate()),relativeTime:z.getRelativeTime((c=s.data().date)==null?void 0:c.toDate())}})}}catch(e){throw new Error("Error fetching workouts: "+e.message)}},async updateWorkout(t,e,n){try{const r=nt(Ee,`users/${t}/workouts`,e),s={...n,updatedAt:z.getCurrentLocalTime(),userTimezone:z.getUserTimezone()};return n.date&&(s.date=z.toLocalTimezone(n.date)),await xs(r,s),{success:!0,workout:{id:e,...n}}}catch(r){throw new Error("Error updating workout: "+r.message)}},async deleteWorkout(t,e){try{return await yy(nt(Ee,`users/${t}/workouts`,e)),{success:!0,message:"Workout deleted successfully"}}catch(n){throw new Error("Error deleting workout: "+n.message)}},async getWorkoutSummary(t){try{const{startDate:e,endDate:n}=z.getCurrentWeekRange();console.log(" Weekly workout query for timezone:",z.getUserTimezone()),console.log(" Query range:",z.formatLocalDateTime(e),"to",z.formatLocalDateTime(n));const r=Qn(rn(Ee,`users/${t}/workouts`),Ct("date",">=",e),Ct("date","<=",n),Yn("date","desc")),i=(await Xn(r)).docs.map(c=>{var d;return{id:c.id,...c.data(),date:(d=c.data().date)==null?void 0:d.toDate()}}),o=i.reduce((c,d)=>c+(d.durationMinutes||0),0),a=i.reduce((c,d)=>c+(d.caloriesBurned||0),0);return{totalWorkouts:i.length,totalMinutes:o,totalCalories:a,workouts:i.slice(0,5),period:"This week",userTimezone:z.getUserTimezone()}}catch(e){throw new Error("Error fetching workout summary: "+e.message)}},async getDailyWorkoutSummary(t,e=new Date){try{const{startDate:n,endDate:r}={startDate:z.getStartOfDay(e),endDate:z.getEndOfDay(e)};console.log(" Daily workout query for timezone:",z.getUserTimezone()),console.log(" Query range:",z.formatLocalDateTime(n),"to",z.formatLocalDateTime(r));const s=Qn(rn(Ee,`users/${t}/workouts`),Ct("date",">=",n),Ct("date","<=",r),Yn("date","desc")),o=(await Xn(s)).docs.map(f=>{var m;return{id:f.id,...f.data(),date:(m=f.data().date)==null?void 0:m.toDate()}});console.log(" Found workouts for today:",o.length);const a=o.reduce((f,m)=>f+(m.durationMinutes||0),0),c=o.length,d=o.reduce((f,m)=>f+(m.caloriesBurned||0),0);return{date:z.formatLocalDate(e),totalWorkouts:c,completedWorkouts:c,totalMinutes:a,caloriesBurned:d,lastWorkout:o.length>0?o[0]:null,workouts:o,hasWorkoutsToday:o.length>0,mostCommonType:o.length>0?this.getMostCommonWorkoutType(o):null,userTimezone:z.getUserTimezone()}}catch(n){return console.error("Error fetching daily workout summary:",n),this.getEmptyDailySummary(e)}},getMostCommonWorkoutType(t){if(t.length===0)return null;const e={};return t.forEach(n=>{e[n.type]=(e[n.type]||0)+1}),Object.keys(e).reduce((n,r)=>e[n]>e[r]?n:r)},getEmptyDailySummary(t){return{date:z.formatLocalDate(t),totalWorkouts:0,completedWorkouts:0,totalMinutes:0,caloriesBurned:0,lastWorkout:null,workouts:[],hasWorkoutsToday:!1,mostCommonType:null,userTimezone:z.getUserTimezone()}}},pn={async logWaterIntake(t,e){try{const n={amount:e.amount,date:z.toLocalTimezone(e.date||new Date),userId:t,createdAt:z.getCurrentLocalTime(),userTimezone:z.getUserTimezone()},r=await vy(rn(Ee,`users/${t}/waterIntake`),n);return{id:r.id,success:!0,waterIntake:{...e,id:r.id}}}catch(n){throw new Error("Error logging water intake: "+n.message)}},async fetchWaterIntakeByUser(t,e=30){try{const n=z.getStartOfDay(new Date);n.setDate(n.getDate()-e),console.log(" fetchWaterIntakeByUser - Start date:",n.toLocaleDateString());const r=Qn(rn(Ee,`users/${t}/waterIntake`),Ct("date",">=",n),Yn("date","desc")),i=(await Xn(r)).docs.map(o=>{var c;const a=o.data();return{id:o.id,...a,date:(c=a.date)!=null&&c.toDate?a.date.toDate():a.date}});return console.log(" fetchWaterIntakeByUser - Found intakes:",i.length),{waterIntakes:i}}catch(n){throw console.error(" fetchWaterIntakeByUser error:",n),new Error("Error fetching water intake: "+n.message)}},async updateWaterIntake(t,e,n){try{const r=nt(Ee,`users/${t}/waterIntake`,e);return await xs(r,{...n,updatedAt:new Date}),{success:!0,waterIntake:{id:e,...n}}}catch(r){throw new Error("Error updating water intake: "+r.message)}},async deleteWaterIntake(t,e){try{return await yy(nt(Ee,`users/${t}/waterIntake`,e)),{success:!0,message:"Water intake deleted successfully"}}catch(n){throw new Error("Error deleting water intake: "+n.message)}},async getTodayWaterIntake(t){try{const e=z.getStartOfDay(new Date),n=z.getEndOfDay(new Date);n.setMilliseconds(n.getMilliseconds()+1),console.log(" getTodayWaterIntake - Date range:",{today:e.toLocaleDateString(),tomorrow:n.toLocaleDateString(),todayISO:e.toISOString(),tomorrowISO:n.toISOString()});const r=Qn(rn(Ee,`users/${t}/waterIntake`),Ct("date",">=",e),Ct("date","<",n),Yn("date","desc")),i=(await Xn(r)).docs.map(a=>{var d;const c=a.data();return{...c,date:(d=c.date)!=null&&d.toDate?c.date.toDate():c.date}});return console.log(" getTodayWaterIntake - Found intakes:",i.length),i.forEach(a=>{var c;console.log("  -",a.amount,"oz on",(c=a.date)==null?void 0:c.toLocaleDateString())}),{totalOz:i.reduce((a,c)=>a+(c.amount||0),0),intakeCount:i.length,intakes:i}}catch(e){throw console.error(" getTodayWaterIntake error:",e),new Error("Error fetching today's water intake: "+e.message)}},async getWaterSummary(t){try{const{startDate:e,endDate:n}=z.getCurrentWeekRange(),r=Qn(rn(Ee,`users/${t}/waterIntake`),Ct("date",">=",e),Ct("date","<=",n),Yn("date","desc")),i=(await Xn(r)).docs.map(f=>f.data()),o={};i.forEach(f=>{const m=f.date.toDate().toDateString();o[m]=(o[m]||0)+f.amount});const a=i.reduce((f,m)=>f+(m.amount||0),0),c=7,d=c>0?a/c:0;return{totalOz:a,averageOz:d,dailyTotals:o,intakeCount:i.length}}catch(e){throw new Error("Error fetching water summary: "+e.message)}},async getDailyWaterIntake(t,e=new Date){try{const n=z.getStartOfDay(e),r=z.getEndOfDay(e),s=Qn(rn(Ee,`users/${t}/waterIntake`),Ct("date",">=",n),Ct("date","<=",r),Yn("date","desc")),o=(await Xn(s)).docs.map(c=>{var d;return{id:c.id,...c.data(),date:(d=c.data().date)==null?void 0:d.toDate()}}),a=o.reduce((c,d)=>c+(d.amount||0),0);return{date:z.formatLocalDate(e),totalOz:a,totalEntries:o.length,entries:o,hasWaterToday:o.length>0,userTimezone:z.getUserTimezone()}}catch(n){return console.error("Error fetching daily water intake:",n),{date:z.formatLocalDate(e),totalOz:0,totalEntries:0,entries:[],hasWaterToday:!1,userTimezone:z.getUserTimezone()}}},calculateHourlyWaterIntake(t){const e={};return t.forEach(n=>{const r=n.date.getHours();e[r]=(e[r]||0)+n.amount}),e}},oi={async logMeditation(t,e){try{const n={title:e.title||"Meditation Session",type:e.type||"mindfulness",soundscape:e.soundscape||"silence",durationMinutes:e.durationMinutes,targetDuration:e.targetDuration||e.durationMinutes,completed:e.completed||!1,deepStateAchieved:e.deepStateAchieved||!1,date:z.toLocalTimezone(e.date||new Date),notes:e.notes||"",moodBefore:e.moodBefore||"",moodAfter:e.moodAfter||"",guidedSession:e.guidedSession||!1,interruptions:e.interruptions||0,heartRateData:e.heartRateData||null,brainwaveFrequency:e.brainwaveFrequency||null,focusLevel:e.focusLevel||null,createdAt:z.getCurrentLocalTime(),updatedAt:z.getCurrentLocalTime(),userTimezone:z.getUserTimezone()},r=await vy(rn(Ee,`users/${t}/meditations`),n);return{id:r.id,success:!0,meditation:{...n,id:r.id}}}catch(n){throw new Error("Error logging meditation: "+n.message)}},async fetchMeditationsByUser(t,e=30){try{const n=new Date;n.setDate(n.getDate()-e);const r=Qn(rn(Ee,`users/${t}/meditations`),Ct("date",">=",n),Yn("date","desc"));return{meditations:(await Xn(r)).docs.map(o=>{var a;return{id:o.id,...o.data(),date:(a=o.data().date)==null?void 0:a.toDate()}})}}catch(n){throw new Error("Error fetching meditations: "+n.message)}},async getMeditationAnalytics(t,e=30){try{const r=(await this.fetchMeditationsByUser(t,e)).meditations;if(r.length===0)return{totalSessions:0,deepStateSuccessRate:0,averageDuration:0,favoriteTime:"morning",favoriteSound:"silence",moodImprovement:0};const i=r.filter(d=>d.deepStateAchieved).length/r.length*100,o={},a={},c=[];return r.forEach(d=>{o[d.soundscape]=(o[d.soundscape]||0)+1;const f=d.date.getHours(),m=f<12?"morning":f<18?"afternoon":"evening";if(a[m]=(a[m]||0)+1,d.moodBefore&&d.moodAfter){const g={"":1,"":2,"":3,"":4,"":5,"":6},x=g[d.moodBefore]||3,A=g[d.moodAfter]||3;c.push(A-x)}}),{totalSessions:r.length,deepStateSuccessRate:Math.round(i),averageDuration:r.reduce((d,f)=>d+f.durationMinutes,0)/r.length,favoriteTime:Object.keys(a).reduce((d,f)=>a[d]>a[f]?d:f,"morning"),favoriteSound:Object.keys(o).reduce((d,f)=>o[d]>o[f]?d:f,"silence"),moodImprovement:c.length>0?c.reduce((d,f)=>d+f,0)/c.length:0,consistency:r.length/e}}catch(n){throw new Error("Error fetching meditation analytics: "+n.message)}},async getPersonalizedRecommendations(t){try{const e=await this.getMeditationAnalytics(t),n=[];return e.deepStateSuccessRate<50&&n.push({type:"duration",message:"Try longer sessions (7-10 minutes) to achieve deeper states",action:"Increase session length"}),e.favoriteSound==="silence"&&n.push({type:"soundscape",message:'Research shows binaural beats can enhance focus. Try our "Deep Focus" soundscape.',action:"Try binaural beats"}),e.consistency<.5&&n.push({type:"consistency",message:`Your best time is ${e.favoriteTime}. Set a daily reminder for consistent practice.`,action:"Set daily reminder"}),{recommendations:n}}catch(e){throw new Error("Error generating recommendations: "+e.message)}},async updateMeditation(t,e,n){try{const r=nt(Ee,`users/${t}/meditations`,e);return await xs(r,{...n,updatedAt:new Date}),{success:!0,meditation:{id:e,...n}}}catch(r){throw new Error("Error updating meditation: "+r.message)}},async deleteMeditation(t,e){try{return await yy(nt(Ee,`users/${t}/meditations`,e)),{success:!0,message:"Meditation deleted successfully"}}catch(n){throw new Error("Error deleting meditation: "+n.message)}},async getMeditationSummary(t){try{const{startDate:e,endDate:n}=z.getCurrentWeekRange(),r=Qn(rn(Ee,`users/${t}/meditations`),Ct("date",">=",e),Ct("date","<=",n),Yn("date","desc")),i=(await Xn(r)).docs.map(d=>d.data()),o=i.reduce((d,f)=>d+(f.durationMinutes||0),0),a=i.length>0?o/i.length:0,c=i.length>0?i.filter(d=>d.deepStateAchieved).length/i.length*100:0;return{totalSessions:i.length,totalMinutes:o,averageDuration:a,deepStateSuccessRate:c,favoriteSoundscape:i.length>0?this.getMostFrequent(i,"soundscape"):"silence",favoriteTime:i.length>0?this.getMostFrequent(i,"timeOfDay"):"morning",moodImprovement:this.calculateMoodImprovement(i)}}catch(e){throw console.error("Error fetching meditation summary:",e),new Error("Error fetching meditation summary: "+e.message)}},getMostFrequent(t,e){const n={};return t.forEach(r=>{const s=e==="timeOfDay"?this.getTimeOfDay(r.date):r[e];n[s]=(n[s]||0)+1}),Object.keys(n).reduce((r,s)=>n[r]>n[s]?r:s)},getTimeOfDay(t){let e;if(t instanceof Date)e=t;else if(typeof t=="string")e=new Date(t);else if(t&&t.seconds)e=new Date(t.seconds*1e3);else return console.warn("Invalid date format:",t),"unknown";if(isNaN(e.getTime()))return console.warn("Invalid date object:",t),"unknown";const n=e.getHours();return n<6?"night":n<12?"morning":n<17?"afternoon":n<21?"evening":"night"},calculateMoodImprovement(t){const e={"":1,"":2,"":3,"":4,"":5,"":6};let n=0,r=0;return t.forEach(s=>{const i=e[s.moodBefore]||3,o=e[s.moodAfter]||3;n+=o-i,r++}),r>0?n/r:0},async getDailyMeditationSummary(t,e=new Date){try{const n=z.getStartOfDay(e),r=z.getEndOfDay(e);console.log(" Daily meditation query for timezone:",z.getUserTimezone());const s=Qn(rn(Ee,`users/${t}/meditations`),Ct("date",">=",n),Ct("date","<=",r),Yn("date","desc")),o=(await Xn(s)).docs.map(C=>{var I;return{id:C.id,...C.data(),date:(I=C.data().date)==null?void 0:I.toDate()}}),a=o.reduce((C,I)=>C+(I.durationMinutes||0),0),c=o.filter(C=>C.completed).length,d=o.length>0?a/o.length:0,f=o.filter(C=>C.deepStateAchieved).length,m=o.length>0?f/o.length*100:0,g=o.length>0?o[0]:null,x=o.length>0?this.getMostFrequent(o,"soundscape"):"silence",A=o.length>0?this.getMostFrequent(o,"timeOfDay"):"morning",N=this.calculateMoodImprovement(o);return{date:z.formatLocalDate(e),totalSessions:o.length,completedSessions:c,totalMinutes:a,averageDuration:Math.round(d*10)/10,deepStateAchieved:f,deepStateSuccessRate:Math.round(m),lastSession:g,favoriteSoundscape:x,favoriteTime:A,moodImprovement:Math.round(N*100)/100,sessions:o,hasSessionsToday:o.length>0,mostRecentType:(g==null?void 0:g.type)||"mindfulness",mostRecentSoundscape:(g==null?void 0:g.soundscape)||"silence",timeOfLastSession:(g==null?void 0:g.date)||null,totalInterruptions:o.reduce((C,I)=>C+(I.interruptions||0),0),averageFocusLevel:o.length>0?o.reduce((C,I)=>C+(I.focusLevel||5),0)/o.length:0,userTimezone:z.getUserTimezone()}}catch(n){return console.error("Error fetching daily meditation summary:",n),{date:e.toISOString().split("T")[0],totalSessions:0,completedSessions:0,totalMinutes:0,averageDuration:0,deepStateAchieved:0,deepStateSuccessRate:0,lastSession:null,favoriteSoundscape:"silence",favoriteTime:"morning",moodImprovement:0,sessions:[],hasSessionsToday:!1,mostRecentType:"mindfulness",mostRecentSoundscape:"silence",timeOfLastSession:null,totalInterruptions:0,averageFocusLevel:0,userTimezone:z.getUserTimezone()}}}},w0=["You are capable of amazing things.","You are loved.","You are strong.","You are beautiful.","You are enough.","You are worthy.","You are important.","You are talented.","You are special.","I am capable and strong","I am loved and loving","I am healthy and happy","I am wealthy and wise","Believe in yourself and all that you are.","You are amazing.","You are stronger than you think.","You are braver than you believe.","Every day is a new opportunity.","You are worth it.","You are worthy of all the good things.","You are deserving of love and happiness.","Stay positive, work hard, make it happen.","You are enough just as you are.","You are doing great.","Your potential is limitless.","You are a work of art.","You are doing great.","You are a gift to the world.","Keep going, you are getting there.","You are a masterpiece."],E0="https://createstripecheckoutsession-z5fchdkthq-uc.a.run.app";async function Xl(){const t=HI().currentUser;if(!t){alert("You must be logged in to upgrade.");return}try{console.log(" Starting Stripe upgrade with direct HTTP call"),console.log(" User ID:",t.uid),console.log(" Function URL:",E0);const e=await fetch(E0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:t.uid})});if(console.log(" Response status:",e.status),console.log(" Response headers:",e.headers),!e.ok){const s=await e.text();throw console.error(" HTTP error response:",s),new Error(`HTTP error! status: ${e.status}, body: ${s}`)}const n=await e.json();console.log(" Function call successful:",n);const{url:r}=n;console.log(" Redirecting to Stripe checkout:",r),window.location.href=r}catch(e){console.error(" Error creating Stripe checkout session:",e),console.error(" Error details:",e.message),alert("Error creating checkout session. Please try again.")}}function T0(){const t=Math.floor(Math.random()*w0.length);return w0[t]}function EO(){const t=th(),{user:e,loading:n,isPremium:r}=xn(),[s,i]=R.useState(null),[o,a]=R.useState({workout:{totalMinutes:0,sessions:0,hasWorkoutsToday:!1},meditation:{totalMinutes:0,sessions:0,hasSessionsToday:!1,deepStateAchieved:0},water:{totalOz:0,entries:0,hasWaterToday:!1}}),[c,d]=R.useState(30),[f,m]=R.useState(10),[g,x]=R.useState(64),[A,N]=R.useState(T0()),[C,I]=R.useState(!0),[v,S]=R.useState(!1),[D,L]=R.useState(0);if(R.useEffect(()=>{if(!n&&!e){t("/welcome",{replace:!0});return}},[e,n,t]),R.useEffect(()=>{(async()=>{if(e!=null&&e.uid)try{I(!0);const P=z.getCurrentLocalTime();console.log(" Dashboard timezone:",z.getUserTimezone()),console.log(" Local today:",z.formatLocalDateTime(P));const b=await ye.getUserProfile(e.uid);i(b.user),d(b.user.exerciseGoalMinutes||30),m(b.user.meditationGoalMinutes||10),x(b.user.waterGoalOz||64),console.log(" Fetching workout data for date:",P);const[k,le,ve]=await Promise.all([ii.getDailyWorkoutSummary(e.uid,P),oi.getDailyMeditationSummary(e.uid,P),pn.getDailyWaterIntake(e.uid,P)]);console.log(" Raw workout data from Dashboard:",k),console.log(" Raw meditation data:",le),console.log(" Raw water data:",ve),a({workout:{totalMinutes:k.totalMinutes||0,sessions:k.totalWorkouts||0,hasWorkoutsToday:k.hasWorkoutsToday||k.totalMinutes>0,calories:k.caloriesBurned||0,lastWorkoutType:k.mostCommonType},meditation:{totalMinutes:le.totalMinutes||0,sessions:le.totalSessions||0,hasSessionsToday:le.hasSessionsToday||!1,deepStateAchieved:le.deepStateAchieved||0,moodImprovement:le.moodImprovement||0,lastSessionType:le.mostRecentType},water:{totalOz:ve.totalOz||0,entries:ve.totalEntries||ve.entries||0,hasWaterToday:(ve.totalOz||0)>0,averagePerEntry:ve.averagePerEntry||0,isOnTrack:(ve.totalOz||0)>=(b.user.waterGoalOz||64)*.75}})}catch(P){console.error("Error fetching daily data:",P)}finally{I(!1)}})()},[e]),R.useEffect(()=>{const T=localStorage.getItem("affirmation"),P=localStorage.getItem("affirmationDate"),b=new Date().toISOString().split("T")[0];if(T&&P===b)N(T);else{const k=T0();N(k),localStorage.setItem("affirmation",k),localStorage.setItem("affirmationDate",b)}},[]),R.useEffect(()=>{if(console.log("Trial modal effect running",s),s&&s.subscriptionStatus==="trial_expired"&&s.subscription==="free"){const T=localStorage.getItem("dontRemindTrial"),P=localStorage.getItem("lastTrialReminded");console.log("dontRemindTrial:",T),console.log("lastReminded:",P);const b=1e3*60*60*24*7,k=Date.now();T||(!P||k-Number(P)>b)&&(S(!0),localStorage.setItem("lastTrialReminded",k),console.log("Showing trial modal!"))}},[s]),R.useEffect(()=>{(async()=>{if(e!=null&&e.uid){const P=await ye.getPoints(e.uid);L(P)}})()},[e]),n||C)return u.jsx("div",{className:"dashboard-loading",children:"Loading..."});if(!e)return u.jsx("div",{className:"dashboard-loading",children:"Redirecting..."});if(!s)return u.jsx("div",{className:"dashboard-loading",children:"Loading user data..."});if(!s.firstName||!s.exerciseGoalMinutes||!s.waterGoalOz||!s.meditationGoalMinutes)return u.jsx("div",{className:"dashboard-loading",children:"Loading user profile..."});const V=Math.min(o.workout.totalMinutes/c*100,100)||0,_=Math.min(o.meditation.totalMinutes/f*100,100)||0,y=Math.min(o.water.totalOz/g*100,100)||0,E=Math.max(c-o.workout.totalMinutes,0);return s.subscriptionStatus==="trial_expired"&&s.subscription,u.jsxs("div",{className:"dashboard-page",children:[u.jsxs("div",{className:"points-balance",children:[u.jsx("span",{role:"img","aria-label":"points",children:""})," ",D," Points"]}),u.jsxs("div",{className:"welcome-section",children:[u.jsxs("h1",{children:["Welcome back, ",s.firstName,"!"]}),u.jsx("p",{children:"Here's your wellness progress for today"})]}),u.jsxs("div",{className:"progress-bars",children:[u.jsxs("div",{className:"progress-bar",children:[u.jsx("h2",{children:" Today's Workout"}),u.jsxs("p",{className:"goal-text",children:["Daily Goal: ",c," minutes"]}),u.jsxs("p",{className:"current-text",children:[o.workout.totalMinutes," / ",c," min"]}),u.jsx(Df,{value:V,text:`${Math.round(V)}%`,styles:jf({pathColor:`rgba(62, 152, 199, ${Math.max(V/100,.3)})`,textColor:"#3e98c7"})}),u.jsx("div",{className:"daily-stats",children:o.workout.hasWorkoutsToday?u.jsxs("span",{children:[" ",o.workout.sessions," workouts logged"]}):u.jsx("span",{children:"No workouts logged today"})}),u.jsx("button",{className:"track-button",onClick:()=>t("/workout"),children:"Log Workout"})]}),u.jsxs("div",{className:"progress-bar",children:[u.jsx("h2",{children:" Today's Meditation"}),u.jsxs("p",{className:"goal-text",children:["Daily Goal: ",f," minutes"]}),u.jsxs("p",{className:"current-text",children:[o.meditation.totalMinutes," / ",f," min"]}),u.jsx(Df,{value:_,text:`${Math.round(_)}%`,styles:jf({pathColor:`rgba(138, 43, 226, ${Math.max(_/100,.3)})`,textColor:"#8a2be2"})}),u.jsxs("div",{className:"daily-stats",children:[o.meditation.hasSessionsToday?u.jsxs("span",{children:[" ",o.meditation.sessions," sessions completed"]}):u.jsx("span",{children:"No meditation logged today"}),o.meditation.deepStateAchieved>0&&u.jsxs("span",{className:"deep-state",children:[" ",o.meditation.deepStateAchieved," deep states"]})]}),u.jsx("button",{className:"track-button",onClick:()=>t("/meditation"),children:"Start Meditation"})]}),u.jsxs("div",{className:"progress-bar",children:[u.jsx("h2",{children:" Today's Hydration"}),u.jsxs("p",{className:"goal-text",children:["Daily Goal: ",g," oz"]}),u.jsxs("p",{className:"current-text",children:[o.water.totalOz," / ",g," oz"]}),u.jsx(Df,{value:y,text:`${Math.round(y)}%`,styles:jf({pathColor:`rgba(30, 144, 255, ${Math.max(y/100,.3)})`,textColor:"#1e90ff"})}),u.jsxs("div",{className:"daily-stats",children:[o.water.hasWaterToday?u.jsxs("span",{children:[" ",o.water.entries," water entries"]}):u.jsx("span",{children:"No water logged today"}),o.water.isOnTrack&&u.jsx("span",{className:"on-track",children:" On track for hydration!"})]}),u.jsx("button",{className:"track-button",onClick:()=>t("/water"),children:"Log Water"})]})]}),E>0&&u.jsx("div",{className:"notification-bar",children:u.jsxs("p",{children:[" You are ",E," minutes away from your daily workout goal!"]})}),V>=100&&_>=100&&y>=100&&u.jsx("div",{className:"celebration-bar",children:u.jsx("p",{children:" Congratulations! You've achieved all your daily wellness goals! "})}),u.jsxs("div",{className:"affirmation-bar",children:[u.jsx("p",{children:" Daily Affirmation "}),u.jsx("h2",{children:A})]}),u.jsxs("div",{className:"quick-stats",children:[u.jsxs("div",{className:"stat-item",children:[u.jsx("span",{className:"stat-number",children:o.workout.totalMinutes}),u.jsx("span",{className:"stat-label",children:"Minutes Exercised Today"})]}),u.jsxs("div",{className:"stat-item",children:[u.jsx("span",{className:"stat-number",children:o.water.totalOz}),u.jsx("span",{className:"stat-label",children:"Ounces of Water Today"})]}),u.jsxs("div",{className:"stat-item",children:[u.jsx("span",{className:"stat-number",children:o.meditation.totalMinutes}),u.jsx("span",{className:"stat-label",children:"Minutes Meditated Today"})]})]}),v&&u.jsx("div",{className:"trial-modal-overlay",children:u.jsxs("div",{className:"trial-modal",children:[u.jsx("h2",{children:"Your free trial has ended"}),u.jsx("p",{children:"Upgrade to keep enjoying premium features!"}),u.jsx("button",{className:"primary-button",onClick:Xl,children:"Upgrade with Stripe"}),u.jsxs("div",{className:"trial-modal-actions",children:[u.jsx("button",{className:"secondary-button",onClick:()=>S(!1),children:"Remind me later"}),u.jsx("button",{className:"link-button",onClick:()=>{localStorage.setItem("dontRemindTrial","true"),S(!1)},children:"Don't remind me again"})]})]})})]})}function TO(){const{user:t}=xn(),[e,n]=R.useState([]),[r,s]=R.useState({date:"",durationMinutes:"",title:"",type:"General",notes:"",caloriesBurned:""}),[i,o]=R.useState(!1),[a,c]=R.useState(null),[d,f]=R.useState(!0),[m,g]=R.useState(!1),[x,A]=R.useState(""),N=new Date().toISOString().split("T")[0];R.useEffect(()=>{(async()=>{if(t!=null&&t.uid)try{f(!0);const _=await ii.fetchWorkoutsByUser(t.uid);n(_.workouts||[])}catch(_){console.error("Error fetching workouts:",_),A("Failed to load workouts")}finally{f(!1)}})()},[t]);const C=V=>{const{name:_,value:y}=V.target;s(E=>({...E,[_]:y}))},I=async V=>{if(V.preventDefault(),console.log(" Workout submit started"),console.log(" Form data:",r),console.log(" Firebase user:",t==null?void 0:t.uid),!(t!=null&&t.uid)){console.error(" No user ID found"),A("Please log in to save workouts");return}if(!r.title||!r.durationMinutes||!r.date){A("Please fill in all required fields");return}try{g(!0),A("");let _;if(r.date){const T=r.date.split("-"),P=parseInt(T[0]),b=parseInt(T[1]),k=parseInt(T[2]),le=new Date;console.log(" Date parsing debug:"),console.log("  Form input:",r.date),console.log("  Split parts:",T),console.log("  Parsed year:",P),console.log("  Parsed month (human readable):",b),console.log("  Parsed day:",k),console.log("  Month for Date constructor (0-indexed):",b-1),_=new Date(P,b-1,k,le.getHours(),le.getMinutes(),le.getSeconds()),console.log(" Created date:",_),console.log(" Verify - Year:",_.getFullYear()),console.log(" Verify - Month (0-indexed):",_.getMonth()),console.log(" Verify - Month (human):",_.getMonth()+1),console.log(" Verify - Day:",_.getDate()),console.log(" Final formatted:",_.toLocaleDateString())}else _=z.getCurrentLocalTime();const y={title:r.title,type:r.type,durationMinutes:parseInt(r.durationMinutes),date:_,notes:r.notes,caloriesBurned:r.caloriesBurned?parseInt(r.caloriesBurned):0};console.log(" Final workout data:",y),console.log(" Will be saved as:",z.formatLocalDateTime(y.date));let E;if(i&&a?E=await ii.updateWorkout(t.uid,a,y):E=await ii.logWorkout(t.uid,y),console.log(" Workout service result:",E),E.success){console.log(" Workout logged successfully!");const T=await ii.fetchWorkoutsByUser(t.uid);n(T.workouts||[]),s({date:"",durationMinutes:"",title:"",type:"General",notes:"",caloriesBurned:""}),o(!1),c(null),A("")}}catch(_){console.error(" Workout logging error:",_),A("Failed to save workout. Please try again.")}finally{g(!1)}},v=V=>{var y,E;o(!0),c(V.id);const _=V.date instanceof Date?V.date.toISOString().split("T")[0]:new Date(V.date).toISOString().split("T")[0];s({date:_,durationMinutes:((y=V.durationMinutes)==null?void 0:y.toString())||"",title:V.title||"",type:V.type||"General",notes:V.notes||"",caloriesBurned:((E=V.caloriesBurned)==null?void 0:E.toString())||""})},S=async V=>{if(t!=null&&t.uid&&window.confirm("Are you sure you want to delete this workout?"))try{await ii.deleteWorkout(t.uid,V),n(_=>_.filter(y=>y.id!==V))}catch(_){console.error("Error deleting workout:",_),A("Failed to delete workout")}},D=()=>{o(!1),c(null),s({date:"",durationMinutes:"",title:"",type:"General",notes:"",caloriesBurned:""})},L=e.filter(V=>(V.date instanceof Date?V.date.toISOString().split("T")[0]:new Date(V.date).toISOString().split("T")[0])===N);return d?u.jsx("div",{className:"workout-loading",children:"Loading workouts..."}):u.jsxs("div",{className:"workout-page",children:[u.jsxs("div",{className:"workout-card",children:[u.jsx("h1",{className:"workout-title",children:i?"Edit Workout Session":"Log Workout Session"}),x&&u.jsx("div",{className:"error-message",children:x}),u.jsxs("form",{onSubmit:I,className:"workout-form",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Date",u.jsx("input",{type:"date",name:"date",value:r.date,onChange:C,className:"form-input",required:!0})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Workout Title",u.jsx("input",{type:"text",name:"title",value:r.title,onChange:C,className:"form-input",placeholder:"e.g., Morning Run, Gym Session",required:!0})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Workout Type",u.jsxs("select",{name:"type",value:r.type,onChange:C,className:"form-input",children:[u.jsx("option",{value:"General",children:"General"}),u.jsx("option",{value:"Cardio",children:"Cardio"}),u.jsx("option",{value:"Strength",children:"Strength Training"}),u.jsx("option",{value:"Yoga",children:"Yoga"}),u.jsx("option",{value:"Running",children:"Running"}),u.jsx("option",{value:"Cycling",children:"Cycling"}),u.jsx("option",{value:"Swimming",children:"Swimming"}),u.jsx("option",{value:"Walking",children:"Walking"}),u.jsx("option",{value:"HIIT",children:"HIIT"}),u.jsx("option",{value:"Other",children:"Other"})]})]})}),u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Duration / Length (Minutes)",u.jsx("input",{type:"number",name:"durationMinutes",value:r.durationMinutes,onChange:C,className:"form-input",min:"1",required:!0})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Calories Burned (Optional)",u.jsx("input",{type:"number",name:"caloriesBurned",value:r.caloriesBurned,onChange:C,className:"form-input",min:"0",placeholder:"0"})]})})]}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Notes (Optional)",u.jsx("textarea",{name:"notes",value:r.notes,onChange:C,className:"form-input form-textarea",placeholder:"How did it feel? Any achievements?",rows:"3"})]})}),u.jsxs("div",{className:"form-buttons",children:[u.jsx("button",{type:"submit",className:"log-button",disabled:m,children:m?i?"Updating...":"Logging...":i?"Update Workout":"Log Workout"}),i&&u.jsx("button",{type:"button",className:"cancel-button",onClick:D,disabled:m,children:"Cancel"})]})]})]}),u.jsxs("div",{className:"workout-log",children:[u.jsxs("h2",{className:"log-title",children:["Today's Workouts (",L.length,")"]}),L.length===0?u.jsx("p",{className:"no-workouts",children:"No workouts logged for today. Start your fitness journey!"}):u.jsx("ul",{className:"log-list",children:L.map(V=>u.jsxs("li",{className:"log-item",children:[u.jsxs("div",{className:"workout-info",children:[u.jsx("span",{className:"workout-title-display",children:V.title}),u.jsx("span",{className:"workout-type",children:V.type}),u.jsxs("span",{className:"workout-duration",children:[V.durationMinutes," min"]}),V.caloriesBurned>0&&u.jsxs("span",{className:"workout-calories",children:[V.caloriesBurned," cal"]}),V.notes&&u.jsx("span",{className:"workout-notes",children:V.notes})]}),u.jsxs("div",{className:"workout-actions",children:[u.jsx("button",{onClick:()=>v(V),className:"edit-button",disabled:m,children:"Edit"}),u.jsx("button",{onClick:()=>S(V.id),className:"delete-button",disabled:m,children:"Delete"})]})]},V.id))})]})]})}const Xr={silence:{name:"Silence",description:"Pure silence for traditional meditation",icon:"",neurological:"Promotes introspection and self-awareness",frequency:null,baseFreq:null},pink_noise_rain:{name:"Pink Noise Rain",description:"Synthetic pink noise for deep relaxation",icon:"",neurological:"Pink noise (1/f) - enhances deep sleep and memory consolidation",frequency:"pink_noise",baseFreq:200,waveType:"sawtooth"},alpha_waves:{name:"Ocean Waves",description:"Realistic ocean waves with alpha wave entrainment",icon:"",neurological:"Ocean rhythms (0.1 Hz) naturally entrain alpha waves (8-12 Hz) for relaxation",frequency:"ocean_waves",waveFrequency:.1,baseFreq:60,highFreq:200,alphaCarrier:200,alphaBeat:10,waveType:"sine"},earth_frequency:{name:"Earth Resonance",description:"Schumann resonance for grounding",icon:"",neurological:"Earth frequency (7.83 Hz) - natural grounding and balance",frequency:"earth_binaural",carrierFreq:136.1,waveType:"sine"},white_noise:{name:"White Noise",description:"Full spectrum noise for focus",icon:"",neurological:"White noise - masks distractions, improves concentration",frequency:"white_noise",baseFreq:440,waveType:"square"},gamma_focus:{name:"Gamma Focus",description:"High-frequency binaural beats for peak concentration",icon:"",neurological:"Gamma waves (40 Hz) - heightened awareness and cognitive performance",frequency:"gamma",baseFreq:40,binauralBeat:40,leftEar:200,rightEar:240,waveType:"sine",premium:!0},theta_deep:{name:"Theta Deep State",description:"Deep theta waves for profound meditation",icon:"",neurological:"Theta waves (6 Hz) - deep meditation, creativity, and memory consolidation",frequency:"theta",baseFreq:6,binauralBeat:6,leftEar:200,rightEar:206,waveType:"sine",premium:!0},healing_bowls:{name:"Healing Harmonics",description:"432 Hz healing frequency with natural harmonics",icon:"",neurological:'432 Hz "healing frequency" with harmonic overtones for cellular resonance',frequency:"harmonic",baseFreq:432,harmonics:[432,648,864,1296],waveType:"triangle",premium:!0},delta_deep_sleep:{name:"Delta Deep Sleep",description:"0.5-4 Hz for deep sleep and regeneration",icon:"",neurological:"Delta waves (0.5-4 Hz) - deep sleep, physical healing, and immune system boost",frequency:"delta",baseFreq:2,binauralBeat:2,leftEar:200,rightEar:202,waveType:"sine",premium:!0},theta_creativity:{name:"Theta Creativity",description:"4-8 Hz for creativity and insight",icon:"",neurological:"Theta waves (4-8 Hz) - enhanced creativity, insight, and problem-solving",frequency:"theta",baseFreq:6,binauralBeat:6,leftEar:200,rightEar:206,waveType:"sine",premium:!0},alpha_relaxation:{name:"Alpha Relaxation",description:"8-12 Hz for relaxation and stress reduction",icon:"",neurological:"Alpha waves (8-12 Hz) - relaxation, stress reduction, and improved learning",frequency:"alpha",baseFreq:10,binauralBeat:10,leftEar:200,rightEar:210,waveType:"sine",premium:!0},beta_focus:{name:"Beta Focus",description:"13-30 Hz for focus and alertness",icon:"",neurological:"Beta waves (13-30 Hz) - focused attention, alertness, and cognitive performance",frequency:"beta",baseFreq:20,binauralBeat:20,leftEar:200,rightEar:220,waveType:"sine",premium:!0},gamma_insight:{name:"Gamma Insight",description:"30-100 Hz for insight and peak performance",icon:"",neurological:"Gamma waves (30-100 Hz) - insight, peak performance, and heightened awareness",frequency:"gamma",baseFreq:40,binauralBeat:40,leftEar:200,rightEar:240,waveType:"sine",premium:!0},anxiety_relief_528:{name:"Anxiety Relief (528 Hz)",description:"528 Hz frequency for anxiety and stress relief",icon:"",neurological:'528 Hz "Love frequency" - reduces anxiety, promotes healing, and DNA repair',frequency:"single_tone",baseFreq:528,waveType:"sine",premium:!0},depression_lift_639:{name:"Depression Lift (639 Hz)",description:"639 Hz frequency for emotional balance",icon:"",neurological:'639 Hz "Connection frequency" - improves relationships, emotional balance, and communication',frequency:"single_tone",baseFreq:639,waveType:"sine",premium:!0},confidence_boost_741:{name:"Confidence Boost (741 Hz)",description:"741 Hz frequency for self-expression and confidence",icon:"",neurological:'741 Hz "Expression frequency" - enhances self-expression, confidence, and creativity',frequency:"single_tone",baseFreq:741,waveType:"sine",premium:!0},intuition_852:{name:"Intuition (852 Hz)",description:"852 Hz frequency for intuition and spiritual awareness",icon:"",neurological:'852 Hz "Intuition frequency" - enhances intuition, spiritual awareness, and inner wisdom',frequency:"single_tone",baseFreq:852,waveType:"sine",premium:!0},solfeggio_396:{name:"Liberation (396 Hz)",description:"396 Hz Solfeggio frequency for fear and guilt release",icon:"",neurological:'396 Hz "Liberation frequency" - releases fear, guilt, and negative emotions',frequency:"single_tone",baseFreq:396,waveType:"sine",premium:!0},solfeggio_417:{name:"Transformation (417 Hz)",description:"417 Hz Solfeggio frequency for change and transformation",icon:"",neurological:'417 Hz "Transformation frequency" - facilitates change, transformation, and new beginnings',frequency:"single_tone",baseFreq:417,waveType:"sine",premium:!0},solfeggio_963:{name:"Awakening (963 Hz)",description:"963 Hz Solfeggio frequency for spiritual awakening",icon:"",neurological:'963 Hz "Awakening frequency" - spiritual awakening, connection to higher consciousness',frequency:"single_tone",baseFreq:963,waveType:"sine",premium:!0}},au={mindfulness:{name:"Mindfulness",description:"Present-moment awareness practice",duration:[5,10,15,20],icon:""},breathing:{name:"Breathing",description:"Focused breathwork exercises",duration:[3,5,10],icon:""},body_scan:{name:"Body Scan",description:"Progressive muscle relaxation",duration:[10,15,20],icon:""},loving_kindness:{name:"Loving Kindness",description:"Compassion and heart-opening meditation",duration:[5,10,15],icon:""},flow_state:{name:"Flow State",description:"Neurologically optimized for peak performance",duration:[5,7,10],icon:"",premium:!0}};function w1({children:t,fallback:e,showUpgrade:n=!0,feature:r="this feature",className:s=""}){const{isPremium:i,upgradeToPremium:o}=xn();return i?t:e||u.jsx("div",{className:`premium-gate ${s}`,children:u.jsxs("div",{className:"premium-lock",children:[u.jsx("div",{className:"lock-icon",children:""}),u.jsx("h3",{children:"Premium Feature"}),u.jsxs("p",{children:["Upgrade to unlock ",r]}),n&&u.jsx("button",{onClick:Xl,className:"unlock-button",children:"Upgrade to Premium - $4.99/month"})]})})}function IO(){const{user:t,isPremium:e}=xn(),[n,r]=R.useState([]),[s,i]=R.useState({date:z.formatLocalDate(new Date),durationMinutes:"",type:"mindfulness",soundscape:"silence",moodBefore:"",moodAfter:"",notes:""}),[o,a]=R.useState(!1),[c,d]=R.useState(null),[f,m]=R.useState(!0),[g,x]=R.useState(!1),[A,N]=R.useState(""),[C,I]=R.useState(!1),[v,S]=R.useState(0),[D,L]=R.useState(5),[V,_]=R.useState(!1),[y,E]=R.useState(!1),[T,P]=R.useState("silence");R.useEffect(()=>{console.log(" currentSoundscape changed to:",T)},[T]);const[b,k]=R.useState(""),[le,ve]=R.useState(null),[ne,Fe]=R.useState(null),[q,J]=R.useState(null),[ue,Pe]=R.useState(null),[we,Ne]=R.useState(null),[Ot,Xt]=R.useState(!1),[Jt,Tt]=R.useState(!1),Z=R.useRef(null);z.formatLocalDate(new Date),R.useEffect(()=>{(()=>{const B="wakeLock"in navigator;Xt(B),console.log(" Wake Lock API supported:",B)})()},[]),R.useEffect(()=>{const j=async()=>{if(t!=null&&t.uid)try{m(!0),console.log(" Fetching meditations for timezone:",z.getUserTimezone());const G=((await oi.fetchMeditationsByUser(t.uid)).meditations||[]).map(ee=>({...ee,localDate:z.formatLocalDate(ee.date),localDateTime:z.formatLocalDateTime(ee.date),relativeTime:z.getRelativeTime(ee.date),isToday:z.isToday(ee.date)}));r(G),console.log(" Loaded meditations with timezone data:",G.length)}catch(B){console.error("Error fetching meditations:",B),N("Failed to load meditation sessions")}finally{m(!1)}};t!=null&&t.uid&&j()},[t]),R.useEffect(()=>(console.log(" Audio effect triggered - isSessionActive:",C,"currentSoundscape:",T),C&&T!=="silence"&&(console.log(" Setting up audio for soundscape:",T),ir()),()=>{if(q)try{Array.isArray(q)?q.forEach(j=>{j.stop&&j.stop()}):q.stop&&q.stop()}catch(j){console.log("Audio cleanup error:",j)}}),[C,T]),R.useEffect(()=>(C&&!V?Z.current=setInterval(()=>{S(j=>{const B=j+1;return B>=180&&!y&&(E(!0),Oh()),B})},1e3):clearInterval(Z.current),()=>clearInterval(Z.current)),[C,V,y]),R.useEffect(()=>{C&&v>=D*60&&(console.log(" Timer completed! Auto-stopping session..."),console.log(" Final session stats:"),console.log("  - Duration:",Math.floor(v/60),"minutes"),console.log("  - Target:",D,"minutes"),console.log("  - Soundscape:",T),console.log("  - Deep state achieved:",y),console.log("  - Start time:",z.formatLocalDateTime(le)),pa(),it())},[C,v,D,T,y,le]);const he=n.filter(j=>j.isToday||z.isToday(j.date));console.log(" Today's meditations:",he.length),R.useEffect(()=>()=>{Ye(),Z.current&&clearInterval(Z.current)},[]);const Re=async()=>{try{if(!Ot)return console.log(" Wake Lock API not supported, using fallback methods"),!1;const j=await navigator.wakeLock.request("screen");return Ne(j),Tt(!0),console.log(" Wake lock activated"),j.addEventListener("release",()=>{console.log(" Wake lock was released"),Tt(!1),Ne(null)}),!0}catch(j){return console.error(" Failed to request wake lock:",j),!1}},Ye=()=>{try{we&&(we.release(),Ne(null),Tt(!1),console.log(" Wake lock released"))}catch(j){console.error(" Error releasing wake lock:",j)}},It=()=>!Ot&&(console.log(" Using fallback keep-awake methods"),ne&&ne.state==="suspended"&&ne.resume(),"vibrate"in navigator)?setInterval(()=>{navigator.vibrate(1)},3e4):null,ir=()=>{try{const j=new(window.AudioContext||window.webkitAudioContext);Fe(j);const B=j.createGain();B.connect(j.destination),B.gain.value=.1,Pe(B);const G=Xr[T];if(!(G!=null&&G.frequency)){console.log(" Silence selected");return}switch(G.frequency){case"gamma":case"theta":Bs(j,B,G);break;case"alpha":fa(j,B,G);break;case"ocean_waves":_c(j,B,G);break;case"earth_binaural":yc(j,B,G);break;case"harmonic":Vh(j,B,G.harmonics||[G.baseFreq]);break;case"pink_noise":vc(j,B);break;case"white_noise":ma(j,B);break;case"single_tone":case"natural":jh(j,B,G.baseFreq,G.waveType||"sine");break;default:console.log(" Unknown frequency type:",G.frequency)}}catch(j){console.error("Audio setup failed:",j)}},Bs=(j,B,G)=>{const ee=j.createOscillator();ee.frequency.setValueAtTime(G.leftEar,j.currentTime),ee.type=G.waveType||"sine";const ie=j.createOscillator();ie.frequency.setValueAtTime(G.rightEar,j.currentTime),ie.type=G.waveType||"sine";const ae=j.createStereoPanner();ae.pan.value=-1;const me=j.createStereoPanner();me.pan.value=1,ee.connect(ae),ae.connect(B),ie.connect(me),me.connect(B),ee.start(),ie.start(),J([ee,ie]),console.log(` Binaural beats: ${G.leftEar}Hz (L) / ${G.rightEar}Hz (R) = ${G.binauralBeat}Hz beat`)},fa=(j,B,G)=>{const ie=G.baseFreq,ae=j.createOscillator();ae.frequency.setValueAtTime(200,j.currentTime),ae.type=G.waveType||"sine";const me=j.createOscillator();me.frequency.setValueAtTime(200+ie,j.currentTime),me.type=G.waveType||"sine";const mt=j.createStereoPanner();mt.pan.value=-1;const Ue=j.createStereoPanner();Ue.pan.value=1,ae.connect(mt),mt.connect(B),me.connect(Ue),Ue.connect(B),ae.start(),me.start(),J([ae,me]),console.log(` Alpha binaural: 200Hz (L) / ${200+ie}Hz (R) = ${ie}Hz beat`)},yc=(j,B,G)=>{const ee=G.carrierFreq||136.1,ie=7.83,ae=j.createOscillator();ae.frequency.setValueAtTime(ee,j.currentTime),ae.type=G.waveType||"sine";const me=j.createOscillator();me.frequency.setValueAtTime(ee+ie,j.currentTime),me.type=G.waveType||"sine";const mt=j.createStereoPanner();mt.pan.value=-1;const Ue=j.createStereoPanner();Ue.pan.value=1,ae.connect(mt),mt.connect(B),me.connect(Ue),Ue.connect(B),ae.start(),me.start(),J([ae,me]),console.log(` Earth binaural: ${ee}Hz (L) / ${ee+ie}Hz (R) = ${ie}Hz Schumann beat`)},jh=(j,B,G,ee="sine")=>{const ie=j.createOscillator();ie.frequency.setValueAtTime(G,j.currentTime),ie.type=ee,ie.connect(B),ie.start(),J(ie),console.log(` Single tone: ${G}Hz (${ee})`)},Vh=(j,B,G)=>{const ee=G.map(ie=>{const ae=j.createOscillator();ae.frequency.setValueAtTime(ie,j.currentTime),ae.type="triangle";const me=j.createGain();return me.gain.value=.3/G.length,ae.connect(me),me.connect(B),ae.start(),ae});J(ee),console.log(` Harmonics: ${G.join(", ")}Hz`)},vc=(j,B)=>{const G=j.sampleRate*2,ee=j.createBuffer(1,G,j.sampleRate),ie=ee.getChannelData(0);for(let me=0;me<G;me++){let mt=0;for(let Ue=0;Ue<5;Ue++)mt+=(Math.random()*2-1)/Math.pow(2,Ue);ie[me]=mt*.1}const ae=j.createBufferSource();ae.buffer=ee,ae.loop=!0,ae.connect(B),ae.start(),J(ae),console.log(" Pink noise generated")},ma=(j,B)=>{const G=j.sampleRate*2,ee=j.createBuffer(1,G,j.sampleRate),ie=ee.getChannelData(0);for(let me=0;me<G;me++)ie[me]=(Math.random()*2-1)*.1;const ae=j.createBufferSource();ae.buffer=ee,ae.loop=!0,ae.connect(B),ae.start(),J(ae),console.log(" White noise generated")},_c=(j,B,G)=>{const ee=[],ie=j.createOscillator();ie.frequency.setValueAtTime(20,j.currentTime),ie.type="sine";const ae=j.createGain();ae.gain.value=.4;const me=j.createOscillator();me.frequency.setValueAtTime(396,j.currentTime),me.type="sine";const mt=j.createGain();mt.gain.value=.05;const Ue=j.createOscillator();Ue.frequency.setValueAtTime(.15,j.currentTime),Ue.type="sine";const zs=j.createGain();zs.gain.value=.3,Ue.connect(zs),zs.connect(ae.gain),ie.connect(ae),ae.connect(B),me.connect(mt),mt.connect(B);const Bi=j.createBuffer(1,j.sampleRate*8,j.sampleRate),Ln=Bi.getChannelData(0);let zi=0;for(let Xe=0;Xe<Ln.length;Xe++){const Mt=Math.random()*2-1;zi=(zi+Mt*.02)*.99;const pt=Math.sin(Xe*.001)*.3+.7;Ln[Xe]=zi*pt*.5}const Fn=j.createBufferSource();Fn.buffer=Bi,Fn.loop=!0;const Vr=j.createOscillator();Vr.frequency.setValueAtTime(432,j.currentTime),Vr.type="triangle";const Un=j.createGain();Un.gain.value=.08;const Or=j.createBiquadFilter();Or.type="bandpass",Or.frequency.setValueAtTime(300,j.currentTime),Or.Q.setValueAtTime(.8,j.currentTime);const Ze=j.createGain();Ze.gain.value=.3;const Mr=j.createOscillator();Mr.frequency.setValueAtTime(.13,j.currentTime),Mr.type="triangle";const Bn=j.createGain();Bn.gain.value=.25,Mr.connect(Bn),Bn.connect(Ze.gain),Bn.connect(Un.gain),Fn.connect(Or),Or.connect(Ze),Ze.connect(B),Vr.connect(Un),Un.connect(B);const Lr=j.createBuffer(1,j.sampleRate*6,j.sampleRate),Ic=Lr.getChannelData(0);for(let Xe=0;Xe<Ic.length;Xe++){let Mt=0;for(let zn=0;zn<3;zn++)Mt+=(Math.random()*2-1)*Math.pow(.5,zn);const pt=Math.random()>.98?(Math.random()*2-1)*.3:0;Ic[Xe]=(Mt+pt)*.15}const $s=j.createBufferSource();$s.buffer=Lr,$s.loop=!0;const fn=j.createOscillator();fn.frequency.setValueAtTime(528,j.currentTime),fn.type="sine";const $i=j.createGain();$i.gain.value=.06;const Wi=j.createBiquadFilter();Wi.type="highpass",Wi.frequency.setValueAtTime(1500,j.currentTime);const or=j.createGain();or.gain.value=.12;const Fr=j.createOscillator();Fr.frequency.setValueAtTime(.5,j.currentTime),Fr.type="sine";const Ur=j.createGain();if(Ur.gain.value=.04,Fr.connect(Ur),Ur.connect(or.gain),Ur.connect($i.gain),$s.connect(Wi),Wi.connect(or),or.connect(B),fn.connect($i),$i.connect(B),G.alphaCarrier&&G.alphaBeat){const Xe=j.createOscillator();Xe.frequency.setValueAtTime(G.alphaCarrier,j.currentTime),Xe.type="sine";const Mt=j.createOscillator();Mt.frequency.setValueAtTime(G.alphaCarrier+G.alphaBeat,j.currentTime),Mt.type="sine";const pt=j.createGain();pt.gain.value=.03;const zn=j.createStereoPanner();zn.pan.value=-1;const qs=j.createStereoPanner();qs.pan.value=1,Xe.connect(zn),zn.connect(pt),Mt.connect(qs),qs.connect(pt),pt.connect(B),ee.push(Xe,Mt),Xe.start(),Mt.start()}const Ws=j.createBuffer(1,j.sampleRate*10,j.sampleRate),kn=Ws.getChannelData(0);for(let Xe=0;Xe<kn.length;Xe++){let Mt=0;for(let pt=0;pt<4;pt++)Mt+=(Math.random()*2-1)/Math.pow(2,pt*.7);kn[Xe]=Mt*.2}const Br=j.createBufferSource();Br.buffer=Ws,Br.loop=!0;const zr=j.createBiquadFilter();zr.type="bandpass",zr.frequency.setValueAtTime(150,j.currentTime),zr.Q.setValueAtTime(.4,j.currentTime);const $r=j.createGain();$r.gain.value=.15;const ar=j.createOscillator();ar.frequency.setValueAtTime(.07,j.currentTime),ar.type="sine";const qi=j.createGain();qi.gain.value=.1,ar.connect(qi),qi.connect($r.gain),Br.connect(zr),zr.connect($r),$r.connect(B),ie.start(),me.start(),Ue.start(),Fn.start(),Vr.start(),Mr.start(),$s.start(),fn.start(),Fr.start(),Br.start(),ar.start(),ee.push(ie,me,Ue,Fn,Vr,Mr,$s,fn,Fr,Br,ar),J(ee),console.log(" Healing Ocean Waves: 396Hz (Liberation) + 432Hz (Earth) + 528Hz (Love) + Alpha binaural beats + Realistic ocean sounds")},Oh=()=>{console.log(" Deep state achieved at:",z.formatLocalDateTime(new Date)),"Notification"in window&&Notification.permission==="granted"&&new Notification("Deep State Achieved! ",{body:`You've entered a deep meditative state at ${z.formatLocalTime(new Date)}. Well done!`,icon:"/meditation-icon.png"})},pa=()=>{console.log(" Session completed at:",z.formatLocalDateTime(new Date)),"Notification"in window&&Notification.permission==="granted"&&new Notification("Meditation Complete! ",{body:`Great job! You completed your ${D}-minute meditation session.`,icon:"/meditation-icon.png"});try{const j=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBhqXy/HVgzQIHm/J7+OZSA8PU6fm77BdGAcugtTxzD2sLYPs7lkgCBl5gQEDgVs+l4G6tGEcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEcBhqXy/HVgzQIHm/J7+OZSA8PU6fm77BdGAc=");j.volume=.3,j.play().catch(()=>{})}catch{}},ga=async(j,B,G)=>{const ee=z.getCurrentLocalTime();if(console.log(" Starting meditation session in timezone:",z.getUserTimezone()),console.log(" Session start time:",z.formatLocalDateTime(ee)),console.log(" Selected soundscape:",G),L(j),S(0),I(!0),_(!1),E(!1),ve(ee),!await Re()){console.log(" Wake lock failed, using fallback methods");const ae=It();ae&&(Z.current=ae)}"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()},wc=()=>{const j=z.getCurrentLocalTime();console.log(" Session paused at:",z.formatLocalDateTime(j)),_(!V),q&&ne&&(V?ne.resume():ne.suspend())},it=async()=>{const j=z.getCurrentLocalTime();if(console.log(" Session ended at:",z.formatLocalDateTime(j)),console.log(" Session duration:",Math.floor(v/60),"minutes"),console.log(" Target duration:",D,"minutes"),console.log(" Session completed?",v>=D*60),Ye(),q){if(Array.isArray(q))q.forEach(B=>{try{B.stop?B.stop():B.disconnect&&B.disconnect()}catch(G){console.log("Oscillator cleanup:",G)}});else try{q.stop?q.stop():q.disconnect&&q.disconnect()}catch(B){console.log("Oscillator cleanup:",B)}J(null)}if(ne){try{await ne.close()}catch(B){console.log("AudioContext cleanup:",B)}Fe(null)}if(I(!1),_(!1),v>=60){console.log(" Auto-logging session (duration >= 1 minute)"),console.log(" Session time check:",v,"seconds"),console.log(" Firebase user:",t==null?void 0:t.uid),console.log(" Session start time:",le);try{await ft(),console.log(" Auto-log completed successfully")}catch(B){console.error(" Auto-log failed:",B)}}else console.log(" Session too short, not logging (< 1 minute)");console.log(" Audio stopped and session ended successfully")},ft=async()=>{if(!(!(t!=null&&t.uid)||!le))try{console.log(" Auto-logging session with timezone data"),console.log(" Session start time:",z.formatLocalDateTime(le)),console.log(" Session duration:",Math.floor(v/60),"minutes");const j={date:le,durationMinutes:Math.floor(v/60),type:"mindfulness",soundscape:T,completed:v>=D*60,deepStateAchieved:y,moodBefore:b,targetDuration:D,sessionStartTime:le,sessionEndTime:z.getCurrentLocalTime(),userTimezone:z.getUserTimezone()};console.log(" Session data being saved:",j);const B=await oi.logMeditation(t.uid,j);console.log(" API Response:",B);const G={...B.meditation,localDate:z.formatLocalDate(B.meditation.date),localDateTime:z.formatLocalDateTime(B.meditation.date),relativeTime:z.getRelativeTime(B.meditation.date),isToday:z.isToday(B.meditation.date)};console.log(" Adding meditation to UI:",G),console.log(" Is today?",G.isToday),console.log(" Local date:",G.localDate),r(ee=>{const ie=[G,...ee];return console.log(" Updated meditations list:",ie.length,"total"),ie}),console.log(" Session auto-logged and added to UI successfully")}catch(j){console.error(" Error auto-logging session:",j),console.error(" Error details:",j.message)}},hn=j=>{const{name:B,value:G}=j.target;i(ee=>({...ee,[B]:G}))},Ec=async j=>{if(j.preventDefault(),!!(t!=null&&t.uid)){x(!0),N("");try{console.log(" Submitting meditation in timezone:",z.getUserTimezone());const B=s.date?z.toLocalTimezone(s.date):z.getCurrentLocalTime(),G={...s,date:B,durationMinutes:parseInt(s.durationMinutes),userTimezone:z.getUserTimezone()};if(console.log(" Meditation submit data:",G),console.log(" Local meditation time:",z.formatLocalDateTime(B)),o)await oi.updateMeditation(t.uid,c,G),r(ee=>ee.map(ie=>ie.id===c?{...ie,...G,localDate:z.formatLocalDate(B),localDateTime:z.formatLocalDateTime(B),relativeTime:z.getRelativeTime(B),isToday:z.isToday(B)}:ie)),a(!1),d(null),console.log(" Meditation updated successfully");else{const ee=await oi.logMeditation(t.uid,G),ie={...ee.meditation,localDate:z.formatLocalDate(ee.meditation.date),localDateTime:z.formatLocalDateTime(ee.meditation.date),relativeTime:z.getRelativeTime(ee.meditation.date),isToday:z.isToday(ee.meditation.date)};r(ae=>[ie,...ae]),console.log(" Meditation logged successfully")}i({date:z.formatLocalDate(new Date),durationMinutes:"",type:"mindfulness",soundscape:"silence",moodBefore:"",moodAfter:"",notes:""})}catch(B){console.error("Error saving meditation:",B),N(o?"Failed to update meditation":"Failed to log meditation")}finally{x(!1)}}},Tc=j=>{var B;console.log(" Editing meditation from:",z.formatLocalDateTime(j.date)),i({date:z.formatLocalDate(j.date),durationMinutes:((B=j.durationMinutes)==null?void 0:B.toString())||"",type:j.type||"mindfulness",soundscape:j.soundscape||"silence",moodBefore:j.moodBefore||"",moodAfter:j.moodAfter||"",notes:j.notes||""}),a(!0),d(j.id)},Mh=async j=>{if(!(t!=null&&t.uid))return;const B=n.find(ee=>ee.id===j),G=`Are you sure you want to delete the meditation session from ${(B==null?void 0:B.localDateTime)||"unknown time"}?`;if(window.confirm(G))try{await oi.deleteMeditation(t.uid,j),r(ee=>ee.filter(ie=>ie.id!==j)),console.log(" Meditation deleted successfully")}catch(ee){console.error("Error deleting meditation:",ee),N("Failed to delete meditation")}},jr=j=>{const B=Math.floor(j/60),G=j%60;return`${B}:${G.toString().padStart(2,"0")}`};return f?u.jsxs("div",{className:"meditation-loading",children:[u.jsx("p",{children:"Loading meditations..."}),u.jsxs("small",{children:["Timezone: ",z.getUserTimezone()]})]}):u.jsxs("div",{className:"meditation-page",children:[C&&u.jsxs("div",{className:"session-interface",children:[u.jsxs("div",{className:"session-header",children:[u.jsx("h2",{children:" Meditation Session"}),u.jsxs("div",{className:"session-info",children:[u.jsxs("div",{className:"session-soundscape",children:[Xr[T].icon," ",Xr[T].name]}),u.jsxs("div",{className:"session-time-info",children:["Started: ",le?z.formatLocalTime(le):"Now",u.jsx("br",{}),u.jsx("small",{children:z.getUserTimezone()})]}),u.jsx("div",{className:"wake-lock-status",children:Jt?u.jsx("span",{className:"wake-lock-active",title:"Screen will stay awake during meditation",children:" Screen Awake"}):Ot?u.jsx("span",{className:"wake-lock-inactive",title:"Screen may sleep during meditation",children:" Screen May Sleep"}):u.jsx("span",{className:"wake-lock-unsupported",title:"Wake lock not supported on this device",children:" Using Fallback"})})]})]}),u.jsxs("div",{className:"session-timer",children:[u.jsxs("div",{className:"time-display",children:[u.jsx("span",{className:"current-time",children:jr(v)}),u.jsxs("span",{className:"target-time",children:["/ ",jr(D*60)]})]}),u.jsx("div",{className:"progress-ring",children:u.jsx("div",{className:"meditation-progress-fill",style:{background:`conic-gradient(#4CAF50 ${v/(D*60)*360}deg, #eee 0deg)`}})})]}),u.jsxs("div",{className:"session-status",children:[y&&u.jsxs("div",{className:"deep-state-indicator",children:[" Deep State Achieved at ",z.formatLocalTime(new Date)," "]}),u.jsx("div",{className:"neurological-info",children:u.jsx("p",{children:Xr[T].neurological})})]}),u.jsxs("div",{className:"session-controls",children:[u.jsxs("button",{onClick:wc,className:"pause-btn",children:[V?"":""," ",V?"Resume":"Pause"]}),u.jsx("button",{onClick:it,className:"stop-btn",children:" End Session"})]})]}),!C&&u.jsxs("div",{className:"quick-start",children:[u.jsx("h1",{className:"meditation-title",children:" Meditation Studio"}),u.jsxs("p",{className:"subtitle",children:["Neurologically optimized for deep meditation states",u.jsx("br",{})]}),u.jsxs("div",{className:"soundscape-section",children:[u.jsx("h3",{children:" Step 1: Choose Your Soundscape"}),u.jsx("div",{className:"soundscape-instructions",children:u.jsx("p",{children:"Select a soundscape below (or choose silence for quiet meditation). Click again to deselect."})}),u.jsx("div",{className:"soundscape-grid",children:Object.entries(Xr).map(([j,B])=>u.jsxs("div",{className:`soundscape-option ${B.premium?"premium":""} ${T===j?"selected":""} ${B.premium&&!e?"locked":""}`,children:[u.jsxs("div",{className:"soundscape-header",children:[u.jsx("span",{className:"soundscape-icon",children:B.icon}),B.premium&&!e&&u.jsx("span",{className:"premium-badge",children:"PRO"})]}),u.jsxs("div",{className:"soundscape-content",onClick:G=>{G.stopPropagation(),G.preventDefault(),console.log(" Soundscape clicked:",j,"current selection:",T),!B.premium||e?T===j?(console.log(" Deselecting soundscape to silence"),P("silence")):(console.log(" Selecting soundscape:",j),P(j)):alert("This soundscape requires Clarity Premium. Upgrade to access premium features!")},children:[u.jsx("h4",{children:B.name}),u.jsx("p",{className:"soundscape-description",children:B.description}),u.jsx("small",{className:"neurological-note",children:B.neurological})]}),B.premium&&!e&&u.jsx("div",{className:"premium-overlay",children:u.jsx("span",{className:"lock-icon",children:""})})]},j))})]}),u.jsxs("div",{className:"quick-start-grid",children:[u.jsx("h3",{children:" Step 2: Choose Your Session"}),Object.entries(au).map(([j,B])=>u.jsxs("div",{className:`meditation-type ${B.premium?"premium":""}`,children:[u.jsxs("div",{className:"type-header",children:[u.jsx("span",{className:"type-icon",children:B.icon}),u.jsx("h3",{children:B.name}),B.premium&&!e&&u.jsx("span",{className:"premium-badge",children:"PRO"})]}),u.jsx("p",{className:"type-description",children:B.description}),u.jsx("div",{className:"duration-options",children:B.duration.map(G=>u.jsxs("button",{onClick:()=>{b||k(prompt("How are you feeling right now? ()")||""),ga(G,j,T)},className:"duration-btn",disabled:B.premium&&!e,children:[G,"min"]},G))})]},j))]})]}),!C&&u.jsxs("div",{className:"meditation-card",children:[u.jsx("h2",{className:"form-title",children:o?"Edit Meditation Session":"Manually Log Session"}),A&&u.jsx("div",{className:"error-message",children:A}),u.jsxs("form",{onSubmit:Ec,className:"meditation-form",children:[u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Date (",z.getUserTimezone(),")",u.jsx("input",{type:"date",name:"date",value:s.date,onChange:hn,className:"form-input",required:!0})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Duration (Minutes)",u.jsx("input",{type:"number",name:"durationMinutes",value:s.durationMinutes,onChange:hn,className:"form-input",min:"1",required:!0})]})})]}),u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Meditation Type",u.jsx("select",{name:"type",value:s.type,onChange:hn,className:"form-input",children:Object.entries(au).map(([j,B])=>u.jsx("option",{value:j,children:B.name},j))})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Soundscape Used",u.jsx("select",{name:"soundscape",value:s.soundscape,onChange:hn,className:"form-input",children:Object.entries(Xr).map(([j,B])=>u.jsx("option",{value:j,children:B.name},j))})]})})]}),u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Mood Before",u.jsxs("select",{name:"moodBefore",value:s.moodBefore,onChange:hn,className:"form-input",children:[u.jsx("option",{value:"",children:"Select mood..."}),u.jsx("option",{value:"",children:" Happy"}),u.jsx("option",{value:"",children:" Sad"}),u.jsx("option",{value:"",children:" Tired"}),u.jsx("option",{value:"",children:" Frustrated"}),u.jsx("option",{value:"",children:" Peaceful"}),u.jsx("option",{value:"",children:" Thoughtful"}),u.jsx("option",{value:"",children:" Excited"}),u.jsx("option",{value:"",children:" Anxious"})]})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Mood After",u.jsxs("select",{name:"moodAfter",value:s.moodAfter,onChange:hn,className:"form-input",children:[u.jsx("option",{value:"",children:"Select mood..."}),u.jsx("option",{value:"",children:" Happy"}),u.jsx("option",{value:"",children:" Sad"}),u.jsx("option",{value:"",children:" Tired"}),u.jsx("option",{value:"",children:" Frustrated"}),u.jsx("option",{value:"",children:" Peaceful"}),u.jsx("option",{value:"",children:" Thoughtful"}),u.jsx("option",{value:"",children:" Excited"}),u.jsx("option",{value:"",children:" Anxious"})]})]})})]}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Notes (Optional)",u.jsx("textarea",{name:"notes",value:s.notes,onChange:hn,className:"form-input form-textarea",placeholder:"How did the session feel? Any insights?",rows:"3"})]})}),u.jsxs("div",{className:"form-buttons",children:[u.jsx("button",{type:"submit",className:"log-button",disabled:g,children:g?o?"Updating...":"Logging...":o?"Update Session":"Log Session"}),o&&u.jsx("button",{type:"button",className:"cancel-button",onClick:()=>{a(!1),d(null),i({date:z.formatLocalDate(new Date),durationMinutes:"",type:"mindfulness",soundscape:"silence",moodBefore:"",moodAfter:"",notes:""})},disabled:g,children:"Cancel"})]})]})]}),!C&&u.jsxs("div",{className:"meditation-log",children:[u.jsxs("h2",{className:"log-title",children:["Today's Sessions (",he.length,")",u.jsx("br",{}),u.jsxs("small",{children:[z.formatLocalDate(new Date)," - ",z.getUserTimezone()]})]}),he.length===0?u.jsxs("p",{className:"no-sessions",children:["No meditation sessions today. Start your mindfulness journey!",u.jsx("br",{}),u.jsxs("small",{children:["Local time: ",z.formatLocalDateTime(new Date)]})]}):u.jsx("ul",{className:"log-list",children:he.map(j=>{var B,G,ee,ie;return u.jsxs("li",{className:"log-item",children:[u.jsxs("div",{className:"meditation-info",children:[u.jsxs("div",{className:"meditation-header",children:[u.jsxs("span",{className:"meditation-type",children:[(B=au[j.type])==null?void 0:B.icon," ",((G=au[j.type])==null?void 0:G.name)||j.type]}),u.jsxs("span",{className:"meditation-time",children:[j.localDateTime,u.jsxs("small",{children:[" (",j.relativeTime,")"]})]})]}),u.jsxs("div",{className:"meditation-details",children:[u.jsxs("span",{className:"meditation-duration",children:[j.durationMinutes," min"]}),u.jsxs("span",{className:"meditation-soundscape",children:[(ee=Xr[j.soundscape])==null?void 0:ee.icon," ",(ie=Xr[j.soundscape])==null?void 0:ie.name]}),j.deepStateAchieved&&u.jsx("span",{className:"deep-state-badge",children:" Deep State"}),j.moodBefore&&j.moodAfter&&u.jsxs("span",{className:"mood-change",children:[j.moodBefore,"  ",j.moodAfter]})]}),j.notes&&u.jsx("div",{className:"meditation-notes",children:j.notes})]}),u.jsxs("div",{className:"meditation-actions",children:[u.jsx("button",{onClick:()=>Tc(j),className:"edit-button",disabled:g,children:"Edit"}),u.jsx("button",{onClick:()=>Mh(j.id),className:"delete-button",disabled:g,children:"Delete"})]})]},j.id)})})]}),!C&&u.jsxs("div",{className:"recommended-videos",children:[u.jsx("h2",{className:"recommended-title",children:" Guided Meditation Videos"}),u.jsxs("p",{className:"timezone-note",children:["Perfect for any time of day in ",z.getUserTimezone()]}),u.jsxs("div",{className:"video-tiles",children:[u.jsxs("a",{href:"https://www.youtube.com/watch?v=VpHz8Mb13_Y",target:"_blank",rel:"noopener noreferrer",className:"video-tile",children:[u.jsx("div",{className:"video-thumbnail",children:""}),u.jsx("p",{className:"video-title",children:"Relaxation and Positivity"})]}),u.jsxs("a",{href:"https://www.youtube.com/watch?v=CqnWMPuyT0g",target:"_blank",rel:"noopener noreferrer",className:"video-tile",children:[u.jsx("div",{className:"video-thumbnail",children:""}),u.jsx("p",{className:"video-title",children:"Self Love"})]}),u.jsxs("a",{href:"https://www.youtube.com/watch?v=056qll-07ak",target:"_blank",rel:"noopener noreferrer",className:"video-tile",children:[u.jsx("div",{className:"video-thumbnail",children:""}),u.jsx("p",{className:"video-title",children:"Stop Thinking"})]})]})]}),u.jsx(w1,{feature:"exclusive meditation experiences",children:u.jsxs("div",{className:"premium-meditation-features",children:[u.jsx("h3",{children:" Premium Meditation Experience"}),u.jsx("p",{children:"Unlock advanced features designed by neuroscientists:"}),u.jsxs("ul",{children:[u.jsx("li",{children:" Premium binaural soundscapes"}),u.jsx("li",{children:" Advanced session analytics"}),u.jsx("li",{children:" Personalized meditation recommendations"}),u.jsx("li",{children:" Smart session reminders based on your timezone"}),u.jsx("li",{children:" Mood tracking and insights"})]})]})})]})}function SO(){const{user:t}=xn(),[e,n]=R.useState([]),[r,s]=R.useState({date:"",amount:"",type:"water",notes:""}),[i,o]=R.useState(!1),[a,c]=R.useState(null),[d,f]=R.useState(!0),[m,g]=R.useState(!1),[x,A]=R.useState(""),[N,C]=R.useState(0),[I,v]=R.useState(64);new Date().toISOString().split("T")[0],R.useEffect(()=>{(async()=>{if(t!=null&&t.uid)try{f(!0);const b=await pn.fetchWaterIntakeByUser(t.uid);n(b.waterIntakes||[]);const k=await pn.getTodayWaterIntake(t.uid);C(k.totalOz||0),v(64)}catch(b){console.error("Error fetching water data:",b),A("Failed to load water intake data")}finally{f(!1)}})()},[t]);const S=P=>{const{name:b,value:k}=P.target;s(le=>({...le,[b]:k}))},D=async P=>{if(P.preventDefault(),console.log(" Water submit started"),console.log(" Form data:",r),console.log(" Firebase user:",t==null?void 0:t.uid),!(t!=null&&t.uid)){console.error(" No user ID found"),A("Please log in to save water intake");return}if(!r.amount||!r.date){A("Please fill in all required fields");return}try{g(!0),A("");let b;if(r.date){const ve=r.date.split("-"),ne=parseInt(ve[0]),Fe=parseInt(ve[1]),q=parseInt(ve[2]),J=new Date;console.log(" Water date parsing debug:"),console.log("  Form input:",r.date),console.log("  Split parts:",ve),console.log("  Parsed year:",ne),console.log("  Parsed month (human readable):",Fe),console.log("  Parsed day:",q),console.log("  Month for Date constructor (0-indexed):",Fe-1),b=new Date(ne,Fe-1,q,J.getHours(),J.getMinutes(),J.getSeconds()),console.log(" Created water date:",b),console.log(" Verify - Year:",b.getFullYear()),console.log(" Verify - Month (0-indexed):",b.getMonth()),console.log(" Verify - Month (human):",b.getMonth()+1),console.log(" Verify - Day:",b.getDate()),console.log(" Final formatted:",b.toLocaleDateString())}else b=new Date;const k={date:b,amount:parseFloat(r.amount),type:r.type,notes:r.notes};if(console.log(" Final water data:",k),console.log(" Will be saved as:",k.date.toLocaleDateString()),i)await pn.updateWaterIntake(t.uid,a,k),n(ve=>ve.map(ne=>ne.id===a?{...ne,...k}:ne)),o(!1),c(null);else{const ve=await pn.logWaterIntake(t.uid,k);n(ne=>[ve.waterIntake,...ne])}const le=await pn.getTodayWaterIntake(t.uid);C(le.totalOz||0),s({date:"",amount:"",type:"water",notes:""}),console.log(" Water intake logged successfully!")}catch(b){console.error(" Water logging error:",b),A(i?"Failed to update water intake":"Failed to log water intake")}finally{g(!1)}},L=P=>{var k;o(!0),c(P.id);const b=P.date instanceof Date?P.date.toISOString().split("T")[0]:new Date(P.date).toISOString().split("T")[0];s({date:b,amount:((k=P.amount)==null?void 0:k.toString())||"",type:P.type||"water",notes:P.notes||""})},V=async P=>{if(t!=null&&t.uid&&window.confirm("Are you sure you want to delete this water intake?"))try{await pn.deleteWaterIntake(t.uid,P),n(k=>k.filter(le=>le.id!==P));const b=await pn.getTodayWaterIntake(t.uid);C(b.totalOz||0)}catch(b){console.error("Error deleting water intake:",b),A("Failed to delete water intake")}},_=()=>{o(!1),c(null),s({date:"",amount:"",type:"water",notes:""})},y=async P=>{if(t!=null&&t.uid)try{g(!0);const b=new Date,k=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds());console.log(" Quick add date:",k),console.log(" Quick add formatted:",k.toLocaleDateString()),await pn.logWaterIntake(t.uid,{date:k,amount:P,type:"water",notes:""});const le=await pn.fetchWaterIntakeByUser(t.uid);n(le.waterIntakes||[]);const ve=await pn.getTodayWaterIntake(t.uid);C(ve.totalOz||0),console.log(" Quick add water successful!")}catch(b){console.error(" Error quick adding water:",b),A("Failed to log water intake")}finally{g(!1)}},E=e.filter(P=>{const b=P.date instanceof Date?P.date:new Date(P.date),k=z.isToday(b);return console.log(" Comparing dates:",{waterDate:b.toLocaleDateString(),today:new Date().toLocaleDateString(),isToday:k,waterDateObj:b,waterDateType:typeof P.date}),k}),T=Math.min(N/I*100,100);return d?u.jsx("div",{className:"water-loading",children:"Loading water data..."}):u.jsxs("div",{className:"water-page",children:[u.jsxs("div",{className:"water-progress",children:[u.jsx("h2",{children:"Daily Hydration Progress"}),u.jsx("div",{className:"progress-info",children:u.jsx("div",{className:"water-progress-bar",children:u.jsx("div",{className:"water-progress-fill",style:{width:`${T}%`}})})}),N>=I&&u.jsx("div",{className:"goal-achieved",children:" Daily goal achieved! Great job! "})]}),u.jsxs("div",{className:"quick-add-section",children:[u.jsx("h3",{children:"Quick Add"}),u.jsxs("div",{className:"quick-add-buttons",children:[u.jsxs("button",{onClick:()=>y(8),className:"quick-add-btn",disabled:m,children:["8 oz",u.jsx("br",{}),u.jsx("small",{children:"Glass"})]}),u.jsxs("button",{onClick:()=>y(16),className:"quick-add-btn",disabled:m,children:["16 oz",u.jsx("br",{}),u.jsx("small",{children:"Bottle"})]}),u.jsxs("button",{onClick:()=>y(20),className:"quick-add-btn",disabled:m,children:["20 oz",u.jsx("br",{}),u.jsx("small",{children:"Large Bottle"})]}),u.jsxs("button",{onClick:()=>y(32),className:"quick-add-btn",disabled:m,children:["32 oz",u.jsx("br",{}),u.jsx("small",{children:"Large Cup"})]})]})]}),u.jsxs("div",{className:"water-card",children:[u.jsx("h1",{className:"water-title",children:i?"Edit Water Intake":"Log Water Intake"}),x&&u.jsx("div",{className:"error-message",children:x}),u.jsxs("form",{onSubmit:D,className:"water-form",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Date",u.jsx("input",{type:"date",name:"date",value:r.date,onChange:S,className:"form-input",required:!0})]})}),u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Amount (oz)",u.jsx("input",{type:"number",name:"amount",value:r.amount,onChange:S,className:"form-input",min:"0.1",step:"0.1",required:!0})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Drink Type",u.jsxs("select",{name:"type",value:r.type,onChange:S,className:"form-input",children:[u.jsx("option",{value:"water",children:"Water"}),u.jsx("option",{value:"tea",children:"Tea"}),u.jsx("option",{value:"coffee",children:"Coffee"}),u.jsx("option",{value:"juice",children:"Juice"}),u.jsx("option",{value:"sports_drink",children:"Sports Drink"}),u.jsx("option",{value:"other",children:"Other"})]})]})})]}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Notes (Optional)",u.jsx("input",{type:"text",name:"notes",value:r.notes,onChange:S,className:"form-input",placeholder:"e.g., with lemon, iced, etc."})]})}),u.jsxs("div",{className:"form-buttons",children:[u.jsx("button",{type:"submit",className:"log-button",disabled:m,children:m?i?"Updating...":"Logging...":i?"Update Intake":"Log Water"}),i&&u.jsx("button",{type:"button",className:"cancel-button",onClick:_,disabled:m,children:"Cancel"})]})]})]}),u.jsxs("div",{className:"water-log",children:[u.jsxs("h2",{className:"log-title",children:["Today's Water Intake (",E.length," entries)"]}),E.length===0?u.jsx("p",{className:"no-intake",children:"No water logged for today. Stay hydrated! "}):u.jsx("ul",{className:"log-list",children:E.map(P=>u.jsxs("li",{className:"log-item",children:[u.jsxs("div",{className:"water-info",children:[u.jsxs("span",{className:"water-amount",children:[P.amount," oz"]}),u.jsx("span",{className:"water-type",children:P.type}),P.notes&&u.jsx("span",{className:"water-notes",children:P.notes})]}),u.jsxs("div",{className:"water-actions",children:[u.jsx("button",{onClick:()=>L(P),className:"edit-button",disabled:m,children:"Edit"}),u.jsx("button",{onClick:()=>V(P.id),className:"delete-button",disabled:m,children:"Delete"})]})]},P.id))})]})]})}function xO(){const{user:t,isPremium:e}=xn(),[n,r]=R.useState({workout:{current:0,goal:210},water:{current:0,goal:448},meditation:{current:0,goal:105}}),[s,i]=R.useState([]),[o,a]=R.useState(0),[c,d]=R.useState(!0),[f,m]=R.useState(30),[g,x]=R.useState(64),[A,N]=R.useState(15),[C,I]=R.useState(0),[v,S]=R.useState(!1),[D,L]=R.useState(!1),[V,_]=R.useState(!1),[y,E]=R.useState(null),T=()=>{const he=new Date().getDay();return he===0?0:7-he};R.useEffect(()=>{(async()=>{if(t!=null&&t.uid)try{d(!0);const Re=(await ye.getUserProfile(t.uid)).user;m(Re.exerciseGoalMinutes||30),x(Re.waterGoalOz||64),N(Re.meditationGoalMinutes||15);const[Ye,It,ir]=await Promise.all([ii.getWorkoutSummary(t.uid,7),pn.getWaterSummary(t.uid,7),oi.getMeditationSummary(t.uid,7)]);r({workout:{current:Ye.totalMinutes||0,goal:(Re.exerciseGoalMinutes||30)*7},water:{current:It.totalOz||0,goal:(Re.waterGoalOz||64)*7},meditation:{current:ir.totalMinutes||0,goal:(Re.meditationGoalMinutes||15)*7}}),setTimeout(()=>we(),100)}catch(he){console.error("Error fetching weekly data:",he)}finally{d(!1)}})()},[t]),R.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const he=await ye.getPoints(t.uid);I(he)}})()},[t]),R.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const he=await ye.isChallengeCompleted(t.uid,"weekly_meditation_3","weekly");S(he)}})()},[t]),R.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const he=await ye.isChallengeCompleted(t.uid,"diamond_week","weekly"),Re=await ye.isChallengeCompleted(t.uid,"perfect_balance","weekly");L(he),_(Re)}})()},[t]),R.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const he=await ye.getUserProfile(t.uid);E(he.user.premiumSoundscapeUntil?new Date(he.user.premiumSoundscapeUntil):null)}})()},[t]);const P=new Date,b=C>=150&&(!y||y<P),k=y&&y>P,le=async()=>{if(!(t!=null&&t.uid)||!b)return;await ye.deductPoints(t.uid,150);const Z=new Date;Z.setDate(Z.getDate()+7),await ye.updateUserProfile(t.uid,{premiumSoundscapeUntil:Z}),E(Z);const he=await ye.getPoints(t.uid);I(he),alert("You unlocked Premium Soundscape for 1 week!")},ve=n.meditation.current/(A||15),ne=ve>=3,Fe=n.workout.current/n.workout.goal>=1.25&&n.water.current/n.water.goal>=1.25&&n.meditation.current/n.meditation.goal>=1.25,q=n.workout.current/n.workout.goal>=1&&n.water.current/n.water.goal>=1&&n.meditation.current/n.meditation.goal>=1,J=async()=>{if(!(t!=null&&t.uid)||v||!ne)return;await ye.addPoints(t.uid,50),await ye.completeChallenge(t.uid,"weekly_meditation_3","weekly"),S(!0);const Z=await ye.getPoints(t.uid);I(Z),alert("You claimed 50 points for the Weekly Meditation Challenge!")},ue=async()=>{if(!(t!=null&&t.uid)||D||!Fe)return;await ye.addPoints(t.uid,200),await ye.completeChallenge(t.uid,"diamond_week","weekly"),L(!0);const Z=await ye.getPoints(t.uid);I(Z),alert("You claimed 200 points for Diamond Week Challenge!")},Pe=async()=>{if(!(t!=null&&t.uid)||V||!q)return;await ye.addPoints(t.uid,150),await ye.completeChallenge(t.uid,"perfect_balance","weekly"),_(!0);const Z=await ye.getPoints(t.uid);I(Z),alert("You claimed 150 points for Perfect Balance Challenge!")},we=()=>{const Z=[];Object.entries(n).forEach(([he,Re])=>{const Ye=Re.current/Re.goal*100;Ye>=125?Z.push({type:he,level:"diamond",percentage:Ye}):Ye>=100?Z.push({type:he,level:"gold",percentage:Ye}):Ye>=75?Z.push({type:he,level:"silver",percentage:Ye}):Ye>=50&&Z.push({type:he,level:"bronze",percentage:Ye})}),i(Z)},Ne=Z=>{switch(Z){case"diamond":return"";case"gold":return"";case"silver":return"";case"bronze":return"";default:return""}},Ot=Z=>Z>=100?"var(--sage-500)":Z>=75?"var(--mint)":Z>=50?"#FFD700":"var(--sage-300)",Xt=Z=>Z>=100,Jt=async()=>{if(t!=null&&t.uid)try{d(!0);const Z=f*7,he=g*7,Re=A*7,Ye=await ye.updateUserProfile(t.uid,{exerciseGoalMinutes:f,meditationGoalMinutes:A,waterGoalOz:g});r(It=>({...It,workout:{...It.workout,goal:Z},water:{...It.water,goal:he},meditation:{...It.meditation,goal:Re}})),setTimeout(()=>we(),100),console.log(" Goals updated successfully")}catch(Z){console.error(" Error updating goals:",Z)}finally{d(!1)}};if(c)return u.jsx("div",{className:"goals-loading",children:"Loading weekly goals..."});const Tt=T();return u.jsxs("div",{className:"goals-page",children:[u.jsxs("div",{className:"points-balance",children:[u.jsx("span",{role:"img","aria-label":"points",children:""})," ",C," Points"]}),u.jsxs("div",{className:"weekly-header",children:[u.jsx("h1",{className:"goals-title",children:"Weekly Goals"}),u.jsx("p",{className:"goals-subtitle",children:"Track your progress and earn rewards"}),u.jsxs("div",{className:"week-info",children:[u.jsx("span",{className:"week-label",children:"Current Week"}),u.jsx("span",{className:"days-remaining",children:Tt===0?"Last day!":`${Tt} days remaining`})]})]}),u.jsx("div",{className:"weekly-progress",children:Object.entries(n).map(([Z,he])=>{const Re=Math.min(he.current/he.goal*100,100),Ye=Xt(Re),It=2*Math.PI*45,ir=It,Bs=It-Re/100*It;return u.jsxs("div",{className:`weekly-ring ${Ye?"completed":""}`,children:[u.jsxs("div",{className:"ring-container",children:[u.jsxs("svg",{className:"progress-ring",width:"120",height:"120",children:[u.jsx("circle",{className:"ring-background",cx:"60",cy:"60",r:"45",fill:"transparent",stroke:"var(--sage-100)",strokeWidth:"8"}),u.jsx("circle",{className:"ring-progress",cx:"60",cy:"60",r:"45",fill:"transparent",stroke:Ot(Re),strokeWidth:"8",strokeLinecap:"round",strokeDasharray:ir,strokeDashoffset:Bs,transform:"rotate(-90 60 60)"})]}),u.jsxs("div",{className:"ring-content",children:[u.jsx("span",{className:"ring-value",children:he.current}),u.jsxs("span",{className:"ring-goal",children:["/ ",he.goal]}),u.jsx("span",{className:"ring-label",children:Z})]})]}),u.jsxs("div",{className:"ring-percentage",children:[Math.round(Re),"%"]})]},Z)})}),u.jsxs("div",{className:"achievement-gallery",children:[u.jsx("h2",{className:"section-title",children:"This Week's Achievements"}),s.length===0?u.jsxs("div",{className:"no-achievements",children:[u.jsx("span",{className:"no-achievement-icon",children:""}),u.jsx("p",{children:"Keep going! Your first achievement is waiting."})]}):u.jsx("div",{className:"achievements-grid",children:s.map((Z,he)=>u.jsxs("div",{className:`achievement-card ${Z.level}`,children:[u.jsx("div",{className:"achievement-icon",children:Ne(Z.level)}),u.jsxs("div",{className:"achievement-info",children:[u.jsx("h4",{children:Z.level.toUpperCase()}),u.jsx("p",{children:Z.type.toUpperCase()}),u.jsxs("span",{className:"achievement-percentage",children:[Math.round(Z.percentage),"%"]})]}),!e&&Z.level==="diamond"&&u.jsx("div",{className:"premium-overlay",children:u.jsx("span",{className:"premium-badge",children:"PRO"})})]},he))})]}),u.jsxs("div",{className:"streak-section",children:[u.jsx("h2",{className:"section-title",children:"Weekly Streak"}),u.jsxs("div",{className:"streak-card",children:[u.jsx("div",{className:"streak-icon",children:""}),u.jsxs("div",{className:"streak-info",children:[u.jsx("span",{className:"streak-number",children:o}),u.jsx("span",{className:"streak-label",children:"Week Streak"})]}),u.jsxs("div",{className:"streak-next",children:[u.jsx("span",{children:"Next reward at 4 weeks"}),!e&&u.jsx("span",{className:"premium-hint",children:"PRO"})]})]})]}),u.jsxs("div",{className:"reward-marketplace",children:[u.jsx("h2",{className:"section-title",children:"Reward Marketplace"}),e?u.jsxs("div",{className:"rewards-grid",children:[u.jsxs("div",{className:"reward-item",children:[u.jsx("div",{className:"reward-icon",children:""}),u.jsxs("div",{className:"reward-info",children:[u.jsx("h4",{children:"Premium Soundscape"}),u.jsx("p",{children:"Unlock for 1 week"}),u.jsx("span",{className:"reward-cost",children:"150 points"}),u.jsx("button",{className:"claim-btn",onClick:le,disabled:!b,children:k?"Active":"Redeem"}),k&&u.jsxs("div",{className:"reward-status",children:["Active until ",y==null?void 0:y.toLocaleDateString()]})]})]}),u.jsxs("div",{className:"reward-item",children:[u.jsx("div",{className:"reward-icon",children:""}),u.jsxs("div",{className:"reward-info",children:[u.jsx("h4",{children:"Custom Badge"}),u.jsx("p",{children:"Design your own"}),u.jsx("span",{className:"reward-cost",children:"100 points"})]})]})]}):u.jsxs("div",{className:"premium-cta-card",children:[u.jsxs("div",{className:"cta-header",children:[u.jsx("h3",{children:"Unlock Premium Rewards"}),u.jsx("span",{className:"cta-price",children:"$4.99/month"})]}),u.jsxs("div",{className:"premium-features",children:[u.jsxs("div",{className:"feature-item",children:[u.jsx("span",{className:"feature-icon",children:""}),u.jsx("span",{children:"Exclusive Diamond badges"})]}),u.jsxs("div",{className:"feature-item",children:[u.jsx("span",{className:"feature-icon",children:""}),u.jsx("span",{children:"Custom goal setting"})]}),u.jsxs("div",{className:"feature-item",children:[u.jsx("span",{className:"feature-icon",children:""}),u.jsx("span",{children:"Advanced analytics"})]}),u.jsxs("div",{className:"feature-item",children:[u.jsx("span",{className:"feature-icon",children:""}),u.jsx("span",{children:"Challenge competitions"})]})]}),u.jsx("button",{className:"upgrade-button",onClick:Xl,children:"Upgrade with Stripe"})]})]}),u.jsxs("div",{className:"weekly-challenges",children:[u.jsx("h2",{className:"section-title",children:"Weekly Challenges"}),u.jsxs("div",{className:"challenge-card",children:[u.jsxs("div",{className:"challenge-header",children:[u.jsx("h3",{children:"Mindful Monday"}),u.jsx("span",{className:"challenge-reward",children:"+50 points"}),u.jsx("button",{className:"claim-btn",onClick:J,disabled:!ne||v,children:v?"Claimed":"Claim"})]}),u.jsx("p",{className:"challenge-description",children:"Complete 3 meditation sessions this week"}),u.jsxs("div",{className:"challenge-progress",children:[u.jsx("div",{className:"challenge-bar",children:u.jsx("div",{className:"challenge-fill",style:{width:`${Math.min(ve/3*100,100)}%`}})}),u.jsxs("span",{className:"challenge-status",children:[Math.floor(ve),"/3 completed"]})]}),!e&&u.jsx("div",{className:"challenge-premium",children:u.jsx("span",{children:"Join Premium for exclusive challenges"})})]})]}),u.jsxs("div",{className:"custom-goals-section",children:[u.jsx("h2",{className:"section-title",children:"Goal Customization"}),u.jsxs("div",{className:"custom-goals-form",children:[u.jsxs("div",{className:"goal-slider",children:[u.jsxs("label",{children:["Daily Workout Goal: ",f," minutes"]}),u.jsx("input",{type:"range",min:"15",max:"120",value:f,onChange:Z=>m(parseInt(Z.target.value)),className:"goal-range"}),u.jsxs("span",{children:["Weekly Goal: ",f*7," minutes"]})]}),u.jsxs("div",{className:"goal-slider",children:[u.jsxs("label",{children:["Daily Water Goal: ",g," oz"]}),u.jsx("input",{type:"range",min:"32",max:"128",value:g,onChange:Z=>x(parseInt(Z.target.value)),className:"goal-range"}),u.jsxs("span",{children:["Weekly Goal: ",g*7," oz"]})]}),u.jsxs("div",{className:"goal-slider",children:[u.jsxs("label",{children:["Daily Meditation Goal: ",A," minutes"]}),u.jsx("input",{type:"range",min:"5",max:"60",value:A,onChange:Z=>N(parseInt(Z.target.value)),className:"goal-range"}),u.jsxs("span",{children:["Weekly Goal: ",A*7," minutes"]})]}),u.jsx("button",{className:"save-goals-btn",onClick:Jt,disabled:c,children:c?"Saving...":"Save Custom Goals"})]})]}),u.jsxs("div",{className:"premium-challenges",children:[u.jsx("h2",{className:"section-title",children:"Exclusive Challenges"}),u.jsx(w1,{feature:"premium challenges",className:"feature-tease",children:u.jsxs("div",{className:"challenge-preview",children:[u.jsxs("div",{className:"challenge-card premium",children:[u.jsx("div",{className:"challenge-icon",children:""}),u.jsxs("div",{className:"challenge-content",children:[u.jsxs("div",{className:"challenge-header",children:[u.jsx("h3",{children:"Diamond Week Challenge"}),u.jsx("span",{className:"challenge-reward",children:"+200 points"}),u.jsx("button",{className:"claim-btn",onClick:ue,disabled:!Fe||D,children:D?"Claimed":"Claim"})]}),u.jsx("p",{children:"Complete 125% of all goals for 7 consecutive days"}),u.jsx("div",{className:"challenge-participants",children:u.jsx("span",{children:" 1,247 participants this week"})})]})]}),u.jsxs("div",{className:"challenge-card premium",children:[u.jsx("div",{className:"challenge-icon",children:""}),u.jsxs("div",{className:"challenge-content",children:[u.jsxs("div",{className:"challenge-header",children:[u.jsx("h3",{children:"Perfect Balance"}),u.jsx("span",{className:"challenge-reward",children:"+150 points"}),u.jsx("button",{className:"claim-btn",onClick:Pe,disabled:!q||V,children:V?"Claimed":"Claim"})]}),u.jsx("p",{children:"Hit exactly 100% on all three goals in one day"}),u.jsx("div",{className:"challenge-participants",children:u.jsx("span",{children:" 892 members completed"})})]})]})]})})]})]})}function kO(){const{user:t,loading:e,isPremium:n,userSubscription:r,trialDaysRemaining:s,upgradeToPremium:i,cancelSubscription:o}=xn(),[a,c]=R.useState(null),[d,f]=R.useState({username:"",email:"",firstName:"",lastName:"",exerciseGoalMinutes:"",waterGoalOz:"",meditationGoalMinutes:""}),[m,g]=R.useState(!0),[x,A]=R.useState(!1),[N,C]=R.useState(""),[I,v]=R.useState("");R.useEffect(()=>{const V=async()=>{if(t!=null&&t.uid)try{g(!0);const _=await ye.getUserProfile(t.uid);c(_.user)}catch(_){console.error("Error fetching profile:",_),v("Failed to load profile data")}finally{g(!1)}};t!=null&&t.uid&&V()},[t]),R.useEffect(()=>{a&&f({username:a.username||"",email:a.email||"",firstName:a.firstName||"",lastName:a.lastName||"",exerciseGoalMinutes:a.exerciseGoalMinutes||"",waterGoalOz:a.waterGoalOz||"",meditationGoalMinutes:a.meditationGoalMinutes||""})},[a]);const S=V=>{const{name:_,value:y}=V.target;f(E=>({...E,[_]:y}))},D=async V=>{if(V.preventDefault(),!!(t!=null&&t.uid)){A(!0),v(""),C("");try{console.log("Submitting profile update:",d);const _={...d,exerciseGoalMinutes:parseInt(d.exerciseGoalMinutes)||30,waterGoalOz:parseInt(d.waterGoalOz)||64,meditationGoalMinutes:parseInt(d.meditationGoalMinutes)||10};await ye.updateUserProfile(t.uid,_),c({...a,..._}),C("Profile updated successfully!"),setTimeout(()=>C(""),3e3)}catch(_){console.error("Error updating profile:",_),v("Failed to update profile. Please try again.")}finally{A(!1)}}},L=()=>{a&&f({username:a.username||"",email:a.email||"",firstName:a.firstName||"",lastName:a.lastName||"",exerciseGoalMinutes:a.exerciseGoalMinutes||"",waterGoalOz:a.waterGoalOz||"",meditationGoalMinutes:a.meditationGoalMinutes||""}),v(""),C("")};return e||m?u.jsx("div",{className:"profile-loading",children:"Loading profile..."}):t?u.jsx("div",{className:"profile-page",children:u.jsxs("div",{className:"profile-card",children:[u.jsxs("div",{className:"profile-header",children:[u.jsx("h1",{className:"profile-title",children:"Personal Information"}),u.jsx("p",{className:"profile-subtitle",children:"Update your profile and wellness goals"})]}),N&&u.jsx("div",{className:"success-message",children:N}),I&&u.jsx("div",{className:"error-message",children:I}),a&&u.jsxs("form",{onSubmit:D,className:"profile-form",children:[u.jsxs("div",{className:"form-section",children:[u.jsx("h3",{className:"section-title",children:"Account Information"}),u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Username",u.jsx("input",{type:"text",name:"username",value:d.username,onChange:S,className:"form-input",required:!0})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Email",u.jsx("input",{type:"email",name:"email",value:d.email,onChange:S,className:"form-input",required:!0})]})})]}),u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["First Name",u.jsx("input",{type:"text",name:"firstName",value:d.firstName,onChange:S,className:"form-input",required:!0})]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"form-label",children:["Last Name",u.jsx("input",{type:"text",name:"lastName",value:d.lastName,onChange:S,className:"form-input",required:!0})]})})]})]}),u.jsxs("div",{className:"form-section",children:[u.jsx("h3",{className:"section-title",children:"Daily Wellness Goals"}),u.jsx("p",{className:"section-description",children:"Set your daily targets to track your progress effectively"}),u.jsxs("div",{className:"goals-grid",children:[u.jsx("div",{className:"form-group goal-group",children:u.jsxs("label",{className:"form-label",children:[u.jsx("span",{className:"goal-icon",children:""}),"Exercise Goal (Minutes)",u.jsx("input",{type:"number",name:"exerciseGoalMinutes",value:d.exerciseGoalMinutes,onChange:S,className:"form-input",min:"1",max:"300",required:!0}),u.jsx("small",{className:"input-help",children:"Recommended: 30-60 minutes"})]})}),u.jsx("div",{className:"form-group goal-group",children:u.jsxs("label",{className:"form-label",children:[u.jsx("span",{className:"goal-icon",children:""}),"Water Goal (Oz)",u.jsx("input",{type:"number",name:"waterGoalOz",value:d.waterGoalOz,onChange:S,className:"form-input",min:"1",max:"200",required:!0}),u.jsx("small",{className:"input-help",children:"Recommended: 64-100 oz"})]})}),u.jsx("div",{className:"form-group goal-group",children:u.jsxs("label",{className:"form-label",children:[u.jsx("span",{className:"goal-icon",children:""}),"Meditation Goal (Minutes)",u.jsx("input",{type:"number",name:"meditationGoalMinutes",value:d.meditationGoalMinutes,onChange:S,className:"form-input",min:"1",max:"120",required:!0}),u.jsx("small",{className:"input-help",children:"Recommended: 5-20 minutes"})]})})]})]}),u.jsxs("div",{className:"form-actions",children:[u.jsx("button",{type:"button",className:"reset-button",onClick:L,disabled:x,children:"Reset Changes"}),u.jsx("button",{type:"submit",className:"save-button",disabled:x,children:x?"Saving...":"Save Profile"})]})]}),u.jsxs("div",{className:"profile-stats",children:[u.jsx("h3",{className:"section-title",children:"Account Summary"}),u.jsxs("div",{className:"stats-grid",children:[u.jsxs("div",{className:"stat-item",children:[u.jsx("span",{className:"stat-label",children:"Member Since"}),u.jsx("span",{className:"stat-value",children:a!=null&&a.createdAt?new Date(a.createdAt.seconds*1e3).toLocaleDateString():"N/A"})]}),u.jsxs("div",{className:"stat-item",children:[u.jsx("span",{className:"stat-label",children:"Profile Updated"}),u.jsx("span",{className:"stat-value",children:a!=null&&a.updatedAt?new Date(a.updatedAt.seconds*1e3).toLocaleDateString():"N/A"})]}),u.jsxs("div",{className:"stat-item",children:[u.jsx("span",{className:"stat-label",children:"Goals Set"}),u.jsxs("span",{className:"stat-value",children:[[d.exerciseGoalMinutes,d.waterGoalOz,d.meditationGoalMinutes].filter(V=>V&&V>0).length," / 3"]})]})]})]}),u.jsxs("div",{className:"subscription-section",children:[u.jsx("h2",{children:"Your Plan"}),r==="trial"&&u.jsx("div",{className:"trial-status",children:u.jsxs("div",{className:"status-card trial",children:[u.jsx("h3",{children:"Premium Trial"}),u.jsx("p",{children:"You're experiencing the full premium experience!"}),u.jsxs("div",{className:"trial-countdown",children:[u.jsx("span",{className:"days-remaining",children:s}),u.jsx("span",{className:"days-label",children:"days remaining"})]}),u.jsxs("div",{className:"trial-benefits",children:[u.jsx("p",{children:"Currently enjoying:"}),u.jsxs("ul",{children:[u.jsx("li",{children:" Custom goal setting"}),u.jsx("li",{children:" Diamond achievements"}),u.jsx("li",{children:" Premium soundscapes"}),u.jsx("li",{children:" Advanced analytics"})]})]}),u.jsx("button",{onClick:Xl,className:"keep-premium-btn",children:"Keep Premium Access - $4.99/month"})]})}),r==="premium"&&u.jsx("div",{className:"premium-status",children:u.jsxs("div",{className:"status-card premium",children:[u.jsx("h3",{children:" Premium Member"}),u.jsx("p",{children:"You have access to all premium features!"}),u.jsxs("div",{className:"premium-benefits",children:[u.jsx("h4",{children:"Your Premium Benefits:"}),u.jsxs("div",{className:"benefits-list",children:[u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Custom goal setting"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Exclusive Diamond badges"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Premium soundscapes"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Advanced analytics"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Challenge competitions"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Priority support"})]})]})]}),u.jsx("button",{onClick:o,className:"cancel-btn",children:"Cancel Subscription"})]})}),r==="free"&&u.jsx("div",{className:"free-status",children:u.jsxs("div",{className:"status-card free",children:[u.jsx("h3",{children:" Free Plan"}),u.jsx("p",{children:"Upgrade to unlock premium features and enhance your wellness journey"}),u.jsxs("div",{className:"premium-benefits",children:[u.jsx("h4",{children:"Unlock with Premium:"}),u.jsxs("div",{className:"benefits-list",children:[u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Custom goal setting"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Exclusive Diamond badges"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Premium soundscapes"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Advanced analytics"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Challenge competitions"})]}),u.jsxs("div",{className:"benefit-item",children:[u.jsx("span",{className:"benefit-icon",children:""}),u.jsx("span",{children:"Priority support"})]})]})]}),u.jsx("button",{onClick:Xl,className:"upgrade-btn",children:"Upgrade to Premium - $4.99/month"})]})})]})]})}):u.jsx("div",{className:"profile-error",children:"Please log in to view your profile."})}function AO({children:t}){const{user:e,loading:n}=xn();return console.log(" ProtectedRoute - loading:",n,"user:",!!e),n?u.jsx("div",{className:"loading",children:"Loading..."}):e?(console.log(" Authenticated, rendering protected content"),t):(console.log(" Not authenticated, redirecting to welcome"),u.jsx(ld,{to:"/welcome",replace:!0}))}const PO="modulepreload",NO=function(t){return"/"+t},I0={},CO=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=NO(c),c in I0)return;I0[c]=!0;const d=c.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":PO,d||(m.as="script"),m.crossOrigin="",m.href=c,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((g,x)=>{m.addEventListener("load",g),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function RO(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,c;const d=async(m=!0)=>{await c};async function f(){if("serviceWorker"in navigator){if(a=await CO(async()=>{const{Workbox:m}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/sw.js",{scope:"/",type:"classic"})).catch(m=>{o==null||o(m)}),!a)return;a.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),a.addEventListener("installed",m=>{m.isUpdate||r==null||r()}),a.register({immediate:e}).then(m=>{i?i("/sw.js",m):s==null||s(m)}).catch(m=>{o==null||o(m)})}}return c=f(),d}const bO=()=>{const[t,e]=R.useState(!1),[n,r]=R.useState(!1);R.useEffect(()=>{RO({onNeedRefresh(){e(!0)},onOfflineReady(){r(!0)},onRegistered(o){console.log("SW registered: ",o)},onRegisterError(o){console.log("SW registration error",o)}})},[]);const s=()=>{r(!1),e(!1)},i=()=>{updateSW(),s()};return!t&&!n?null:u.jsxs("div",{className:"pwa-update-banner",children:[u.jsxs("div",{className:"pwa-update-content",children:[n&&u.jsxs("div",{className:"pwa-message",children:[u.jsx("span",{children:"App ready to work offline"}),u.jsx("button",{onClick:s,className:"pwa-close-btn",children:"Close"})]}),t&&u.jsxs("div",{className:"pwa-message",children:[u.jsx("span",{children:"New content available, click on reload button to update"}),u.jsx("button",{onClick:i,className:"pwa-update-btn",children:"Reload"}),u.jsx("button",{onClick:s,className:"pwa-close-btn",children:"Close"})]})]}),u.jsx("style",{jsx:!0,children:`
        .pwa-update-banner {
          position: fixed;
          bottom: 0;
          left: 0;
          right: 0;
          background: #6c5ce7;
          color: white;
          padding: 1rem;
          z-index: 9999;
          box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .pwa-update-content {
          max-width: 600px;
          margin: 0 auto;
        }
        
        .pwa-message {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
        }
        
        .pwa-update-btn, .pwa-close-btn {
          background: rgba(255, 255, 255, 0.2);
          border: 1px solid rgba(255, 255, 255, 0.3);
          color: white;
          padding: 0.5rem 1rem;
          border-radius: 6px;
          cursor: pointer;
          font-size: 0.875rem;
          transition: background-color 0.2s;
        }
        
        .pwa-update-btn:hover, .pwa-close-btn:hover {
          background: rgba(255, 255, 255, 0.3);
        }
        
        @media (max-width: 768px) {
          .pwa-message {
            flex-direction: column;
            gap: 0.5rem;
          }
          
          .pwa-update-btn, .pwa-close-btn {
            width: 100%;
          }
        }
      `})]})},DO=()=>{const[t,e]=R.useState(!1),[n,r]=R.useState(null),[s,i]=R.useState("unknown"),[o,a]=R.useState(!1);R.useEffect(()=>{const g=window.matchMedia("(display-mode: standalone)").matches,x=localStorage.getItem("clarity-pwa-dismissed")==="true";if(g||x)return;const A=/iPad|iPhone|iPod/.test(navigator.userAgent),N=/Android/.test(navigator.userAgent);i(A?"ios":N?"android":"desktop");const C=v=>{v.preventDefault(),o||(r(v),e(!0),a(!0))},I=()=>{e(!1),r(null),localStorage.setItem("clarity-pwa-installed","true")};if(window.addEventListener("beforeinstallprompt",C),window.addEventListener("appinstalled",I),A&&!o){const v=setTimeout(()=>{o||(e(!0),a(!0))},3e3);return()=>clearTimeout(v)}return()=>{window.removeEventListener("beforeinstallprompt",C),window.removeEventListener("appinstalled",I)}},[o]);const c=async()=>{if(n){n.prompt();const{outcome:g}=await n.userChoice;g==="accepted"&&(e(!1),r(null),localStorage.setItem("clarity-pwa-installed","true"))}},d=()=>{e(!1),localStorage.setItem("clarity-pwa-dismissed","true")};if(!t)return null;const m=(()=>{switch(s){case"ios":return{title:"Add Clarity to Home Screen",steps:["Tap the Share button () at the bottom",'Scroll down and tap "Add to Home Screen"','Tap "Add" to install'],icon:""};case"android":return{title:"Install Clarity App",steps:['Tap "Install" below to add to home screen','Or use the menu ()  "Add to Home Screen"'],icon:""};case"desktop":return{title:"Install Clarity App",steps:["Click the install icon () in your browser address bar",'Or use the menu  "Install Clarity"'],icon:""};default:return{title:"Install Clarity",steps:["Look for an install option in your browser menu","Or add this page to your bookmarks"],icon:""}}})();return u.jsxs("div",{className:"install-prompt-overlay",children:[u.jsxs("div",{className:"install-prompt",children:[u.jsx("button",{className:"install-close",onClick:d,children:""}),u.jsxs("div",{className:"install-content",children:[u.jsx("div",{className:"install-icon",children:m.icon}),u.jsx("h3",{children:m.title}),u.jsx("div",{className:"install-steps",children:m.steps.map((g,x)=>u.jsxs("div",{className:"install-step",children:[u.jsx("span",{className:"step-number",children:x+1}),u.jsx("span",{className:"step-text",children:g})]},x))}),s==="android"&&n&&u.jsx("button",{className:"install-button",onClick:c,children:"Install Clarity"}),u.jsx("div",{className:"install-benefits",children:u.jsx("p",{children:" Works offline   Faster loading   App-like experience"})})]})]}),u.jsx("style",{jsx:!0,children:`
        .install-prompt-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 10000;
          padding: 20px;
        }

        .install-prompt {
          background: white;
          border-radius: 16px;
          padding: 24px;
          max-width: 400px;
          width: 100%;
          position: relative;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .install-close {
          position: absolute;
          top: 12px;
          right: 12px;
          background: none;
          border: none;
          font-size: 20px;
          cursor: pointer;
          color: #666;
          padding: 4px;
        }

        .install-content {
          text-align: center;
        }

        .install-icon {
          font-size: 48px;
          margin-bottom: 16px;
        }

        .install-content h3 {
          color: #6b8069;
          margin-bottom: 20px;
          font-size: 20px;
        }

        .install-steps {
          text-align: left;
          margin-bottom: 20px;
        }

        .install-step {
          display: flex;
          align-items: center;
          margin-bottom: 12px;
          padding: 8px 0;
        }

        .step-number {
          background: #6b8069;
          color: white;
          width: 24px;
          height: 24px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 12px;
          font-weight: bold;
          margin-right: 12px;
          flex-shrink: 0;
        }

        .step-text {
          color: #333;
          font-size: 14px;
          line-height: 1.4;
        }

        .install-button {
          background: #6b8069;
          color: white;
          border: none;
          border-radius: 12px;
          padding: 12px 24px;
          font-size: 16px;
          font-weight: 600;
          cursor: pointer;
          width: 100%;
          margin-bottom: 16px;
          transition: background-color 0.2s;
        }

        .install-button:hover {
          background: #556b54;
        }

        .install-benefits {
          background: #f6f7f6;
          border-radius: 8px;
          padding: 12px;
        }

        .install-benefits p {
          color: #6b8069;
          font-size: 12px;
          margin: 0;
        }

        @media (max-width: 480px) {
          .install-prompt {
            margin: 20px;
            padding: 20px;
          }
        }
      `})]})},jO=()=>{const[t,e]=R.useState(!1),[n,r]=R.useState(null),[s,i]=R.useState(!1),[o,a]=R.useState(!1);R.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){i(!0);return}const d=localStorage.getItem("clarity-pwa-dismissed")==="true",f=localStorage.getItem("clarity-pwa-installed")==="true";if(d||f)return;const m=A=>{A.preventDefault(),o||(r(A),e(!0),a(!0))},g=()=>{i(!0),e(!1),r(null),localStorage.setItem("clarity-pwa-installed","true")};if(window.addEventListener("beforeinstallprompt",m),window.addEventListener("appinstalled",g),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!s&&!o){const A=setTimeout(()=>{o||(e(!0),a(!0))},5e3);return()=>clearTimeout(A)}return()=>{window.removeEventListener("beforeinstallprompt",m),window.removeEventListener("appinstalled",g)}},[s,o]);const c=async()=>{if(n){n.prompt();const{outcome:d}=await n.userChoice;d==="accepted"&&(i(!0),e(!1),r(null),localStorage.setItem("clarity-pwa-installed","true"))}else alert('To install: Use your browser menu  "Add to Home Screen" or "Install App"')};return!t||s?null:u.jsxs("div",{className:"floating-install-button",onClick:c,children:[u.jsx("div",{className:"install-icon",children:""}),u.jsx("span",{className:"install-text",children:"Install"}),u.jsx("style",{jsx:!0,children:`
        .floating-install-button {
          position: fixed;
          bottom: 20px;
          right: 20px;
          background: #6b8069;
          color: white;
          border-radius: 50px;
          padding: 12px 20px;
          display: flex;
          align-items: center;
          gap: 8px;
          cursor: pointer;
          box-shadow: 0 4px 12px rgba(107, 128, 105, 0.3);
          z-index: 1000;
          transition: all 0.2s ease;
          font-weight: 600;
          font-size: 14px;
        }

        .floating-install-button:hover {
          background: #556b54;
          transform: translateY(-2px);
          box-shadow: 0 6px 16px rgba(107, 128, 105, 0.4);
        }

        .floating-install-button:active {
          transform: translateY(0);
        }

        .install-icon {
          font-size: 18px;
        }

        .install-text {
          white-space: nowrap;
        }

        @media (max-width: 480px) {
          .floating-install-button {
            bottom: 16px;
            right: 16px;
            padding: 10px 16px;
            font-size: 13px;
          }
        }
      `})]})},Vf={worry_worm:{name:"Worry Worm",icon:"",color:"#8B4513",size:"small",technique:"breathing",description:"Those nagging worries that won't go away",tamedMessage:"Worry Worm is now peaceful! "},panic_bear:{name:"Panic Bear",icon:"",color:"#DC143C",size:"large",technique:"progressive_relaxation",description:"Big scary feelings that make your heart race",tamedMessage:"Panic Bear is now your gentle guardian! "},overthink_octopus:{name:"Overthink Octopus",icon:"",color:"#4B0082",size:"medium",technique:"mindfulness",description:"Eight arms of spiraling thoughts",tamedMessage:"Overthink Octopus is now zen and focused! "},doom_dragon:{name:"Doom Dragon",icon:"",color:"#8B0000",size:"boss",technique:"breathing",description:"The big bad of catastrophic thinking",tamedMessage:"Doom Dragon is now your wise protector! "}},La={breathing:{name:"Deep Breathing",icon:"",instructions:["Breathe in for 4","Hold for 4","Breathe out for 6","Repeat"],duration:16e3,color:"#4CAF50"},progressive_relaxation:{name:"Progressive Relaxation",icon:"",instructions:["Tense your shoulders","Hold for 3 seconds","Release and relax","Feel the tension melt away"],duration:12e3,color:"#2196F3"},mindfulness:{name:"Mindfulness Anchor",icon:"",instructions:["Notice 3 things you can see","Notice 2 things you can hear","Notice 1 thing you can feel","You are present"],duration:15e3,color:"#FF9800"}},lu={TAMED_MONSTERS:"anxiety_game_tamed_monsters",PLAYER_STATS:"anxiety_game_player_stats"};function VO({user:t,onUpdateStats:e}){var L,V,_;const[n,r]=R.useState("menu"),[s,i]=R.useState(null),[o,a]=R.useState([]),[c,d]=R.useState({level:1,experience:0,calmness:100,monstersDefeated:0,sanctuaryPoints:0}),[f,m]=R.useState(0),[g,x]=R.useState(0),[A,N]=R.useState(!1),C=R.useRef(null);R.useEffect(()=>{try{const y=localStorage.getItem(lu.TAMED_MONSTERS);if(y){const P=JSON.parse(y).map(b=>({...Vf[b],id:b}));a(P)}const E=localStorage.getItem(lu.PLAYER_STATS);if(E){const T=JSON.parse(E);d(T)}}catch(y){console.error("Error loading game data from localStorage:",y)}},[]);const I=()=>{const y=Object.keys(Vf),E=y[Math.floor(Math.random()*y.length)],T={...Vf[E],id:E};i(T),r("encounter");const P=T.size==="boss"?30:T.size==="large"?20:10;d(b=>({...b,calmness:Math.max(0,b.calmness-P)}))},v=()=>{const y=La[s.technique]||La.breathing;r("technique"),m(0),x(0),S(y)},S=y=>{const E=y.duration/y.instructions.length;let T=0;const P=setInterval(()=>{x(T),m((T+1)/y.instructions.length*100),T===y.instructions.length-1?(clearInterval(P),setTimeout(()=>{D()},E)):T++},E);C.current=P},D=()=>{const y=s.size==="boss"?100:s.size==="large"?50:25,E=s.size==="boss"?20:10;a(T=>[...T,s]),d(T=>({...T,experience:T.experience+y,calmness:Math.min(100,T.calmness+30),monstersDefeated:T.monstersDefeated+1,sanctuaryPoints:T.sanctuaryPoints+E,level:Math.floor((T.experience+y)/100)+1})),r("victory"),e&&e({anxietyGameScore:c.monstersDefeated+1,mindfulnessPoints:E})};return R.useEffect(()=>{if(n==="technique"&&(s==null?void 0:s.technique)==="breathing"){const y=setInterval(()=>{N(E=>!E)},2e3);return()=>clearInterval(y)}},[n,s]),R.useEffect(()=>()=>{C.current&&clearInterval(C.current)},[]),R.useEffect(()=>{try{const y=o.map(E=>E.id);localStorage.setItem(lu.TAMED_MONSTERS,JSON.stringify(y))}catch(y){console.error("Error saving tamed monsters to localStorage:",y)}},[o]),R.useEffect(()=>{try{localStorage.setItem(lu.PLAYER_STATS,JSON.stringify(c))}catch(y){console.error("Error saving player stats to localStorage:",y)}},[c]),u.jsxs("div",{className:"monster-tamer-game",children:[n==="menu"&&u.jsxs("div",{className:"game-menu",children:[u.jsxs("div",{className:"game-header",children:[u.jsx("h2",{children:" Anxiety Monster Tamer"}),u.jsx("p",{children:"Use mindfulness to tame your anxiety monsters!"})]}),u.jsxs("div",{className:"player-stats",children:[u.jsxs("div",{className:"stat",children:[u.jsx("span",{className:"stat-icon",children:""}),u.jsxs("span",{children:["Level ",c.level]})]}),u.jsxs("div",{className:"stat",children:[u.jsx("span",{className:"stat-icon",children:""}),u.jsxs("span",{children:["Calmness: ",c.calmness,"%"]})]}),u.jsxs("div",{className:"stat",children:[u.jsx("span",{className:"stat-icon",children:""}),u.jsxs("span",{children:["Tamed: ",c.monstersDefeated]})]}),u.jsxs("div",{className:"stat",children:[u.jsx("span",{className:"stat-icon",children:""}),u.jsxs("span",{children:["Sanctuary: ",c.sanctuaryPoints]})]})]}),u.jsx("button",{className:"encounter-btn",onClick:I,disabled:c.calmness<10,children:c.calmness<10?"Rest First ":"Encounter Monster "}),c.calmness<10&&u.jsx("button",{className:"rest-btn",onClick:()=>d(y=>({...y,calmness:Math.min(100,y.calmness+50)})),style:{background:"linear-gradient(135deg, #FF9800 0%, #FF5722 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"20px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",marginTop:"12px"},children:"Rest & Recover  (+50 Calmness)"}),u.jsxs("div",{className:"tamed-collection",children:[u.jsx("h3",{children:"Your Tamed Monsters:"}),u.jsx("div",{className:"tamed-grid",children:o.length===0?u.jsx("p",{className:"no-tamed",children:"No monsters tamed yet. Start your journey!"}):o.map((y,E)=>u.jsxs("div",{className:"tamed-monster",children:[u.jsx("span",{className:"monster-icon",children:y.icon}),u.jsx("span",{className:"monster-name",children:y.name})]},E))})]})]}),n==="encounter"&&s&&u.jsxs("div",{className:"monster-encounter",children:[u.jsxs("div",{className:"encounter-scene",children:[u.jsxs("div",{className:`monster ${s.size} ${s.id}`,children:[u.jsx("div",{className:"monster-icon",children:s.icon}),u.jsx("div",{className:"monster-shake"})]}),u.jsxs("div",{className:"encounter-text",children:[u.jsxs("h3",{children:["A wild ",s.name," appears!"]}),u.jsx("p",{children:s.description}),u.jsx("p",{className:"calmness-drop",children:"Your calmness dropped! "})]})]}),u.jsxs("div",{className:"taming-options",children:[u.jsxs("button",{className:"tame-btn",onClick:v,children:[u.jsx("span",{className:"technique-icon",children:((L=La[s.technique])==null?void 0:L.icon)||""}),"Use ",((V=La[s.technique])==null?void 0:V.name)||"Deep Breathing"]}),u.jsx("button",{className:"run-btn",onClick:()=>r("menu"),children:"Run Away "})]})]}),n==="technique"&&s&&u.jsxs("div",{className:"taming-technique",children:[u.jsxs("div",{className:"technique-header",children:[u.jsxs("h3",{children:["Taming ",s.name]}),u.jsx("div",{className:"anxiety-progress",children:u.jsx("div",{className:"anxiety-progress-fill",style:{width:`${f}%`}})})]}),u.jsx("div",{className:`technique-visual ${A?"breathing":""}`,children:u.jsxs("div",{className:"monster-calming",children:[u.jsx("span",{className:"monster-icon",children:s.icon}),u.jsx("div",{className:"calming-aura"})]})}),u.jsx("div",{className:"technique-instructions",children:(_=La[s.technique])==null?void 0:_.instructions.map((y,E)=>u.jsx("div",{className:`instruction ${E===g?"active":E<g?"completed":""}`,children:y},E))})]}),n==="victory"&&s&&u.jsxs("div",{className:"victory-screen",children:[u.jsx("div",{className:"victory-animation",children:u.jsxs("div",{className:"tamed-monster",children:[u.jsx("span",{className:"monster-icon happy",children:s.icon}),u.jsx("div",{className:"sparkles",children:""})]})}),u.jsxs("div",{className:"victory-text",children:[u.jsx("h3",{children:" Monster Tamed!"}),u.jsx("p",{children:s.tamedMessage}),u.jsxs("div",{className:"rewards",children:[u.jsx("div",{className:"reward",children:"+30 Calmness "}),u.jsxs("div",{className:"reward",children:["+",s.size==="boss"?100:s.size==="large"?50:25," Experience "]}),u.jsxs("div",{className:"reward",children:["+",s.size==="boss"?20:10," Sanctuary Points "]})]})]}),u.jsxs("div",{className:"victory-actions",children:[u.jsx("button",{className:"continue-btn",onClick:()=>r("menu"),children:"Continue Journey "}),u.jsx("button",{className:"sanctuary-btn",onClick:()=>r("sanctuary"),children:"Visit Sanctuary "})]})]}),n==="sanctuary"&&u.jsxs("div",{className:"sanctuary-view",children:[u.jsxs("div",{className:"sanctuary-header",children:[u.jsx("h2",{children:" Your Peaceful Sanctuary"}),u.jsx("p",{children:"A safe space built from your mindfulness journey"}),u.jsx("button",{className:"back-to-menu-btn",onClick:()=>r("menu"),children:" Back to Adventure"})]}),u.jsxs("div",{className:"sanctuary-stats",children:[u.jsxs("div",{className:"sanctuary-stat",children:[u.jsx("div",{className:"stat-icon",children:""}),u.jsxs("div",{className:"stat-info",children:[u.jsx("span",{className:"stat-number",children:c.sanctuaryPoints}),u.jsx("span",{className:"stat-label",children:"Sanctuary Points"})]})]}),u.jsxs("div",{className:"sanctuary-stat",children:[u.jsx("div",{className:"stat-icon",children:""}),u.jsxs("div",{className:"stat-info",children:[u.jsx("span",{className:"stat-number",children:o.length}),u.jsx("span",{className:"stat-label",children:"Peaceful Companions"})]})]}),u.jsxs("div",{className:"sanctuary-stat",children:[u.jsx("div",{className:"stat-icon",children:""}),u.jsxs("div",{className:"stat-info",children:[u.jsxs("span",{className:"stat-number",children:[c.calmness,"%"]}),u.jsx("span",{className:"stat-label",children:"Current Calmness"})]})]})]}),u.jsxs("div",{className:"sanctuary-garden",children:[u.jsx("h3",{children:" Mindfulness Garden"}),u.jsxs("div",{className:"garden-grid",children:[o.length===0?u.jsxs("div",{className:"empty-garden",children:[u.jsx("div",{className:"empty-garden-icon",children:""}),u.jsx("p",{children:"Your garden awaits your first peaceful companion..."}),u.jsx("small",{children:"Tame monsters to populate your sanctuary!"})]}):o.map((y,E)=>u.jsx("div",{className:"garden-companion",children:u.jsxs("div",{className:"companion-spot",children:[u.jsx("span",{className:"companion-icon",children:y.icon}),u.jsx("div",{className:"companion-aura"}),u.jsx("div",{className:"companion-name",children:y.name}),u.jsx("div",{className:"companion-effect",children:"Radiating peace "})]})},E)),Array.from({length:Math.max(0,6-o.length)}).map((y,E)=>u.jsx("div",{className:"garden-companion empty",children:u.jsxs("div",{className:"companion-spot",children:[u.jsx("span",{className:"empty-spot",children:"?"}),u.jsx("div",{className:"spot-label",children:"Awaiting Friend"})]})},`empty-${E}`))]})]}),u.jsxs("div",{className:"sanctuary-upgrades",children:[u.jsx("h3",{children:" Sanctuary Upgrades"}),u.jsxs("div",{className:"upgrades-grid",children:[u.jsxs("div",{className:`upgrade-card ${c.sanctuaryPoints>=50?"available":"locked"}`,children:[u.jsx("div",{className:"upgrade-icon",children:""}),u.jsxs("div",{className:"upgrade-info",children:[u.jsx("h4",{children:"Rainbow Bridge"}),u.jsx("p",{children:"Connects different areas of your sanctuary"}),u.jsx("span",{className:"upgrade-cost",children:"50 Points"})]}),c.sanctuaryPoints>=50?u.jsx("button",{className:"upgrade-btn",children:"Build"}):u.jsx("div",{className:"upgrade-locked",children:""})]}),u.jsxs("div",{className:`upgrade-card ${c.sanctuaryPoints>=100?"available":"locked"}`,children:[u.jsx("div",{className:"upgrade-icon",children:""}),u.jsxs("div",{className:"upgrade-info",children:[u.jsx("h4",{children:"Meditation Fountain"}),u.jsx("p",{children:"Restores calmness over time"}),u.jsx("span",{className:"upgrade-cost",children:"100 Points"})]}),c.sanctuaryPoints>=100?u.jsx("button",{className:"upgrade-btn",children:"Build"}):u.jsx("div",{className:"upgrade-locked",children:""})]}),u.jsxs("div",{className:`upgrade-card ${c.sanctuaryPoints>=200?"available":"locked"}`,children:[u.jsx("div",{className:"upgrade-icon",children:""}),u.jsxs("div",{className:"upgrade-info",children:[u.jsx("h4",{children:"Wisdom Tower"}),u.jsx("p",{children:"Unlock advanced meditation techniques"}),u.jsx("span",{className:"upgrade-cost",children:"200 Points"})]}),c.sanctuaryPoints>=200?u.jsx("button",{className:"upgrade-btn",children:"Build"}):u.jsx("div",{className:"upgrade-locked",children:""})]})]})]}),u.jsxs("div",{className:"daily-affirmations",children:[u.jsx("h3",{children:" Daily Affirmation"}),u.jsxs("div",{className:"affirmation-card",children:[u.jsx("div",{className:"affirmation-text",children:'"I am creating a sanctuary of peace within myself, one mindful moment at a time."'}),u.jsx("div",{className:"affirmation-author",children:"- Your Inner Wisdom"})]})]}),u.jsxs("div",{className:"sanctuary-actions",children:[u.jsx("button",{className:"meditation-btn",onClick:()=>{d(y=>({...y,calmness:Math.min(100,y.calmness+10)}))},children:" Meditate in Sanctuary (+10 Calmness)"}),u.jsx("button",{className:"encounter-btn",onClick:()=>{r("menu"),setTimeout(()=>{I()},500)},children:" Ready for Another Adventure"})]})]})]})}function OO(){const{user:t}=xn(),[e,n]=R.useState({anxietyGameScore:0,mindfulnessPoints:0,totalGamesPlayed:0,currentStreak:0}),[r,s]=R.useState(!1),[i,o]=R.useState(!1),[a,c]=R.useState(0);R.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const C=await ye.getPoints(t.uid);c(C)}})()},[t]),R.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const C=await ye.isChallengeCompleted(t.uid,"monster_tamer_daily","daily"),I=await ye.isChallengeCompleted(t.uid,"mindfulness_master_daily","daily");s(C),o(I)}})()},[t]),R.useEffect(()=>{try{const N=localStorage.getItem("clarity_game_stats");if(N){const I=JSON.parse(N);n(I),console.log(" Loaded saved game stats:",I)}const C=localStorage.getItem("anxiety_game_tamed_monsters");if(C){const v=JSON.parse(C).length;n(S=>{const D={...S,anxietyGameScore:Math.max(S.anxietyGameScore,v)};return localStorage.setItem("clarity_game_stats",JSON.stringify(D)),console.log(" Synced monster count:",v),D})}}catch(N){console.error("Error loading game stats:",N)}},[]);const d=N=>{console.log(" handleUpdateStats called with:",N),n(C=>{const I={...C,anxietyGameScore:N.anxietyGameScore||C.anxietyGameScore,mindfulnessPoints:C.mindfulnessPoints+(N.mindfulnessPoints||0),totalGamesPlayed:C.totalGamesPlayed+1};try{localStorage.setItem("clarity_game_stats",JSON.stringify(I)),console.log(" Saved game stats to localStorage:",I)}catch(v){console.error("Error saving game stats:",v)}return I}),console.log(" Game stats updated:",N)},f=()=>{try{const N=localStorage.getItem("anxiety_game_tamed_monsters"),C=localStorage.getItem("anxiety_game_player_stats");if(console.log(" Debug - Tamed monsters:",N),console.log(" Debug - Player stats:",C),N){const v=JSON.parse(N).length;n(S=>({...S,anxietyGameScore:v})),console.log(" Debug - Updated anxietyGameScore to:",v)}}catch(N){console.error("Error refreshing stats:",N)}},m=e.anxietyGameScore>=3,g=e.mindfulnessPoints>=100,x=async()=>{if(!(t!=null&&t.uid)||r||!m)return;await ye.addPoints(t.uid,50),await ye.completeChallenge(t.uid,"monster_tamer_daily","daily"),s(!0);const N=await ye.getPoints(t.uid);c(N),alert("You claimed 50 points for Monster Tamer Challenge!")},A=async()=>{if(!(t!=null&&t.uid)||i||!g)return;await ye.addPoints(t.uid,75),await ye.completeChallenge(t.uid,"mindfulness_master_daily","daily"),o(!0);const N=await ye.getPoints(t.uid);c(N),alert("You claimed 75 points for Mindfulness Master Challenge!")};return u.jsxs("div",{className:"games-page",children:[u.jsxs("div",{className:"points-balance",children:[u.jsx("span",{role:"img","aria-label":"points",children:""})," ",a," Points"]}),u.jsxs("div",{className:"games-header",children:[u.jsx("h1",{className:"games-title",children:"Mental Wellness Games"}),u.jsx("p",{className:"games-subtitle",children:"Play games to improve your mental health"})]}),u.jsxs("div",{className:"game-stats-section",children:[u.jsxs("div",{className:"stats-header",children:[u.jsx("h2",{className:"section-title",children:"Your Gaming Stats"}),u.jsx("button",{onClick:f,className:"refresh-stats-btn",title:"Refresh stats from game data",children:" Refresh"})]}),u.jsxs("div",{className:"game-stats-grid",children:[u.jsxs("div",{className:"game-stat-card",children:[u.jsx("div",{className:"stat-icon",children:""}),u.jsxs("div",{className:"stat-info",children:[u.jsx("span",{className:"stat-number",children:e.anxietyGameScore}),u.jsx("span",{className:"stat-label",children:"Monsters Tamed"})]})]}),u.jsxs("div",{className:"game-stat-card",children:[u.jsx("div",{className:"stat-icon",children:""}),u.jsxs("div",{className:"stat-info",children:[u.jsx("span",{className:"stat-number",children:e.mindfulnessPoints}),u.jsx("span",{className:"stat-label",children:"Mindfulness Points"})]})]}),u.jsxs("div",{className:"game-stat-card",children:[u.jsx("div",{className:"stat-icon",children:""}),u.jsxs("div",{className:"stat-info",children:[u.jsx("span",{className:"stat-number",children:e.totalGamesPlayed}),u.jsx("span",{className:"stat-label",children:"Games Played"})]})]}),u.jsxs("div",{className:"game-stat-card",children:[u.jsx("div",{className:"stat-icon",children:""}),u.jsxs("div",{className:"stat-info",children:[u.jsx("span",{className:"stat-number",children:e.currentStreak}),u.jsx("span",{className:"stat-label",children:"Day Streak"})]})]})]})]}),u.jsxs("div",{className:"available-games",children:[u.jsx("h2",{className:"section-title",children:"Available Games"}),u.jsxs("div",{className:"game-section",children:[u.jsxs("div",{className:"game-header",children:[u.jsx("h3",{className:"game-title",children:" Anxiety Monster Tamer"}),u.jsx("span",{className:"game-status",children:"Active"})]}),u.jsx("p",{className:"game-description",children:"Face your anxiety monsters and tame them through mindful interaction. Each monster represents different anxiety triggers. Practice coping strategies while earning points!"}),u.jsx("div",{className:"game-container",children:u.jsx(VO,{user:t,onUpdateStats:d})})]}),u.jsxs("div",{className:"daily-challenges",children:[u.jsx("h2",{className:"section-title",children:"Daily Gaming Challenges"}),u.jsxs("div",{className:"challenge-card",children:[u.jsx("div",{className:"challenge-icon",children:""}),u.jsxs("div",{className:"challenge-content",children:[u.jsx("h3",{children:"Monster Tamer Challenge"}),u.jsx("p",{children:"Tame 3 anxiety monsters today"}),u.jsx("div",{className:"challenge-progress",children:u.jsx("div",{className:"daily-challenge-bar",children:u.jsx("div",{className:"daily-challenge-fill",style:{width:`${Math.min(e.anxietyGameScore/3*100,100)}%`}})})})]}),u.jsxs("div",{className:"challenge-reward",children:[u.jsx("span",{children:"+50 points"}),u.jsx("button",{className:"claim-btn",onClick:x,disabled:!m||r,children:r?"Claimed":"Claim"})]})]}),u.jsxs("div",{className:"challenge-card",children:[u.jsx("div",{className:"challenge-icon",children:""}),u.jsxs("div",{className:"challenge-content",children:[u.jsx("h3",{children:"Mindfulness Master"}),u.jsx("p",{children:"Earn 100 mindfulness points"}),u.jsx("div",{className:"challenge-progress",children:u.jsx("div",{className:"daily-challenge-bar",children:u.jsx("div",{className:"daily-challenge-fill",style:{width:`${Math.min(e.mindfulnessPoints/100*100,100)}%`}})})})]}),u.jsxs("div",{className:"challenge-reward",children:[u.jsx("span",{children:"+75 points"}),u.jsx("button",{className:"claim-btn",onClick:A,disabled:!g||i,children:i?"Claimed":"Claim"})]})]})]}),u.jsxs("div",{className:"game-achievements",children:[u.jsx("h2",{className:"section-title",children:"Gaming Achievements"}),u.jsxs("div",{className:"achievements-grid",children:[e.anxietyGameScore>=1&&u.jsxs("div",{className:"achievement-card bronze",children:[u.jsx("div",{className:"achievement-icon",children:""}),u.jsxs("div",{className:"achievement-info",children:[u.jsx("h4",{children:"FIRST VICTORY"}),u.jsx("p",{children:"Tamed your first monster"})]})]}),e.anxietyGameScore>=5&&u.jsxs("div",{className:"achievement-card silver",children:[u.jsx("div",{className:"achievement-icon",children:""}),u.jsxs("div",{className:"achievement-info",children:[u.jsx("h4",{children:"MONSTER HUNTER"}),u.jsx("p",{children:"Tamed 5 monsters"})]})]}),e.anxietyGameScore>=10&&u.jsxs("div",{className:"achievement-card gold",children:[u.jsx("div",{className:"achievement-icon",children:""}),u.jsxs("div",{className:"achievement-info",children:[u.jsx("h4",{children:"ANXIETY MASTER"}),u.jsx("p",{children:"Tamed 10 monsters"})]})]}),e.mindfulnessPoints>=100&&u.jsxs("div",{className:"achievement-card gold",children:[u.jsx("div",{className:"achievement-icon",children:""}),u.jsxs("div",{className:"achievement-info",children:[u.jsx("h4",{children:"MINDFUL GURU"}),u.jsx("p",{children:"Earned 100+ mindfulness points"})]})]})]})]}),u.jsxs("div",{className:"coming-soon-games",children:[u.jsx("h3",{className:"section-title",children:"More Games Coming Soon"}),u.jsxs("div",{className:"game-preview-grid",children:[u.jsxs("div",{className:"game-preview-card",children:[u.jsx("div",{className:"game-preview-icon",children:""}),u.jsx("h4",{children:"Mindful Garden"}),u.jsx("p",{children:"Grow a virtual garden through daily meditation practice"}),u.jsx("span",{className:"coming-soon-badge",children:"Coming Soon"})]}),u.jsxs("div",{className:"game-preview-card",children:[u.jsx("div",{className:"game-preview-icon",children:""}),u.jsx("h4",{children:"Calm Waters"}),u.jsx("p",{children:"Navigate peaceful waters while practicing breathing exercises"}),u.jsx("span",{className:"coming-soon-badge",children:"Coming Soon"})]}),u.jsxs("div",{className:"game-preview-card",children:[u.jsx("div",{className:"game-preview-icon",children:""}),u.jsx("h4",{children:"Focus Quest"}),u.jsx("p",{children:"Complete challenges that improve concentration and focus"}),u.jsx("span",{className:"coming-soon-badge",children:"Coming Soon"})]})]})]})]})]})}function MO(){return u.jsx(g1,{children:u.jsxs(fN,{children:[u.jsxs(iN,{children:[u.jsx(mn,{path:"/welcome",element:u.jsx(pO,{})}),u.jsxs(mn,{path:"/",element:u.jsx(AO,{children:u.jsx(mO,{})}),children:[u.jsx(mn,{index:!0,element:u.jsx(ld,{to:"/dashboard",replace:!0})}),u.jsx(mn,{path:"dashboard",element:u.jsx(EO,{})}),u.jsx(mn,{path:"workout",element:u.jsx(TO,{})}),u.jsx(mn,{path:"meditation",element:u.jsx(IO,{})}),u.jsx(mn,{path:"water",element:u.jsx(SO,{})}),u.jsx(mn,{path:"goals",element:u.jsx(xO,{})}),u.jsx(mn,{path:"profile",element:u.jsx(kO,{})}),u.jsx(mn,{path:"games",element:u.jsx(OO,{})})]}),u.jsx(mn,{path:"*",element:u.jsx(ld,{to:"/welcome",replace:!0})})]}),u.jsx(bO,{}),u.jsx(DO,{}),u.jsx(jO,{})]})})}Of.createRoot(document.getElementById("root")).render(u.jsx(yr.StrictMode,{children:u.jsx(g1,{children:u.jsx(MO,{})})}));
